
<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Excercises &mdash; Finite Element Modeling in Geodynamics  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/tabs.css" type="text/css" />
      <link rel="stylesheet" href="../_static/plot_directive.css" type="text/css" />
      <link rel="stylesheet" href="../_static/style.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/tabs.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="MWR example problems" href="jupyter/MWR_excercise.html" />
    <link rel="prev" title="Derivation of MWR coefficients - adv/diff example" href="jupyter/MWR_example_derivation.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> Finite Element Modeling in Geodynamics
            <img src="../_static/triangle_fem_cover.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
    
              <p class="caption" role="heading"><span class="caption-text">Course information</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../general-info/course-details.html">Course details</a></li>
<li class="toctree-l1"><a class="reference internal" href="../general-info/installation.html">Installation guide</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Lecture 1</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../lecture1/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lecture1/fdm_intro.html">Introduction: The Finite Differences Method (FDM)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lecture1/example_1.html">Example 1: Cooling dike</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lecture1/example_2.html">Example 2: Cooling dike - implicit version</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lecture1/example_3.html">Example 3: Periodic variations in seafloor temperature</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lecture1/fdm_advection.html">Transport problems with FDM</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Lecture 2</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="mwr_intro.html">Introduction: Method of Weighted Residuals (MWR)</a></li>
<li class="toctree-l1"><a class="reference internal" href="mwr_examples.html">MWR solutions of the steady advection-diffusion equation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Excercises</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#notebook-excercises">Notebook - excercises</a><ul>
<li class="toctree-l3"><a class="reference internal" href="jupyter/MWR_excercise.html">MWR example problems</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#higher-order-approximations">Higher-order approximations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#notebook-derivation-of-higher-order-constants">Notebook - derivation of higher-order constants</a><ul>
<li class="toctree-l3"><a class="reference internal" href="jupyter/MWR_higher_order.html">Example of a high-order approximation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#outlook">Outlook</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Lecture 3</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../lecture3/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lecture3/fem_intro.html">Introduction Finite Element Method (FEM)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lecture3/fem_intro.html#fem-implementation">FEM implementation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lecture3/fem_advection.html">FEM and advection problems</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Lecture 4</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../lecture4/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lecture4/fem_in_2d.html">2-D FEM - elliptic problems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lecture4/fem_in_2d.html#implementation">Implementation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Lecture 5</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../lecture5/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lecture5/FEM_triangles.html">Triangles: unstructured meshes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lecture5/FEM_triangles.html#excercise">Excercise</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Lecture 6</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../lecture6/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lecture6/transient_problems.html">Transient heat diffusion</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lecture6/turing_coupled_problem.html">Coupled diffusion problems</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../refs.html">References</a></li>
</ul>


    
        <p class="caption">
            <span class="caption-text">Getting help</span>
        </p>
        <ul>
            
                <li class="toctree-l1"><a href="https://lruepke.github.io/HTF_lecture/imprint/"><i class="fa fa-stamp"></i> Imprint</a></li>
            
                <li class="toctree-l1"><a href="mailto:lruepke@geomar.de"><i class="fa fa-envelope fa-fw"></i> Prof. Lars Ruepke</a></li>
            
                <li class="toctree-l1"><a href="mailto:zguo@geomar.de"><i class="fa fa-envelope fa-fw"></i> Dr. Zhikui Guo</a></li>
            
                <li class="toctree-l1"><a href="https://lruepke.github.io/FEM_lecture/"><i class="fa fa-home fa-fw"></i> Public site</a></li>
            
                <li class="toctree-l1"><a href="https://lms.uni-kiel.de/url/RepositoryEntry/3664576582"><i class="fa fa-home fa-fw"></i> University site</a></li>
            
        </ul>
    

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Finite Element Modeling in Geodynamics</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Excercises</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/lruepke/HTF_lecture/blob/main//source/lecture2/excercises.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="excercises">
<h1>Excercises<a class="headerlink" href="#excercises" title="Permalink to this headline"></a></h1>
<p>Let us program some of the above MWR formulations. Here is a jupyter notebook that we can use as a starting point.</p>
<section id="notebook-excercises">
<h2>Notebook - excercises<a class="headerlink" href="#notebook-excercises" title="Permalink to this headline"></a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="jupyter/MWR_excercise.html">MWR example problems</a><ul>
<li class="toctree-l2"><a class="reference internal" href="jupyter/MWR_excercise.html#Analytical-solution">Analytical solution</a></li>
<li class="toctree-l2"><a class="reference internal" href="jupyter/MWR_excercise.html#Weighted-residual-results">Weighted residual results</a></li>
</ul>
</li>
</ul>
</div>
<p>Excercises:</p>
<blockquote>
<div><ul class="simple">
<li><p>Get the different methods to work and explore how good the MWR solutions are.</p></li>
<li><p>What happens if you increase the velocity and make the problem more advection dominated?</p></li>
<li><p>What do you think is the problem with advectino dominated problems?</p></li>
</ul>
</div></blockquote>
</section>
<section id="higher-order-approximations">
<h2>Higher-order approximations<a class="headerlink" href="#higher-order-approximations" title="Permalink to this headline"></a></h2>
<p>What we have seen is that for diffusion dominated problems, the above approximation gives reasonable results. For advection dominated problems, a simple polynomial function can no longer approximate the solution in a satisfactory way. One possible solution is to use a higher polynomial as the approximating function. Let’s try this:</p>
<div class="math notranslate nohighlight" id="equation-eq-mwr-example-ho-1">
<span class="eqno">(85)<a class="headerlink" href="#equation-eq-mwr-example-ho-1" title="Permalink to this equation"></a></span>\[\tilde{u}(x)=a_0 + a_1 x + a_2 x^2 + a_3 x^3\]</div>
<p>The boundary conditions can now be written as:</p>
<div class="math notranslate nohighlight" id="equation-eq-mwr-example-ho-2">
<span class="eqno">(86)<a class="headerlink" href="#equation-eq-mwr-example-ho-2" title="Permalink to this equation"></a></span>\[\begin{split}\begin{align}
\begin{split}
\tilde{u}(0) &amp;= 0=a_0\\
\tilde{u}(1) &amp;= 1=0+a_1 + a_2 + a_3\\
0 &amp;= a_1 + a_2 + a_3 -1
\end{split}
\end{align}\end{split}\]</div>
<p>The first and second derivatives become:</p>
<div class="math notranslate nohighlight" id="equation-eq-mwr-example-ho-3">
<span class="eqno">(87)<a class="headerlink" href="#equation-eq-mwr-example-ho-3" title="Permalink to this equation"></a></span>\[\begin{split}\begin{align}
\begin{split}
\frac{\partial \tilde{u}}{\partial x} &amp;= a_1+2a_2x + 3a_3x^2\\
\frac{\partial^2 \tilde{u}}{\partial x^2} &amp;= 2a_2 + 6a_3x
\end{split}
\end{align}\end{split}\]</div>
<p>So the residual is</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-eq-mwr-example-ho-4">
<span class="eqno">(88)<a class="headerlink" href="#equation-eq-mwr-example-ho-4" title="Permalink to this equation"></a></span>\[R(x)=c\left ( a_1 + 2a_2x+3a_3x^2 \right ) - K(2a_2+6a_3x)\]</div>
</div></blockquote>
<p>We will only use the collocation method with two collocation points to determine the two unknown coefficients. The result is a system of equations for the four coefficients <span class="math notranslate nohighlight">\(ai\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-eq-mwr-example-ho-5">
<span class="eqno">(89)<a class="headerlink" href="#equation-eq-mwr-example-ho-5" title="Permalink to this equation"></a></span>\[\begin{split}\begin{align}
\begin{split}
a_0 &amp;=0\\
c \left( a_1+2a_2 \left(\frac{1}{3}\right) +3a_3\left(\frac{1}{3}\right)^2 \right)-K\left(2a_2+6a_3\left(\frac{1}{3}\right)\right)&amp;=0=R\left(\frac{1}{3}\right)\\
c \left( a_1+2a_2 \left(\frac{2}{3}\right) +3a_3\left(\frac{2}{3}\right)^2 \right)-K\left(2a_2+6a_3\left(\frac{2}{3}\right)\right)&amp;=0=R\left(\frac{2}{3}\right)\\
a_1 + a_2 + a_3 -1 &amp;=0
\end{split}
\end{align}\end{split}\]</div>
<p>We can solve this system of equations with the Symbolic Math Toolbox of Matlab or again via sympy using python. Try to do that!</p>
</section>
<section id="notebook-derivation-of-higher-order-constants">
<h2>Notebook - derivation of higher-order constants<a class="headerlink" href="#notebook-derivation-of-higher-order-constants" title="Permalink to this headline"></a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="jupyter/MWR_higher_order.html">Example of a high-order approximation</a></li>
</ul>
</div>
<p>Have a close look at the above notebook and make sure you understand how symbolic systems of equations are solved using sympy! Also check if we are now able to approximate the solution for advection-dominated problems.</p>
</section>
<section id="outlook">
<h2>Outlook<a class="headerlink" href="#outlook" title="Permalink to this headline"></a></h2>
<p>The above considerations have shown how we can find approximate solutions to partial differential equations using MWR. If you remember the characterization above: <em>“…finite element methods partition the problem domain into subregions and produce a simple function in each subregion that approximates the solution”</em>, we can already see that finite elements do something very similar. In essence we will partition the domain into many elements, approximate the solution over every element using the Galerkin method and very simple basis functions, and will finally obtain the global solution by summing up the contributions of each element. That is what we will do over the next weeks!</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="jupyter/MWR_example_derivation.html" class="btn btn-neutral float-left" title="Derivation of MWR coefficients - adv/diff example" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="jupyter/MWR_excercise.html" class="btn btn-neutral float-right" title="MWR example problems" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Lars Ruepke and Zhikui Guo.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
      
        <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
          <span class="rst-current-version" data-toggle="rst-current-version">
            <span class="fa fa-book"> Finite Element Modeling in Geodynamics</span>
            v: latest
            <span class="fa fa-caret-down"></span>
          </span>
          <div class="rst-other-versions">
            <dl>
              
                
                <dd><a href="https://lruepke.github.io/FEM_lecture/downloads/LectureNote.pdf">latest</a></dd>
                
                <dd><a href="#/LectureNote.pdf">2.0</a></dd>
                
              
          </div>
        </div>
      
    

</body>
</html>