


<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Exercise 1 &mdash; HydrothermalFoam Lecture  documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/tabs.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/style.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/tabs.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="1. Read and plot mesh information" href="cases/jupyter/VisualizeResults.html" />
    <link rel="prev" title="FVM and OpenFoam" href="intro.html" /> 
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-EJ32EEFYRN"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-EJ32EEFYRN');
    </script>   

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> HydrothermalFoam Lecture
          

          
            
            <img src="../../_static/htf_picto2.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
    
            
            
              
            
            
              <p class="caption"><span class="caption-text">Course information</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../general-info/course-details.html">Course details</a></li>
</ul>
<p class="caption"><span class="caption-text">Lecture 1</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../L01/Overview.html">Lecture overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L01/slide.html">Accompanying slide deck</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L01/Installation.html">Installation guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L01/OpenFoam.html">Getting started with OpenFoam</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L01/FirstCase.html">A first test case - heat diffusion</a></li>
</ul>
<p class="caption"><span class="caption-text">Lecture 2</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../L02/Overview.html">Lecture overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L02/slide.html">Accompanying slide deck</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L02/intro.html">Navier-Stokes flow with OpenFoam</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L02/Example.html">Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L02/Exercise.html">Excercise</a></li>
</ul>
<p class="caption"><span class="caption-text">Lecture 3</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../L03/Overview.html">Lecture overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L03/slide.html">Accompanying slide deck</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L03/intro.html">Porous Flow - Submarine Hydrothermal Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L03/FirstCase.html">Hydrothermal convection test case</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L03/Exercise.html">Excercises</a></li>
</ul>
<p class="caption"><span class="caption-text">Lecture 4</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../L04/Overview.html">Lecture overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L04/intro.html">Upflow temperatures in submarine hydrothermal systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L04/Exercise1.html">Exercise 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L04/Exercise2.html">Exercise 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L04/Exercise3.html">Exercise 3</a></li>
</ul>
<p class="caption"><span class="caption-text">Lecture 5</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../L05/Overview.html">Lecture overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L05/intro.html">Structural controls on hydrothermal flow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L05/Exercise1.html">Exercise 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L05/Exercise2.html">Exercise 2</a></li>
</ul>
<p class="caption"><span class="caption-text">Lecture 6</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Overview.html">Lecture overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="intro.html">FVM and OpenFoam</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Exercise 1</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#theory">Theory</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#step-1-geometric-and-physical-modeling">Step 1: Geometric and physical modeling</a></li>
<li class="toctree-l3"><a class="reference internal" href="#step-2-domain-discretization">Step 2: Domain discretization</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mesh-structure-and-topology">Mesh structure and topology</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#step-3-equation-discretization">Step 3: Equation discretization</a></li>
<li class="toctree-l3"><a class="reference internal" href="#step-5-transient-discretization">Step 5: Transient discretization</a></li>
<li class="toctree-l3"><a class="reference internal" href="#step-6-solution-of-the-discretized-equations">Step 6: Solution of the discretized equations</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#openfoam-implementation">OpenFOAM implementation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#step-1-read-data">Step 1: Read data</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#read-mesh">Read mesh</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#jupyter-notebook">Jupyter notebook</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cases/jupyter/VisualizeResults.html">1. Read and plot mesh information</a></li>
<li class="toctree-l4"><a class="reference internal" href="cases/jupyter/VisualizeResults.html#2.-Boundary-conditions">2. Boundary conditions</a></li>
<li class="toctree-l4"><a class="reference internal" href="cases/jupyter/VisualizeResults.html#3.-Plot-coefficients-matrix">3. Plot coefficients matrix</a></li>
<li class="toctree-l4"><a class="reference internal" href="cases/jupyter/VisualizeResults.html#1.-Plot-centroids-of-faces">1. Plot centroids of faces</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../refs.html">References</a></li>
</ul>

            
          

    
        <p class="caption">
            <span class="caption-text">Getting help</span>
        </p>
        <ul>
            
                <li class="toctree-l1"><a href="mailto:lruepke@geomar.de"><i class="fa fa-envelope fa-fw"></i> Prof. Lars Ruepke</a></li>
            
                <li class="toctree-l1"><a href="mailto:zguo@geomar.de"><i class="fa fa-envelope fa-fw"></i> Dr. Zhikui Guo</a></li>
            
                <li class="toctree-l1"><a href="https://www.hydrothermalfoam.info"><i class="fa fa-gitlab fa-fw"></i> HydrothermalFoam</a></li>
            
                <li class="toctree-l1"><a href="https://www.openfoam.org"><i class="fa fa-github fa-fw"></i> OpenFOAM</a></li>
            
                <li class="toctree-l1"><a href="https://lruepke.github.io/HTF_lecture/"><i class="fa fa-home fa-fw"></i> Public site</a></li>
            
                <li class="toctree-l1"><a href="https://lms.uni-kiel.de/url/RepositoryEntry/3664576582"><i class="fa fa-home fa-fw"></i> University site</a></li>
            
        </ul>
    

        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">HydrothermalFoam Lecture</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Exercise 1</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            
              <a href="https://github.com/lruepke/HTF_lecture/blob/main//source/lectures/L_FVM/Exercise1.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="admonition warning" id="l-fvm-exercise1">
<p class="admonition-title">Warning</p>
<p>Before we start the exercise 1, please download (<a class="reference download internal" download="" href="../../_downloads/5cadc0ff36497aaf1c4155bb17c6dc5e/test_laplacianFoam.zip"><code class="xref download docutils literal notranslate"><span class="pre">test_laplacianFoam</span></code></a>) the modified Laplacian solver first.
Then put it in the shared folder and compile (<code class="code docutils literal notranslate"><span class="pre">wmake</span></code>) it in the docker container.</p>
</div>
<div class="section" id="exercise-1">
<h1>Exercise 1<a class="headerlink" href="#exercise-1" title="Permalink to this headline">¶</a></h1>
<div class="section" id="theory">
<h2>Theory<a class="headerlink" href="#theory" title="Permalink to this headline">¶</a></h2>
<div class="admonition-goals admonition">
<p class="admonition-title">Goals</p>
<ul class="simple">
<li><p>explore FVM theory</p></li>
<li><p>link FVM theory and OpenFOAM solver implementation</p></li>
<li><p>step by step exploring details of the solver and solving process</p></li>
</ul>
</div>
<div class="section" id="step-1-geometric-and-physical-modeling">
<h3>Step 1: Geometric and physical modeling<a class="headerlink" href="#step-1-geometric-and-physical-modeling" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight" id="equation-eq-fvm-laplacian-dif">
<span class="eqno">(27)<a class="headerlink" href="#equation-eq-fvm-laplacian-dif" title="Permalink to this equation">¶</a></span>\[\frac{\partial T}{\partial t} = \nabla \cdot D \nabla T\]</div>
<p>Here <span class="math notranslate nohighlight">\(D\)</span> is the thermal diffusivity, can be a constant value.
see also <a class="reference internal" href="../L01/FirstCase.html#theory-heat-diffusion"><span class="std std-ref">Theory</span></a></p>
<div class="figure align-center" id="fvm-geometry-bcs-regularbox" style="width: 100%">
<img alt="../../_images/boundaryConditions_FVM_regularBox.svg" src="../../_images/boundaryConditions_FVM_regularBox.svg" /><p class="caption"><span class="caption-number">Fig. 33 </span><span class="caption-text">Model geometry, boundary conditions and initial condition.</span><a class="headerlink" href="#fvm-geometry-bcs-regularbox" title="Permalink to this image">¶</a></p>
</div>
<div class="admonition-what-we-need-to-solve admonition">
<p class="admonition-title">What we need to solve ?</p>
<p>Temperature field <span class="math notranslate nohighlight">\(T\)</span> of the model region at time <span class="math notranslate nohighlight">\(t\)</span>,
therefore <span class="math notranslate nohighlight">\(T\)</span> is the only unknown variable of our problem.</p>
</div>
</div>
<div class="section" id="step-2-domain-discretization">
<h3>Step 2: Domain discretization<a class="headerlink" href="#step-2-domain-discretization" title="Permalink to this headline">¶</a></h3>
<div class="section" id="mesh-structure-and-topology">
<h4>Mesh structure and topology<a class="headerlink" href="#mesh-structure-and-topology" title="Permalink to this headline">¶</a></h4>
<p>Create a 2D regular box mesh using <code class="code docutils literal notranslate"><span class="pre">blockMesh</span></code> utility (<a class="reference download internal" download="" href="../../_downloads/182fc0c7918b295146e8ff66ee704105/regularBox.zip"><code class="xref download docutils literal notranslate"><span class="pre">Regular</span> <span class="pre">box</span> <span class="pre">case</span></code></a>).
Therefore, the mesh topology shown below is the same as OpenFOAM polyMesh.</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--0-input--1" name="tab-set--0" type="radio"><label class="tab-label" for="tab-set--0-input--1">Regular mesh</label><div class="tab-content docutils container">
<div class="figure align-center" id="fig-polymesh-regularbox" style="width: 100%">
<img alt="../../_images/mesh_FVM_regularBox.svg" src="../../_images/mesh_FVM_regularBox.svg" /><p class="caption"><span class="caption-number">Fig. 34 </span><span class="caption-text">2D regular mesh structure and topology information of OpenFOAM polyMesh (See <a class="reference internal" href="cases/jupyter/VisualizeResults.html#1.-Read-and-plot-mesh-information"><span class="std std-ref">1. Read and plot mesh information</span></a> in the notebook).</span><a class="headerlink" href="#fig-polymesh-regularbox" title="Permalink to this image">¶</a></p>
</div>
</div>
<input class="tab-input" id="tab-set--0-input--2" name="tab-set--0" type="radio"><label class="tab-label" for="tab-set--0-input--2">Unstructured mesh</label><div class="tab-content docutils container">
<div class="figure align-center" id="fig-polymesh-unstructured" style="width: 100%">
<img alt="../../_images/mesh_FVM_unstructured.svg" src="../../_images/mesh_FVM_unstructured.svg" /><p class="caption"><span class="caption-number">Fig. 35 </span><span class="caption-text">2D unstructured mesh topology information (<a class="reference download internal" download="" href="../../_downloads/511a4a1fe2a54b529f96db7ce8318cd3/unstructured.zip"><code class="xref download docutils literal notranslate"><span class="pre">Regular</span> <span class="pre">box</span> <span class="pre">case</span></code></a>).</span><a class="headerlink" href="#fig-polymesh-unstructured" title="Permalink to this image">¶</a></p>
</div>
</div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>All internal faces have and only have two attributes, <strong>owner</strong> and <strong>neighbour</strong>,
denote the cell indices who share the face.
While the boundary faces only have <strong>owner</strong> attribute.
The normal vector of face always points from the <strong>owner</strong> cell to the <strong>neighbour</strong> cell.</p>
</div>
</div>
</div>
<div class="section" id="step-3-equation-discretization">
<h3>Step 3: Equation discretization<a class="headerlink" href="#step-3-equation-discretization" title="Permalink to this headline">¶</a></h3>
<p>The equation discretization step is performed over each element of the computational domain to yield an algebraic relation that connects the value of a variable in an element to the values of the variable in the neighboring elements <span id="id1">[<a class="reference internal" href="../../refs.html#id2"><span>Moukalled et al., 2016</span></a>]</span>.</p>
<div class="admonition-goal admonition">
<p class="admonition-title">Goal</p>
<p>Transform partial differential <a class="reference internal" href="#equation-eq-fvm-laplacian-dif">equation (27)</a> into a set of algebraic equations: <span class="math notranslate nohighlight">\(\mathbf{A}[T] = \mathbf{b}\)</span>.</p>
</div>
<ol class="arabic simple">
<li><p>Integrate <a class="reference internal" href="#equation-eq-fvm-laplacian-dif">equation (27)</a> over element <span class="math notranslate nohighlight">\(C\)</span> (the green cell in <a class="reference internal" href="#fig-polymesh-regularbox"><span class="std std-numref">Fig. 34</span></a>) that enables recovering its integral balance form as,</p></li>
</ol>
<div class="math notranslate nohighlight" id="equation-eq-fvm-volume-int">
<span class="eqno">(28)<a class="headerlink" href="#equation-eq-fvm-volume-int" title="Permalink to this equation">¶</a></span>\[\iiint\limits_{V_C} \frac{\partial T}{\partial t} dV \equiv b_C  = \iiint\limits_{V_C} \nabla \cdot D\nabla T dV\]</div>
<p><strong>Note</strong> that the transient term <span class="math notranslate nohighlight">\(\iiint\limits_{V_C} \frac{\partial T}{\partial t} dV \equiv b_C\)</span> will be processed in the later section</p>
<ol class="arabic simple" start="2">
<li><p>Transform the volume integral on the right hand side of <a class="reference internal" href="#equation-eq-fvm-volume-int">equation (28)</a> into a surface integral by applying the divergence theorem,</p></li>
</ol>
<div class="math notranslate nohighlight" id="equation-eq-fvm-surface-int">
<span class="eqno">(29)<a class="headerlink" href="#equation-eq-fvm-surface-int" title="Permalink to this equation">¶</a></span>\[b_C = \oint\limits_{\partial V_C} (D\nabla T)\cdot d\vec{S}\]</div>
<p>The <a class="reference internal" href="#equation-eq-fvm-surface-int">equation (29)</a> is actually a heat balance over cell <span class="math notranslate nohighlight">\(C\)</span>.
It is basically the integral form of the original partial differential equation and involves <strong>no approximation</strong>.</p>
<p>Here we can introduce definition of <strong>heat diffusion flux</strong>,</p>
<div class="math notranslate nohighlight" id="equation-eq-fvm-flux-d">
<span class="eqno">(30)<a class="headerlink" href="#equation-eq-fvm-flux-d" title="Permalink to this equation">¶</a></span>\[\vec{J}^{T,D} \equiv D\nabla T\]</div>
<ol class="arabic simple" start="3">
<li><p>Transform the surface integral in <a class="reference internal" href="#equation-eq-fvm-surface-int">equation (29)</a> as a summation over the control volume faces (<strong>still no approximation</strong>),</p></li>
</ol>
<div class="math notranslate nohighlight" id="equation-eq-fvm-surface-sum">
<span class="eqno">(31)<a class="headerlink" href="#equation-eq-fvm-surface-sum" title="Permalink to this equation">¶</a></span>\[b_C = \sum\limits_{f\sim faces(V_C)} \iint\limits_{f}\vec{J}^{T,D}_f \cdot \vec{S}_f\]</div>
<p>Here <span class="math notranslate nohighlight">\(f\)</span> denotes the boundary face of cell <span class="math notranslate nohighlight">\(V_C\)</span>.</p>
<p>Now, the key problem is how to calculate flux integral on a face.</p>
<ol class="arabic simple" start="4">
<li><p>Evaluating flux integral on the faces</p></li>
</ol>
<p>It’s worth noting that there are only two kinds of cells in the discretized domain, one is <strong>internal cell</strong>, the other is <strong>boundary cell</strong>.
All faces of a internal cell are internal faces. The remain cells are boundary cells which contain at least one boundary face.</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--1-input--1" name="tab-set--1" type="radio"><label class="tab-label" for="tab-set--1-input--1">Internal cell</label><div class="tab-content docutils container">
<p>For a specific internal cell <span class="math notranslate nohighlight">\(C\)</span>, e.g. cell 12, shown in <a class="reference internal" href="#fig-polymesh-regularbox"><span class="std std-numref">Fig. 34</span></a>,
the <a class="reference internal" href="#equation-eq-fvm-surface-sum">equation (31)</a> can be expanded as,</p>
<div class="math notranslate nohighlight" id="equation-eq-fvm-surface-sum-expand">
<span class="eqno">(32)<a class="headerlink" href="#equation-eq-fvm-surface-sum-expand" title="Permalink to this equation">¶</a></span>\[b_{C_{12}} = \color{red}{\iint_{f_{23}}\vec{J}^{T,D}_{f_{23}} \cdot \vec{S}_{f_{23}}} + \iint_{f_{24}}\vec{J}^{T,D}_{f_{24}} \cdot \vec{S}_{f_{24}} + \iint_{f_{21}}\vec{J}^{T,D}_{f_{21}} \cdot \vec{S}_{f_{21}}  + \iint_{f_{5}}\vec{J}^{T,D}_{f_{5}} \cdot \vec{S}_{f_{5}}\]</div>
<p>4.1 Considering face <span class="math notranslate nohighlight">\(f_{23}\)</span>, calculate the first term on the right hand side of the <a class="reference internal" href="#equation-eq-fvm-surface-sum-expand">equation (32)</a> (we have to introduce the <strong>first approximation</strong> at this step). Using a Gaussian quadrature the integral at the face <span class="math notranslate nohighlight">\(f_{23}\)</span>, for example, becomes,</p>
<div class="math notranslate nohighlight" id="equation-fvm-flux-gaussian-integral">
<span class="eqno">(33)<a class="headerlink" href="#equation-fvm-flux-gaussian-integral" title="Permalink to this equation">¶</a></span>\[\color{red}{\iint_{f_{23}}\vec{J}^{T,D}_{f_{23}} \cdot \vec{S}_{f_{23}}} = \iint_{f_{23}} (\vec{J}^{T,D}_{f_{23}} \cdot \vec{n}_{f_{23}}) dS_{f_{23}} \approx \color{orange}{\sum\limits_{ip\sim ip(f_{23})} (\vec{J}^{T,D} \cdot \vec{n}_{ip})\omega_{ip} S_{f_{23}}}\]</div>
<p>where <span class="math notranslate nohighlight">\(S_f\)</span> is the area of face <span class="math notranslate nohighlight">\(f_{23}\)</span>, <span class="math notranslate nohighlight">\(ip\)</span> refers to a integration point and <span class="math notranslate nohighlight">\(ip(f_{23})\)</span> the number of integration points along surface <span class="math notranslate nohighlight">\(f_{23}\)</span>, <span class="math notranslate nohighlight">\(\omega_{ip}\)</span> is the integral weights.</p>
<p>4.2 Choose integral scheme or integral points</p>
<p>To simply explain the calculation process and logic, here we adopt an <strong>one integration point</strong> scheme with weight <span class="math notranslate nohighlight">\(\omega = 1\)</span>, thus <a class="reference internal" href="#equation-fvm-flux-gaussian-integral">equation (33)</a> becomes,</p>
<div class="math notranslate nohighlight" id="equation-eq-fvm-surface-term-f1">
<span class="eqno">(34)<a class="headerlink" href="#equation-eq-fvm-surface-term-f1" title="Permalink to this equation">¶</a></span>\[\color{orange}{\sum\limits_{ip\sim ip(f_{23})} (\vec{J}^{T,D} \cdot \vec{n}_{ip})\omega S_f } = \left(D \frac{\partial T}{\partial x} \vec{i} + D\frac{\partial T}{\partial y} \vec{j} \right)_{f_{23}} \cdot \Delta y_{f_{23}} \vec{i} = \color{blue}{\left( D\frac{\partial T}{\partial x} \right)_{f_{23}} \Delta y_{f_{23}}}\]</div>
<p>where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(S_{f_{23}} = \Delta y_{f_{23}}\)</span>  is the area of face  <span class="math notranslate nohighlight">\(f_{23}\)</span> by assuming <span class="math notranslate nohighlight">\(\Delta z = 1\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\vec{S}_{f_{23}} = S_{f_{23}} \vec{n}_{f_{23}}\)</span> is the surface vector of face <span class="math notranslate nohighlight">\(f_{23}\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\vec{n}_{f_{23}} = \vec{i}\)</span> is the normal vector of the face <span class="math notranslate nohighlight">\(f_{23}\)</span> directed out of the cell <span class="math notranslate nohighlight">\(C\)</span> (see <a class="reference internal" href="#fig-polymesh-regularbox"><span class="std std-numref">Fig. 34</span></a>).</p></li>
</ul>
<p>4.3 Calculate gradient of <span class="math notranslate nohighlight">\(T\)</span> at face centroid, here introduce <strong>the second approximation</strong>, e.g. assuming linear variation of T and then the gradient term in the <a class="reference internal" href="#equation-eq-fvm-surface-term-f1">equation (34)</a> can be approximated as,</p>
<div class="math notranslate nohighlight">
\[\color{blue}{\left( D\frac{\partial T}{\partial x} \right)_{f_{23}} \Delta y_{f_{23}}} = D\frac{T_{f_{23}} - T_{C}}{x_{f_{23}} - x_C}\Delta y_{f_{23}} = D\frac{T_{f_{23}} - T_{C}}{\delta x_{f_{23}}}\Delta y_{f_{23}} = \color{green}{a_{f_{23}}} (T_{f_{23}} - T_C)\]</div>
<p>where <span class="math notranslate nohighlight">\(\delta x_{f_{23}}\)</span> represents the distance between cell <span class="math notranslate nohighlight">\(C\)</span> and <span class="math notranslate nohighlight">\(f_{23}\)</span>.</p>
<p>Do the same thing for the remain faces (<span class="math notranslate nohighlight">\(f_2, f_3, f_4\)</span>) and get their coefficients <span class="math notranslate nohighlight">\(\color{green}{a_{F_2}, a_{F_3}, a_{F_4}}\)</span> respectively,</p>
<div class="math notranslate nohighlight" id="equation-eq-fvm-afac">
<span class="eqno">(35)<a class="headerlink" href="#equation-eq-fvm-afac" title="Permalink to this equation">¶</a></span>\[\color{green}{a_{f_{23}}} = D\frac{\Delta y_{f_{23}}}{\delta x_{f_{23}}},
\color{green}{a_{F_2}} = D\frac{\Delta x_{f_2}}{\delta y_{f_2}},
\color{green}{a_{F_3}} = D\frac{\Delta x_{f_3}}{\delta y_{f_3}},
\color{green}{a_{F_4}} = D\frac{\Delta y_{f_4}}{\delta x_{f_4}}\]</div>
<p>4.3 Construct coefficients of a specific cell <span class="math notranslate nohighlight">\(C_{12}\)</span></p>
<p>Now we get all the coefficients, thus the <a class="reference internal" href="#equation-eq-fvm-surface-sum-expand">equation (32)</a> can be discretized and expressed as a matrix form,</p>
<div class="math notranslate nohighlight" id="equation-eq-fvm-matrix-form-internalcell">
<span class="eqno">(36)<a class="headerlink" href="#equation-eq-fvm-matrix-form-internalcell" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{eqnarray}
b_{C_{12}} &amp; =  &amp; a_{F_{23}} (T_{F_{23}} - T_C) + a_{F_{24}} (T_{F_{24}} - T_C) + a_{F_{21}} (T_{F_{21}} - T_C) + a_{F_{5}} (T_{F_{5}} - T_C)\\
   &amp; = &amp; \sum\limits_{f\in[23, 24, 21, 5]} a_{F_f} T_{F_f} + \left(-\sum\limits_{f\in[23, 24, 21, 5]} a_{F_f} \right) T_C \\
   &amp; = &amp; \sum\limits_{f\sim nb(\text{internal face})} a_{F_f} T_{F_f} + \left(-\sum\limits_{f\sim nb(\text{all face})} a_{F_f} \right) T_C  \\
\end{eqnarray}\end{split}\]</div>
<div class="math notranslate nohighlight" id="equation-eq-fvm-matrix-form-internalcell12">
<span class="eqno">(37)<a class="headerlink" href="#equation-eq-fvm-matrix-form-internalcell12" title="Permalink to this equation">¶</a></span>\[\mathbf{A}_{N\times N}[12,:] \mathbf{T}_{N\times 1} =  B_{12}\]</div>
<p>where <span class="math notranslate nohighlight">\(B_{12} = b_{12}\)</span>.</p>
</div>
<input class="tab-input" id="tab-set--1-input--2" name="tab-set--1" type="radio"><label class="tab-label" for="tab-set--1-input--2">Boundary cell</label><div class="tab-content docutils container">
<p>For a specific boundary cell, e.g. <strong>cell 19</strong> shown in <a class="reference internal" href="#fig-polymesh-regularbox"><span class="std std-numref">Fig. 34</span></a>, the <a class="reference internal" href="#equation-eq-fvm-surface-sum">equation (31)</a> can be rewritten as,</p>
<div class="math notranslate nohighlight" id="equation-eq-fvm-surface-sum-expand-boundary">
<span class="eqno">(38)<a class="headerlink" href="#equation-eq-fvm-surface-sum-expand-boundary" title="Permalink to this equation">¶</a></span>\[b_{C_{19}} = \iint_{f_{18}}\vec{J}^{T,D}_{f_{18}} \cdot \vec{S}_{f_{18}} + \iint_{f_{35}}\vec{J}^{T,D}_{f_{35}} \cdot \vec{S}_{f_{35}} +\iint_{f_{37}}\vec{J}^{T,D}_{f_{37}} \cdot \vec{S}_{f_{37}} + \color{red}{\iint_{f_{51}}\vec{J}^{T,D}_{f_{51}} \cdot \vec{S}_{f_{51}}}\]</div>
<p>The first and second terms on the right hand side are flux of internal face, so there is nothing special and just calculate them following steps for internal faces we did before. The special thing is the boundary face <span class="math notranslate nohighlight">\(f_{17}\)</span>, we can call it <span class="math notranslate nohighlight">\(f_b\)</span> for a general case. <strong>Now the problem is how to evaluate flux on the boundary face</strong> <span class="math notranslate nohighlight">\(f_b\)</span>.</p>
<p>The The fluxes on the interior faces are discretized as before, while <strong>the boundary flux is discretized with the aim of constructing a linearization with respect to</strong> the cell field <span class="math notranslate nohighlight">\(T_C\)</span>, e.g. <span class="math notranslate nohighlight">\(T_{C_{19}}\)</span> of cell <span class="math notranslate nohighlight">\(C_{19}\)</span> shown in <a class="reference internal" href="#fig-polymesh-regularbox"><span class="std std-numref">Fig. 34</span></a>, thus</p>
<div class="math notranslate nohighlight" id="equation-eq-fvm-surface-flux-boundary">
<span class="eqno">(39)<a class="headerlink" href="#equation-eq-fvm-surface-flux-boundary" title="Permalink to this equation">¶</a></span>\[\color{red}{\iint_{f_{b}}\vec{J}^{T,D}_{f_{b}} \cdot \vec{S}_{f_{b}}} = -a_{F_b} T_C + c_{F_b}\]</div>
<p>All right, <strong>now out goal is to determine the coefficients of</strong> <span class="math notranslate nohighlight">\(a_{F_b}\)</span> and <span class="math notranslate nohighlight">\(c_{F_b}\)</span> according to the boundary conditions. Generally there are two basic kinds of boundary conditions, they are <strong>Dirichlet boundary condition</strong> (also called the first type or fixed value boundary condition) and <strong>Von Neumann boundary condition</strong> (all called the second type or fixed flux boundary condition), respectively.</p>
<p>4.1 Fixed value boundary condition</p>
<p>Fixed value means the value of field <span class="math notranslate nohighlight">\(T\)</span> is given on the boundary face is give, i.e. <span class="math notranslate nohighlight">\(\color{purple}{T_{f_b}}\)</span> is given. There fore we can calculate flux on boundary face, <span class="math notranslate nohighlight">\(f_{51}\)</span> for example,</p>
<div class="math notranslate nohighlight" id="equation-eq-fvm-flux-boundary">
<span class="eqno">(40)<a class="headerlink" href="#equation-eq-fvm-flux-boundary" title="Permalink to this equation">¶</a></span>\[\color{red}{\iint_{f_{51}}\vec{J}^{T,D}_{f_{51}} \cdot \vec{S}_{f_{51}}} = \iint_{f_{51}} (\vec{J}^{T,D}_{f_{51}} \cdot \vec{n}_{f_{51}}) dS_{f_{51}} \approx \color{orange}{\sum\limits_{ip\sim ip(f_{51})} (\vec{J}^{T,D} \cdot \vec{n}_{ip})\omega_{ip} S_{f_{51}}}\]</div>
<p>Here we still use one integration point scheme to explain the calculation process,</p>
<div class="math notranslate nohighlight" id="equation-eq-fvm-flux-gaussian-integral-boundary">
<span class="eqno">(41)<a class="headerlink" href="#equation-eq-fvm-flux-gaussian-integral-boundary" title="Permalink to this equation">¶</a></span>\[\color{orange}{\sum\limits_{ip\sim ip(f_{51})} (\vec{J}^{T,D} \cdot \vec{n}_{ip})\omega S_f } = \left(D \frac{\partial T}{\partial x} \vec{i} + D\frac{\partial T}{\partial y} \vec{j} \right)_{f_{51}} \cdot \Delta y_{f_{51}} \vec{i} = \color{blue}{\left( D\frac{\partial T}{\partial x} \right)_{f_{51}} \Delta y_{f_{51}}}\]</div>
<p>Now let’s calculate the gradient on the boundary face,</p>
<div class="math notranslate nohighlight" id="equation-eq-fvm-gradient-boundary">
<span class="eqno">(42)<a class="headerlink" href="#equation-eq-fvm-gradient-boundary" title="Permalink to this equation">¶</a></span>\[\color{blue}{\left( D\frac{\partial T}{\partial x} \right)_{f_{51}} \Delta y_{f_{51}}} = D\frac{\color{purple}{T_{f_{51}}} - T_{C}}{x_{f_{51}} - x_C}\Delta y_{f_{51}} = D\frac{\color{purple}{T_{f_{51}}} - T_{C}}{\delta x_{f_{51}}}\Delta y_{f_{51}} = \color{green}{a_{F_{51}}} (T_{f_{51}} - T_C)\]</div>
<p>Substituting <a class="reference internal" href="#equation-eq-fvm-gradient-boundary">equation (42)</a> back to  <a class="reference internal" href="#equation-eq-fvm-flux-gaussian-integral-boundary">equation (41)</a>, <a class="reference internal" href="#equation-eq-fvm-flux-boundary">equation (40)</a> and  <a class="reference internal" href="#equation-eq-fvm-surface-flux-boundary">equation (39)</a>, we can get Laplacian discretization coefficients <span class="math notranslate nohighlight">\(a_{f_{51}}\)</span> and <span class="math notranslate nohighlight">\(c_{f_{51}}\)</span>,</p>
<div class="math notranslate nohighlight" id="equation-eq-fvm-laplacian-coeff-boundary-fixedvalue">
<span class="eqno">(43)<a class="headerlink" href="#equation-eq-fvm-laplacian-coeff-boundary-fixedvalue" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{eqnarray}
a_{F_{51}} &amp;=&amp; D\frac{\Delta y_{f_{51}}}{\delta x_{f_{51}}}\\
c_{F_{51}} &amp;=&amp; a_{F_{51}}\color{purple}{T_{f_{51}}}
\end{eqnarray}\end{split}\]</div>
<p>4.2 Fixed flux boundary condition</p>
<p><strong>Fixed flux</strong> means <strong>normal gradient to the boundary face</strong> of field <span class="math notranslate nohighlight">\(T\)</span> is given, i.e. <span class="math notranslate nohighlight">\(\color{purple}{\vec{J}^{T,D}_{f_{b}} \cdot \vec{n}_{f_{b}} = q_{f_b}}\)</span> is given. There fore we can calculate flux on boundary face, <span class="math notranslate nohighlight">\(f_{51}\)</span> for example,</p>
<div class="math notranslate nohighlight" id="equation-eq-fvm-fixedflux-boundary">
<span class="eqno">(44)<a class="headerlink" href="#equation-eq-fvm-fixedflux-boundary" title="Permalink to this equation">¶</a></span>\[\color{red}{\iint_{f_{51}}\vec{J}^{T,D}_{f_{51}} \cdot \vec{S}_{f_{51}}} = \iint_{f_{51}} (\vec{J}^{T,D}_{f_{51}} \cdot \vec{n}_{f_{51}}) dS_{f_{51}} = \iint_{f_{51}} \color{purple}{q_{f_{51}}} dS_{f_{51}} = \color{purple}{q_{f_{51}}} S_{f_{51}} = \color{purple}{q_{f_{51}}} \Delta y_{f_{51}}\]</div>
<p>Substituting <a class="reference internal" href="#equation-eq-fvm-fixedflux-boundary">equation (44)</a> back to <a class="reference internal" href="#equation-eq-fvm-surface-flux-boundary">equation (39)</a>, we can get Laplacian discretization coefficients <span class="math notranslate nohighlight">\(a_{f_{51}}\)</span> and <span class="math notranslate nohighlight">\(c_{f_{51}}\)</span>,</p>
<div class="math notranslate nohighlight" id="equation-eq-fvm-laplacian-coeff-boundary-fixedflux">
<span class="eqno">(45)<a class="headerlink" href="#equation-eq-fvm-laplacian-coeff-boundary-fixedflux" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{eqnarray}
a_{F_{51}} &amp;=&amp; 0 \\
c_{F_{51}} &amp;=&amp; \color{purple}{q_{f_{51}}} \Delta y_{f_{51}}
\end{eqnarray}\end{split}\]</div>
<p>4.3 Construct coefficients of the boundary cell <span class="math notranslate nohighlight">\(C_{19}\)</span></p>
<p>Do the same thing as 4.1 or 4.2 (depends on the type of boundary condition) for all boundary faces of a boundary cell <span class="math notranslate nohighlight">\(C\)</span> and calculate the coefficients of <span class="math notranslate nohighlight">\(a_{F_b}\)</span> and <span class="math notranslate nohighlight">\(c_{F_b}\)</span>, then the <a class="reference internal" href="#equation-eq-fvm-surface-sum-expand-boundary">equation (38)</a> can be expressed as,</p>
<div class="math notranslate nohighlight" id="equation-eq-fvm-matrix-form-boundarycell">
<span class="eqno">(46)<a class="headerlink" href="#equation-eq-fvm-matrix-form-boundarycell" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{eqnarray}
b_{C_{19}} &amp; =  &amp; a_{F_{18}} (T_{F_{18}} - T_C) + a_{F_{35}} (T_{F_{35}} - T_C) + a_{F_{37}} (T_{F_{37}} - T_C) + a_{F_{51}} T_C +c_{F_{51}} \\
   &amp; = &amp; \sum\limits_{f\in[18, 35, 37]} a_{F_f} T_{F_f} + \left(-\sum\limits_{f\in[18, 35, 37, 51]} a_{F_f} \right) T_C + \sum\limits_{f\in[51]} c_{F_f} \\
   &amp; = &amp; \sum\limits_{f\sim nb(\text{internal face})} a_{F_f} T_{F_f} + \left(-\sum\limits_{f\sim nb(\text{all face})} a_{F_f} \right) T_C + \sum\limits_{f\sim nb(\text{boundary face})} c_{F_f}
\end{eqnarray}\end{split}\]</div>
<div class="math notranslate nohighlight" id="equation-eq-fvm-matrix-form-boundarycell19">
<span class="eqno">(47)<a class="headerlink" href="#equation-eq-fvm-matrix-form-boundarycell19" title="Permalink to this equation">¶</a></span>\[\mathbf{A}_{N\times N}[19,:] \mathbf{T}_{N\times 1} =  B_{19}\]</div>
<p>where <span class="math notranslate nohighlight">\(B_{12} = b_{C_{12}} - \sum\limits_{f\sim nb(\text{boundary face})} c_{F_f}\)</span>.</p>
</div>
</div>
<ol class="arabic simple" start="5">
<li><p>Construct general matrix form of the <a class="reference internal" href="#equation-eq-fvm-surface-sum">equation (31)</a></p></li>
</ol>
<div class="math notranslate nohighlight" id="equation-eq-fvm-matrix-form0">
<span class="eqno">(48)<a class="headerlink" href="#equation-eq-fvm-matrix-form0" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{eqnarray}
\sum\limits_{f\sim nb(C)} (D\nabla T)_{F_f}\cdot \vec{S}_{F_f} &amp; = &amp;  \sum\limits_{f\sim \text{internal faces}(C)} a_{F_f} T_{F_f} + \left(-\sum\limits_{f\sim nb(C)} a_{F_f} \right)T_C + \sum\limits_{f\sim \text{boundary faces}(C)} c_{F_{F_f}} \\
&amp; = &amp; a_CT_C + \sum\limits_{f\sim \text{internal faces}(C)} a_{F_f} T_{F_f} + \sum\limits_{f\sim \text{boundary faces}(C)} c_{F_{f}}
\end{eqnarray}\end{split}\]</div>
<p>Considering <span class="math notranslate nohighlight">\(b_C\)</span> matrix form of the <a class="reference internal" href="#equation-eq-fvm-surface-sum">equation (31)</a> can be written as,</p>
<div class="math notranslate nohighlight" id="equation-fvm-matrix-form">
<span class="eqno">(49)<a class="headerlink" href="#equation-fvm-matrix-form" title="Permalink to this equation">¶</a></span>\[\mathbf{A}_{N \times N} \mathbf{T}_{N\times1} = \mathbf{B}_{N\times1}\]</div>
<p>here <span class="math notranslate nohighlight">\(N\)</span> is the number of cell, <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> is a sparse matrix of coefficients,
<span class="math notranslate nohighlight">\(\mathbf{T}\)</span> is cell-centered temperature field, <span class="math notranslate nohighlight">\(\mathbf{B} = \mathbf{b} - \mathbf{c}}\)</span> and <span class="math notranslate nohighlight">\(b\)</span> denotes the transient term which will explained in the later section, <span class="math notranslate nohighlight">\(\mathbf{c}\)</span> is the boundary conditions related term.
For the steady state problem, <span class="math notranslate nohighlight">\(\mathbf{b} \equiv 0\)</span>.
The matrix is visualized as <a class="reference internal" href="#fig-fvm-matrix"><span class="std std-numref">Fig. 36</span></a>.
It should be noted that <strong>the coefficients matrix of Laplacian term is a symmetric matrix and the boundary conditions only affect diagonal entry of the coefficients matrix</strong>. Further, only the fixed value boundary condition affect the matrix.</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--2-input--1" name="tab-set--2" type="radio"><label class="tab-label" for="tab-set--2-input--1">Regular mesh</label><div class="tab-content docutils container">
<div class="figure align-center" id="fig-fvm-matrix" style="width: 100%">
<img alt="../../_images/matrix_FVM_regularBox.svg" src="../../_images/matrix_FVM_regularBox.svg" /><p class="caption"><span class="caption-number">Fig. 36 </span><span class="caption-text">Visualization of <span class="math notranslate nohighlight">\(\mathbf{A}_{N \times N} \mathbf{T}_{N\times1} = \mathbf{b}_{N\times1}\)</span>.
The coefficients of the selected cell <span class="math notranslate nohighlight">\(C\)</span> (<a class="reference internal" href="#fig-polymesh-regularbox"><span class="std std-numref">Fig. 34</span></a>) are marked by green rectangle.</span><a class="headerlink" href="#fig-fvm-matrix" title="Permalink to this image">¶</a></p>
</div>
</div>
<input class="tab-input" id="tab-set--2-input--2" name="tab-set--2" type="radio"><label class="tab-label" for="tab-set--2-input--2">Unstructured mesh</label><div class="tab-content docutils container">
<div class="figure align-center" id="fig-fvm-matrix-unstructured" style="width: 100%">
<img alt="../../_images/matrix_FVM_unstructured.svg" src="../../_images/matrix_FVM_unstructured.svg" /><p class="caption"><span class="caption-number">Fig. 37 </span><span class="caption-text">Visualization of <span class="math notranslate nohighlight">\(\mathbf{A}_{N \times N} \mathbf{T}_{N\times1} = \mathbf{b}_{N\times1}\)</span>.
The coefficients of the selected cell <span class="math notranslate nohighlight">\(C\)</span> (<a class="reference internal" href="#fig-polymesh-regularbox"><span class="std std-numref">Fig. 34</span></a>) are marked by green rectangle.</span><a class="headerlink" href="#fig-fvm-matrix-unstructured" title="Permalink to this image">¶</a></p>
</div>
</div>
</div>
</div>
<div class="section" id="step-5-transient-discretization">
<h3>Step 5: Transient discretization<a class="headerlink" href="#step-5-transient-discretization" title="Permalink to this headline">¶</a></h3>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>working on this</p>
</div>
</div>
<div class="section" id="step-6-solution-of-the-discretized-equations">
<h3>Step 6: Solution of the discretized equations<a class="headerlink" href="#step-6-solution-of-the-discretized-equations" title="Permalink to this headline">¶</a></h3>
<p>The discretization of the differential equation results in a set of discrete algebraic equations, which must be solved to obtain the discrete values of T. The coefficients of these equations may be independent of T (i.e., linear) or dependent on T (i.e. non-linear). The techniques to solve this algebraic system of equations are independent of the discretization method.
The solution methods for solving systems of algebraic equations may be broadly
classified as direct or iterative.</p>
</div>
</div>
<div class="section" id="openfoam-implementation">
<h2>OpenFOAM implementation<a class="headerlink" href="#openfoam-implementation" title="Permalink to this headline">¶</a></h2>
<div class="section" id="step-1-read-data">
<h3>Step 1: Read data<a class="headerlink" href="#step-1-read-data" title="Permalink to this headline">¶</a></h3>
<div class="section" id="read-mesh">
<h4>Read mesh<a class="headerlink" href="#read-mesh" title="Permalink to this headline">¶</a></h4>
<div class="admonition-seconds-thinking admonition">
<p class="admonition-title">10 seconds thinking</p>
<p>What information do we need in the mesh object ?</p>
</div>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--3-input--1" name="tab-set--3" type="radio"><label class="tab-label" for="tab-set--3-input--1">FVM mesh</label><div class="tab-content docutils container">
<ol class="arabic simple">
<li><p>Centroid of face</p></li>
<li><p>Area of face</p></li>
<li><p>Vector of face</p></li>
<li><p>Centroid of cell</p></li>
<li><p>Volume of cell</p></li>
</ol>
</div>
<input class="tab-input" id="tab-set--3-input--2" name="tab-set--3" type="radio"><label class="tab-label" for="tab-set--3-input--2">OpenFOAM code snippit</label><div class="tab-content docutils container">
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">surfaceVectorField</span> <span class="n">Cf</span> <span class="o">=</span> <span class="n">mesh</span><span class="p">.</span><span class="n">Cf</span><span class="p">();</span>
<span class="n">forAll</span><span class="p">(</span><span class="n">Cf</span><span class="p">,</span> <span class="n">iface</span><span class="p">)</span>
<span class="p">{</span>
   <span class="n">Info</span><span class="o">&lt;&lt;</span><span class="n">Cf</span><span class="p">[</span><span class="n">iface</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">&lt;&lt;</span><span class="s">&quot; &quot;</span><span class="o">&lt;&lt;</span><span class="n">Cf</span><span class="p">[</span><span class="n">iface</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">&lt;&lt;</span><span class="s">&quot; &quot;</span><span class="o">&lt;&lt;</span><span class="n">Cf</span><span class="p">[</span><span class="n">iface</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="jupyter-notebook">
<h3>Jupyter notebook<a class="headerlink" href="#jupyter-notebook" title="Permalink to this headline">¶</a></h3>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="cases/jupyter/VisualizeResults.html">1. Read and plot mesh information</a></li>
<li class="toctree-l1"><a class="reference internal" href="cases/jupyter/VisualizeResults.html#2.-Boundary-conditions">2. Boundary conditions</a></li>
<li class="toctree-l1"><a class="reference internal" href="cases/jupyter/VisualizeResults.html#3.-Plot-coefficients-matrix">3. Plot coefficients matrix</a><ul>
<li class="toctree-l2"><a class="reference internal" href="cases/jupyter/VisualizeResults.html#Implementation-in-OpenFOAM">Implementation in OpenFOAM</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="cases/jupyter/VisualizeResults.html#1.-Plot-centroids-of-faces">1. Plot centroids of faces</a></li>
</ul>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="cases/jupyter/VisualizeResults.html" class="btn btn-neutral float-right" title="1. Read and plot mesh information" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="intro.html" class="btn btn-neutral float-left" title="FVM and OpenFoam" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020, Lars Ruepke and Zhikui Guo.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>