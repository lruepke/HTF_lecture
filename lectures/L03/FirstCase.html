


<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Hydrothermal convection test case &mdash; HydrothermalFoam Lecture  documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/tabs.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/style.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/tabs.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Excercises" href="Exercise.html" />
    <link rel="prev" title="Porous Flow - Submarine Hydrothermal Systems" href="intro.html" /> 
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-EJ32EEFYRN"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-EJ32EEFYRN');
    </script>   

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> HydrothermalFoam Lecture
          

          
            
            <img src="../../_static/htf_picto2.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
    
            
            
              
            
            
              <p class="caption"><span class="caption-text">Course information</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../general-info/course-details.html">Course details</a></li>
</ul>
<p class="caption"><span class="caption-text">Lecture 1</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../L01/Overview.html">Lecture overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L01/slide.html">Accompanying slide deck</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L01/Installation.html">Installation guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L01/OpenFoam.html">Getting started with OpenFoam</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L01/FirstCase.html">A first test case - heat diffusion</a></li>
</ul>
<p class="caption"><span class="caption-text">Lecture 2</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../L02/Overview.html">Lecture overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L02/slide.html">Accompanying slide deck</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L02/intro.html">Navier-Stokes flow with OpenFoam</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L02/Example.html">Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L02/Exercise.html">Excercise</a></li>
</ul>
<p class="caption"><span class="caption-text">Lecture 3</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Overview.html">Lecture overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="slide.html">Accompanying slide deck</a></li>
<li class="toctree-l1"><a class="reference internal" href="intro.html">Porous Flow - Submarine Hydrothermal Systems</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Hydrothermal convection test case</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#prepare-case-files">Prepare case files</a></li>
<li class="toctree-l2"><a class="reference internal" href="#mesh-generation">Mesh generation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#boundary-conditions">Boundary conditions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#transport-properties">Transport properties</a></li>
<li class="toctree-l2"><a class="reference internal" href="#case-control">Case control</a></li>
<li class="toctree-l2"><a class="reference internal" href="#running-the-case">Running the case</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Exercise.html">Excercises</a></li>
</ul>
<p class="caption"><span class="caption-text">Lecture 4</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../L04/Overview.html">Lecture overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L04/intro.html">Upflow temperatures in submarine hydrothermal systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L04/Exercise1.html">Exercise 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L04/Exercise2.html">Exercise 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L04/Exercise3.html">Exercise 3</a></li>
</ul>
<p class="caption"><span class="caption-text">Lecture 5</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../L05/Overview.html">Lecture overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L05/intro.html">Structural controls on hydrothermal flow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L05/Exercise1.html">Exercise 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L05/Exercise2.html">Exercise 2</a></li>
</ul>
<p class="caption"><span class="caption-text">Lecture 6</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../L_FVM/Overview.html">Lecture overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L_FVM/intro.html">FVM and OpenFoam</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L_FVM/Exercise1.html">Exercise 1</a></li>
</ul>
<p class="caption"><span class="caption-text">References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../refs.html">References</a></li>
</ul>

            
          

    
        <p class="caption">
            <span class="caption-text">Getting help</span>
        </p>
        <ul>
            
                <li class="toctree-l1"><a href="mailto:lruepke@geomar.de"><i class="fa fa-envelope fa-fw"></i> Prof. Lars Ruepke</a></li>
            
                <li class="toctree-l1"><a href="mailto:zguo@geomar.de"><i class="fa fa-envelope fa-fw"></i> Dr. Zhikui Guo</a></li>
            
                <li class="toctree-l1"><a href="https://www.hydrothermalfoam.info"><i class="fa fa-gitlab fa-fw"></i> HydrothermalFoam</a></li>
            
                <li class="toctree-l1"><a href="https://www.openfoam.org"><i class="fa fa-github fa-fw"></i> OpenFOAM</a></li>
            
                <li class="toctree-l1"><a href="https://lruepke.github.io/HTF_lecture/"><i class="fa fa-home fa-fw"></i> Public site</a></li>
            
                <li class="toctree-l1"><a href="https://lms.uni-kiel.de/url/RepositoryEntry/3664576582"><i class="fa fa-home fa-fw"></i> University site</a></li>
            
        </ul>
    

        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">HydrothermalFoam Lecture</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Hydrothermal convection test case</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            
              <a href="https://github.com/lruepke/HTF_lecture/blob/main//source/lectures/L03/FirstCase.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="hydrothermal-convection-test-case">
<span id="l03-firstcase"></span><h1>Hydrothermal convection test case<a class="headerlink" href="#hydrothermal-convection-test-case" title="Permalink to this headline">¶</a></h1>
<div class="section" id="prepare-case-files">
<h2>Prepare case files<a class="headerlink" href="#prepare-case-files" title="Permalink to this headline">¶</a></h2>
<p>To get started we will run the <strong>Regular2DBox</strong> case from the cookbook directory of <a class="reference external" href="https://gitlab.com/gmdpapers/hydrothermalfoam">HydrothermalFoam</a>. This cookbooks describes how we can simulate a simple hydrothermal convection cell. It resolves hydrothermal convection driven by a gaussian-shaped constant temperature boundary condition at the bottom.</p>
<p>Copy the  case into your shared working directory (probably $HOME/HydrothermalFoam_runs). You need to do this within the docker container (your right-hand shell in Visual Studio Code if you followed the recommended setup). Cd into your shared folder and type this:</p>
<div class="highlight-bash notranslate" id="lst-cp2dboxtoworkdir"><div class="highlight"><pre><span></span><span class="nb">cd</span> <span class="nv">$HOME</span>/HydrothermalFoam_runs
cp -r <span class="nv">$HOME</span>/hydrothermalfoam-master/cookbooks/2d/Regular2DBox .
</pre></div>
</div>
<p>Check out the directory structure shown in <a class="reference internal" href="#lst-2dbox-tree"><span class="std std-numref">Listing 11</span></a>.</p>
<div class="literal-block-wrapper docutils container" id="lst-2dbox-tree">
<div class="code-block-caption"><span class="caption-number">Listing 11 </span><span class="caption-text">File tree structure of the Regular2DBox case.</span><a class="headerlink" href="#lst-2dbox-tree" title="Permalink to this code">¶</a></div>
<div class="highlight-bash notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="highlight"><pre><span></span>.
<span class="p">|</span>-- <span class="m">0</span>
<span class="hll"><span class="p">|</span>   <span class="p">|</span>-- T
</span><span class="hll"><span class="p">|</span>   <span class="p">|</span>-- p
</span><span class="hll"><span class="p">|</span>    -- permeability
</span><span class="p">|</span>-- a.foam
<span class="p">|</span>-- clean.sh
<span class="p">|</span>-- constant
<span class="p">|</span>   <span class="p">|</span>-- g
<span class="hll"><span class="p">|</span>    -- thermophysicalProperties
</span><span class="p">|</span>-- run.sh
 -- system
    <span class="p">|</span>-- blockMeshDict
    <span class="p">|</span>-- controlDict
    <span class="p">|</span>-- fvSchemes
     -- fvSolution.
</pre></div>
</td></tr></table></div>
</div>
<p>The 0 directory now has entries for T (temperature) and p (pressure) our new primary variables, and for permeability, which we will discuss later. In addition, the constant directory has an entry thermophysicalProperties, which describes the solid properties.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Most OpenFoam cases include scripts like <code class="code docutils literal notranslate"><span class="pre">run.sh</span></code> and <code class="code docutils literal notranslate"><span class="pre">clean.sh</span></code>. The <code class="code docutils literal notranslate"><span class="pre">run.sh</span></code> script is a good starting point for “understanding” a case. It lists all commands that have to be executed (e.g. meshing, setting of properties, etc.) to run a case. The <code class="code docutils literal notranslate"><span class="pre">clean.sh</span></code> script cleans up the case and deletes e.g. the mesh and all output directories. Have a look into these files and see if you understand them!</p>
</div>
<p>The 0 directory contains all initial and boundary conditions, the system folder contains all controlling parameter files, and the constant folder contains constant properties like the mesh - which we will create next.</p>
</div>
<div class="section" id="mesh-generation">
<h2>Mesh generation<a class="headerlink" href="#mesh-generation" title="Permalink to this headline">¶</a></h2>
<p>The case is run on a simple 2-d-box-like geometry and the mesh is build using <code class="code docutils literal notranslate"><span class="pre">blockMesh</span></code>, just like in the previous lecture on cavity flow. Look at <code class="code docutils literal notranslate"><span class="pre">blockMeshDict</span></code> and check that you sill understand the structure. Afterwards, you can create the mesh:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>blockMesh
</pre></div>
</div>
<p>After making the mesh, you can use <a class="reference external" href="https://www.paraview.org">Paraview</a> to visualize it,</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>touch a.foam
paraview a.foam
</pre></div>
</div>
</div>
<div class="section" id="boundary-conditions">
<h2>Boundary conditions<a class="headerlink" href="#boundary-conditions" title="Permalink to this headline">¶</a></h2>
<p>Next we need to set boundary conditions. Open the file T inside the 0 directory from your local left-hand shell.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>code <span class="m">0</span>/T
</pre></div>
</div>
<div class="literal-block-wrapper docutils container" id="lst-2dbox-bc">
<div class="code-block-caption"><span class="caption-number">Listing 12 </span><span class="caption-text">Boundary conditions</span><a class="headerlink" href="#lst-2dbox-bc" title="Permalink to this code">¶</a></div>
<div class="highlight-foam notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cm">/*--------------------------------*- C++ -*----------------------------------*\</span>
<span class="cm">| =========                 |                                                 |</span>
<span class="cm">| \\      /  F ield         | OpenFOAM: The Open Source CFD Toolbox           |</span>
<span class="cm">|  \\    /   O peration     | Version:  5                                     |</span>
<span class="cm">|   \\  /    A nd           | Web:      www.OpenFOAM.org                      |</span>
<span class="cm">|    \\/     M anipulation  |                                                 |</span>
<span class="cm">\*---------------------------------------------------------------------------*/</span>
<span class="k">FoamFile</span>
<span class="p">{</span>
    <span class="kt">version</span>     <span class="mf">2.0</span><span class="p">;</span>
    <span class="kt">format</span>      <span class="k">ascii</span><span class="p">;</span>
    <span class="kt">class</span>       <span class="n">volScalarField</span><span class="p">;</span>
    <span class="kt">object</span>      <span class="k">T</span><span class="p">;</span>
<span class="p">}</span>
<span class="c1">// * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * //</span>

<span class="hll"><span class="kt">dimensions</span>      <span class="p">[</span><span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span><span class="p">];</span>
</span>
<span class="kt">internalField</span>   <span class="k">uniform</span> <span class="mf">278.15</span><span class="p">;</span>     <span class="c1">//278.15 K = 5 C</span>

<span class="k">boundaryField</span>
<span class="p">{</span>
    <span class="n">left</span>
    <span class="p">{</span>
        <span class="kt">type</span>            <span class="k">zeroGradient</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">right</span>
    <span class="p">{</span>
<span class="hll">        <span class="kt">type</span>            <span class="k">zeroGradient</span><span class="p">;</span>
</span>    <span class="p">}</span>
    <span class="n">top</span>
    <span class="p">{</span>
        <span class="c1">//type            fixedValue;</span>
        <span class="c1">//value           uniform 273.15;</span>
<span class="hll">        <span class="kt">type</span>            <span class="n">inletOutlet</span><span class="p">;</span>
</span>        <span class="k">phi</span>                     <span class="k">phi</span><span class="p">;</span>
        <span class="k">inletValue</span>      <span class="k">uniform</span> <span class="mf">278.15</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">bottom</span>
    <span class="p">{</span>
<span class="hll">        <span class="kt">type</span>            <span class="n">codedFixedValue</span><span class="p">;</span>
</span><span class="hll">        <span class="kt">value</span>           <span class="k">uniform</span> <span class="mf">873.15</span><span class="p">;</span>
</span><span class="hll">        <span class="n">name</span>            <span class="n">gaussShapeT</span><span class="p">;</span>
</span><span class="hll">        <span class="n">code</span>            <span class="err">#</span><span class="p">{</span>
</span><span class="hll">                            <span class="n">scalarField</span> <span class="n">x</span><span class="p">(</span><span class="n">this</span><span class="o">-&gt;</span><span class="n">patch</span><span class="p">().</span><span class="n">Cf</span><span class="p">().</span><span class="n">component</span><span class="p">(</span><span class="mi">0</span><span class="p">));</span>
</span><span class="hll">                            <span class="kt">double</span> <span class="n">wGauss</span><span class="o">=</span><span class="mi">200</span><span class="p">;</span>
</span><span class="hll">                            <span class="kt">double</span> <span class="k">x0</span><span class="o">=</span><span class="mi">1000</span><span class="p">;</span>
</span><span class="hll">                            <span class="kt">double</span> <span class="n">Tmin</span><span class="o">=</span><span class="mi">573</span><span class="p">;</span>
</span><span class="hll">                            <span class="kt">double</span> <span class="n">Tmax</span><span class="o">=</span><span class="mf">873.15</span><span class="p">;</span>
</span><span class="hll">                            <span class="n">scalarField</span> <span class="nf">T</span><span class="p">(</span><span class="n">Tmin</span><span class="o">+</span><span class="p">(</span><span class="n">Tmax</span><span class="o">-</span><span class="n">Tmin</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="k">x0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="k">x0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">wGauss</span><span class="o">*</span><span class="n">wGauss</span><span class="p">)));</span>
</span><span class="hll">                            <span class="n">operator</span><span class="o">==</span><span class="p">(</span><span class="k">T</span><span class="p">);</span>
</span><span class="hll">                        <span class="cp">#};</span>
</span>    <span class="p">}</span>
    <span class="n">frontAndBack</span>
    <span class="p">{</span>
        <span class="kt">type</span>            <span class="n">empty</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// ************************************************************************* //</span>
</pre></div>
</td></tr></table></div>
</div>
<p>The boundary conditions are again set for the patches that were defined in the blockMeshDict. Notice how the side are insulating (zeroGradient). The top has a  boundary condition called inletOutlet; it sets a constant inflow temperature (recharge of cold seawater) and assumes zeroGradient for the outflow (mimicing free fluid venting). The bottom boundary condition is special, it is set to codedFixedValue. The codedFixedValue BC allows “programming” a boundary condition on the fly. Here a gaussian-shapes constant temperature boundary condition is programmed. Note that <code class="code docutils literal notranslate"><span class="pre">x(this-&gt;patch().Cf().component(0))</span></code> is the x-coordinate of each FV face of the patch “bottom”.</p>
<p>Units are set by the dimensions keyword. The entries refer to the standard SI units [Kg m s K mol A cd]. By having a one in the fourth columns, the units of the defined properties has units of Kelvin.</p>
<p>We also need to set boundary conditions for pressure.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>code <span class="m">0</span>/p
</pre></div>
</div>
<div class="literal-block-wrapper docutils container" id="lst-2dbox-bc-p">
<div class="code-block-caption"><span class="caption-number">Listing 13 </span><span class="caption-text">Boundary conditions</span><a class="headerlink" href="#lst-2dbox-bc-p" title="Permalink to this code">¶</a></div>
<div class="highlight-foam notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cm">/*--------------------------------*- C++ -*----------------------------------*\</span>
<span class="cm">| =========                 |                                                 |</span>
<span class="cm">| \\      /  F ield         | OpenFOAM: The Open Source CFD Toolbox           |</span>
<span class="cm">|  \\    /   O peration     | Version:  5                                     |</span>
<span class="cm">|   \\  /    A nd           | Web:      www.OpenFOAM.org                      |</span>
<span class="cm">|    \\/     M anipulation  |                                                 |</span>
<span class="cm">\*---------------------------------------------------------------------------*/</span>
<span class="k">FoamFile</span>
<span class="p">{</span>
    <span class="kt">version</span>     <span class="mf">2.0</span><span class="p">;</span>
    <span class="kt">format</span>      <span class="k">ascii</span><span class="p">;</span>
    <span class="kt">class</span>       <span class="n">volScalarField</span><span class="p">;</span>
    <span class="kt">object</span>      <span class="k">p</span><span class="p">;</span>
<span class="p">}</span>
<span class="c1">// * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * //</span>

<span class="hll"><span class="kt">dimensions</span>      <span class="p">[</span><span class="mi">1</span> <span class="o">-</span><span class="mi">1</span> <span class="o">-</span><span class="mi">2</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span><span class="p">];</span>
</span>
<span class="kt">internalField</span>   <span class="k">uniform</span> <span class="mf">300e5</span><span class="p">;</span>

<span class="k">boundaryField</span>
<span class="p">{</span>
    <span class="n">left</span>
    <span class="p">{</span>
        <span class="kt">type</span>            <span class="n">noFlux</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">right</span>
    <span class="p">{</span>
        <span class="kt">type</span>            <span class="n">noFlux</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">top</span>
    <span class="p">{</span>
<span class="hll">        <span class="kt">type</span>            <span class="n">submarinePressure</span><span class="p">;</span>
</span>        <span class="kt">value</span>           <span class="k">uniform</span> <span class="mf">300e5</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">bottom</span>
    <span class="p">{</span>
        <span class="kt">type</span>            <span class="n">noFlux</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">frontAndBack</span>
    <span class="p">{</span>
        <span class="kt">type</span>            <span class="n">empty</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// ************************************************************************* //</span>
</pre></div>
</td></tr></table></div>
</div>
<p>The <code class="code docutils literal notranslate"><span class="pre">noFlux</span></code> boundary conditions, sets the pressure gradient to zero (horizontal direction) and hydrostatic (vertical direction), so that no flow occurs through these boundaries. The <code class="code docutils literal notranslate"><span class="pre">submarinePressure</span></code> boundary condition is provided by <a class="reference external" href="https://gitlab.com/gmdpapers/hydrothermalfoam">HydrothermalFoam</a> and sets the pressure according to water depth. Change it to fixedValue; we will discuss the special boundary conditions later.</p>
</div>
<div class="section" id="transport-properties">
<h2>Transport properties<a class="headerlink" href="#transport-properties" title="Permalink to this headline">¶</a></h2>
<p>In hydrothermal convection simulations, the fluid properties are given by the used EOS (details on this in the next lecture). What we need to set are the solid properties like permeability, solid density, solid specific heat, and porosity. These are set in two different files. Permeabilty is treated as a variable and is set in the 0 directory.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>code <span class="m">0</span>/permeability
</pre></div>
</div>
<div class="literal-block-wrapper docutils container" id="lst-2dbox-perm">
<div class="code-block-caption"><span class="caption-number">Listing 14 </span><span class="caption-text">Permeability on hydrothermal flow simulations.</span><a class="headerlink" href="#lst-2dbox-perm" title="Permalink to this code">¶</a></div>
<div class="highlight-foam notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cm">/*--------------------------------*- C++ -*----------------------------------*\</span>
<span class="cm">| =========                 |                                                 |</span>
<span class="cm">| \\      /  F ield         | OpenFOAM: The Open Source CFD Toolbox           |</span>
<span class="cm">|  \\    /   O peration     | Version:  5.0                                   |</span>
<span class="cm">|   \\  /    A nd           | Web:      www.OpenFOAM.org                      |</span>
<span class="cm">|    \\/     M anipulation  |                                                 |</span>
<span class="cm">\*---------------------------------------------------------------------------*/</span>
<span class="k">FoamFile</span>
<span class="p">{</span>
    <span class="kt">version</span>     <span class="mf">2.0</span><span class="p">;</span>
    <span class="kt">format</span>      <span class="k">ascii</span><span class="p">;</span>
    <span class="kt">class</span>       <span class="n">volScalarField</span><span class="p">;</span>
    <span class="kt">location</span>    <span class="s">&quot;0&quot;</span><span class="p">;</span>
    <span class="kt">object</span>      <span class="n">permeability</span><span class="p">;</span>
<span class="p">}</span>
<span class="c1">// * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * //</span>

<span class="hll"><span class="kt">dimensions</span>      <span class="p">[</span><span class="mi">0</span> <span class="mi">2</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span><span class="p">];</span>
</span>
<span class="kt">internalField</span>   <span class="k">uniform</span> <span class="mf">1e-14</span><span class="p">;</span>
</pre></div>
</td></tr></table></div>
</div>
<p>Again, check that you understand the units, which here add up to m^2.</p>
<p>Next we look at the solid properties:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>code constant/thermophysicalProperties
</pre></div>
</div>
<p>Check that you understand the units! Details can be found in the <a class="reference external" href="https://gitlab.com/gmdpapers/hydrothermalfoam">HydrothermalFoam</a> documentation.</p>
</div>
<div class="section" id="case-control">
<h2>Case control<a class="headerlink" href="#case-control" title="Permalink to this headline">¶</a></h2>
<p>Finally, we need to set some control parameters like the time step, run time, output writing. These kind of parameters are set in system/controlDict. Open it and explore the values</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>code system/controlDict
</pre></div>
</div>
<div class="literal-block-wrapper docutils container" id="lst-2dbox-cdict">
<div class="code-block-caption"><span class="caption-number">Listing 15 </span><span class="caption-text">controlDict of the Regular2DBox case.</span><a class="headerlink" href="#lst-2dbox-cdict" title="Permalink to this code">¶</a></div>
<div class="highlight-foam notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cm">/*--------------------------------*- C++ -*----------------------------------*\</span>
<span class="cm">| =========                 |                                                 |</span>
<span class="cm">| \\      /  F ield         | OpenFOAM: The Open Source CFD Toolbox           |</span>
<span class="cm">|  \\    /   O peration     | Version:  5                                     |</span>
<span class="cm">|   \\  /    A nd           | Web:      www.OpenFOAM.org                      |</span>
<span class="cm">|    \\/     M anipulation  |                                                 |</span>
<span class="cm">\*---------------------------------------------------------------------------*/</span>
<span class="k">FoamFile</span>
<span class="p">{</span>
    <span class="kt">version</span>     <span class="mf">2.0</span><span class="p">;</span>
    <span class="kt">format</span>      <span class="k">ascii</span><span class="p">;</span>
    <span class="kt">class</span>       <span class="k">dictionary</span><span class="p">;</span>
    <span class="kt">object</span>      <span class="k">controlDict</span><span class="p">;</span>
<span class="p">}</span>

<span class="hll"><span class="kt">application</span> <span class="n">HydrothermalSinglePhaseDarcyFoam</span><span class="p">;</span>
</span><span class="kt">startFrom</span> <span class="k">latestTime</span><span class="p">;</span>
<span class="kt">startTime</span> <span class="mi">0</span><span class="p">;</span>
<span class="kt">stopAt</span> <span class="kt">endTime</span><span class="p">;</span>
<span class="kt">endTime</span> <span class="mi">16912000000</span><span class="p">;</span> <span class="c1">//86400000000</span>
<span class="kt">deltaT</span> <span class="mi">864000</span><span class="p">;</span>
<span class="kt">adjustTimeStep</span> <span class="n">yes</span><span class="p">;</span>
<span class="kt">maxCo</span>           <span class="mf">0.8</span><span class="p">;</span>
<span class="kt">maxDeltaT</span>       <span class="mi">86400000</span><span class="p">;</span>
<span class="kt">writeControl</span> <span class="n">adjustableRunTime</span><span class="p">;</span>
<span class="kt">writeInterval</span> <span class="mi">86400000</span><span class="p">;</span>
<span class="kt">purgeWrite</span> <span class="mi">0</span><span class="p">;</span>
<span class="kt">writeFormat</span> <span class="k">ascii</span><span class="p">;</span>
<span class="kt">writePrecision</span> <span class="mi">6</span><span class="p">;</span>
<span class="kt">writeCompression</span> <span class="k">off</span><span class="p">;</span>
<span class="kt">timeFormat</span> <span class="k">general</span><span class="p">;</span>
<span class="kt">timePrecision</span> <span class="mi">14</span><span class="p">;</span>
<span class="kt">runTimeModifiable</span> <span class="nb">true</span><span class="p">;</span>
<span class="kt">libs</span>
<span class="p">(</span>

<span class="hll">    <span class="s">&quot;libHydrothermalBoundaryConditions.so&quot;</span>
</span><span class="hll">    <span class="s">&quot;libHydroThermoPhysicalModels.so&quot;</span>
</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
</div>
<p>The solver we are using is called HydrothermalSinglePhaseDarcyFoam. In addition, we are including two libraries “libHydrothermalBoundaryConditions.so”; these are part of <a class="reference external" href="https://gitlab.com/gmdpapers/hydrothermalfoam">HydrothermalFoam</a> and provide special boundary conditions for submarine hydrothermal flow calculations.</p>
</div>
<div class="section" id="running-the-case">
<h2>Running the case<a class="headerlink" href="#running-the-case" title="Permalink to this headline">¶</a></h2>
<p>Now we are finally ready to run our first test case. Just type this into your docker shell:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>HydrothermalSinglePhaseDarcyFoam
</pre></div>
</div>
<p>Notice how several directories are appearing, which contain the intermediate results. You can postprocess the case by simply opening the <code class="code docutils literal notranslate"><span class="pre">a.foam</span></code> file from paraview.</p>
<div class="figure align-center" id="fig-regular2dbox-fig">
<img alt="../../_images/RegularBox2D.png" src="../../_images/RegularBox2D.png" />
<p class="caption"><span class="caption-number">Fig. 13 </span><span class="caption-text">Results of the Regular2DBox example calculation.</span><a class="headerlink" href="#fig-regular2dbox-fig" title="Permalink to this image">¶</a></p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="Exercise.html" class="btn btn-neutral float-right" title="Excercises" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="intro.html" class="btn btn-neutral float-left" title="Porous Flow - Submarine Hydrothermal Systems" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020, Lars Ruepke and Zhikui Guo.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>