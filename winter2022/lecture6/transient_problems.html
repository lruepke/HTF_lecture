
<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Transient heat diffusion &mdash; Finite Element Modeling in Geodynamics  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/tabs.css" type="text/css" />
      <link rel="stylesheet" href="../_static/plot_directive.css" type="text/css" />
      <link rel="stylesheet" href="../_static/style.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../_static/tabs.js?v=3ee01567"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Coupled diffusion problems" href="turing_coupled_problem.html" />
    <link rel="prev" title="Overview" href="overview.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Finite Element Modeling in Geodynamics
              <img src="../_static/triangle_fem_cover.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
    
              <p class="caption" role="heading"><span class="caption-text">Course information</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../general-info/course-details.html">Course details</a></li>
<li class="toctree-l1"><a class="reference internal" href="../general-info/installation.html">Installation guide</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Lecture 1</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../lecture1/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lecture1/fdm_intro.html">Introduction: The Finite Differences Method (FDM)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lecture1/example_1.html">Example 1: Cooling dike</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lecture1/example_2.html">Example 2: Cooling dike - implicit version</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lecture1/example_3.html">Example 3: Periodic variations in seafloor temperature</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lecture1/fdm_advection.html">Transport problems with FDM</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Lecture 2</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../lecture2/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lecture2/mwr_intro.html">Introduction: Method of Weighted Residuals (MWR)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lecture2/mwr_examples.html">MWR solutions of the steady advection-diffusion equation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lecture2/excercises.html">Excercises</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Lecture 3</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../lecture3/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lecture3/fem_intro.html">Introduction Finite Element Method (FEM)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lecture3/fem_intro.html#fem-implementation">FEM implementation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lecture3/fem_advection.html">FEM and advection problems</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Lecture 4</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../lecture4/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lecture4/fem_in_2d.html">2-D FEM - elliptic problems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lecture4/fem_in_2d.html#implementation">Implementation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Lecture 5</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../lecture5/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lecture5/FEM_triangles.html">Triangles: unstructured meshes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lecture5/FEM_triangles.html#excercise">Excercise</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Lecture 6</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Transient heat diffusion</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#fem-form">FEM form</a></li>
<li class="toctree-l2"><a class="reference internal" href="#implementation">Implementation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#time-loop-and-output-writing">Time loop and output writing</a></li>
<li class="toctree-l3"><a class="reference internal" href="#matrix-assembly">Matrix assembly</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="turing_coupled_problem.html">Coupled diffusion problems</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../refs.html">References</a></li>
</ul>


    
        <p class="caption">
            <span class="caption-text">Getting help</span>
        </p>
        <ul>
            
                <li class="toctree-l1"><a href="https://lruepke.github.io/HTF_lecture/imprint/"><i class="fa fa-stamp"></i> Imprint</a></li>
            
                <li class="toctree-l1"><a href="mailto:lruepke@geomar.de"><i class="fa fa-envelope fa-fw"></i> Prof. Lars Ruepke</a></li>
            
                <li class="toctree-l1"><a href="mailto:zguo@geomar.de"><i class="fa fa-envelope fa-fw"></i> Dr. Zhikui Guo</a></li>
            
                <li class="toctree-l1"><a href="https://lruepke.github.io/FEM_lecture/"><i class="fa fa-home fa-fw"></i> Public site</a></li>
            
                <li class="toctree-l1"><a href="https://lms.uni-kiel.de/url/RepositoryEntry/3664576582"><i class="fa fa-home fa-fw"></i> University site</a></li>
            
        </ul>
    

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Finite Element Modeling in Geodynamics</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Transient heat diffusion</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/lruepke/HTF_lecture/blob/main//source/lecture6/transient_problems.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="transient-heat-diffusion">
<h1>Transient heat diffusion<a class="headerlink" href="#transient-heat-diffusion" title="Link to this heading"></a></h1>
<p>The next step is to derive and implement the unsteady (time-dependent) heat diffusion equation and to solve an example problem for the cooling of the lithosphere. The unsteady heat diffusion equation looks like this:</p>
<div class="math notranslate nohighlight" id="equation-eq-fem-2d-transient">
<span class="eqno">(140)<a class="headerlink" href="#equation-eq-fem-2d-transient" title="Link to this equation"></a></span>\[\rho c_p \frac{\partial T}{\partial t} = \frac{\partial}{\partial x} k \frac{\partial T}{\partial x} + \frac{\partial}{\partial y}k\frac{\partial T}{\partial y}\]</div>
<p>Two differences to the previously considered steady heat diffusion are apparent. First, we now have a time derivative in addition to the spatial derivatives. Second, the material parameters (density, specific heat, thermal conductivity) are not constant (neglected) any more. Nevertheless, the diffusion part of <a class="reference internal" href="#equation-eq-fem-2d-transient">equation (140)</a> looks very similar to the steady-state case that we know how to solve.</p>
<p>We know how to handle spatial derivatives but this is the first time we encounter a time derivative in finite elements. To solve it we will use a “trick” from finite differences – we will simply write the time derivative in finite differences form.</p>
<div class="math notranslate nohighlight" id="equation-eq-fem-2d-transient-2">
<span class="eqno">(141)<a class="headerlink" href="#equation-eq-fem-2d-transient-2" title="Link to this equation"></a></span>\[\rho c_p \frac{T^{n+1} - T^n}{\Delta t} = \frac{\partial}{\partial x} k\frac{\partial T^{n+1}}{\partial x} + \frac{\partial}{\partial y}k\frac{\partial T^{n+1}}{\partial y}.\]</div>
<p>Re-arrange <a class="reference internal" href="#equation-eq-fem-2d-transient">equation (140)</a> so that all known temperatures <span class="math notranslate nohighlight">\(T^n\)</span> are on the Rhs and all unknown temperatures <span class="math notranslate nohighlight">\(T^{n+1}\)</span> are on the Lhs.</p>
<div class="math notranslate nohighlight" id="equation-eq-fem-2d-transient-3">
<span class="eqno">(142)<a class="headerlink" href="#equation-eq-fem-2d-transient-3" title="Link to this equation"></a></span>\[\rho c_p T^{n+1} - \Delta t \left( \frac{\partial}{\partial x} k\frac{\partial T^{n+1}}{\partial x} + \frac{\partial}{\partial y}k\frac{\partial T^{n+1}}{\partial y} \right ) = \rho c_p T^{n}.\]</div>
<section id="fem-form">
<h2>FEM form<a class="headerlink" href="#fem-form" title="Link to this heading"></a></h2>
<p>Now we proceed in the usual way: insert the approximate solution using shape functions and use the Galerkin method:</p>
<div class="math notranslate nohighlight" id="equation-eq-fem-2d-transient-weak">
<span class="eqno">(143)<a class="headerlink" href="#equation-eq-fem-2d-transient-weak" title="Link to this equation"></a></span>\[\int_\Omega  \rho c_p N_i N_j T^{n+1}_j d\Omega -  \int_\Omega N_i  \Delta t \left ( \frac{\partial}{\partial x}k\frac{\partial N_j T^{n+1}_j }{\partial x} + N_i \frac{\partial}{\partial y}k\frac{\partial N_j T^{n+1}_j }{\partial y} \right ) d\Omega= \int_\Omega  \rho c_p N_i N_j T^{n}_j d\Omega   0\ \ \ \ \ \ \ i=1,2,...,n\]</div>
<p>and integrate the diffusion term by parts:</p>
<div class="math notranslate nohighlight" id="equation-eq-fem-2d-transient-weak-v2">
<span class="eqno">(144)<a class="headerlink" href="#equation-eq-fem-2d-transient-weak-v2" title="Link to this equation"></a></span>\[\int_\Omega  \rho c_p N_i N_j T^{n+1}_j d\Omega +  \int_\Omega \left ( \Delta t  \frac{\partial N_i}{\partial x}k\frac{\partial N_j T_j }{\partial x} + \frac{\partial N_i}{\partial y}k\frac{\partial N_j T_j }{\partial y} d\Omega \right ) d\Omega= \int_\Omega  \rho c_p N_i N_j T^{n}_j d\Omega  - \oint_{\Gamma} N_i \Delta t \vec{q}\vec{n}  d\Gamma\ \ \ \ \ \ \ i=1,2,...,n\]</div>
<p>We can proceed and write everything in terms of matrices:</p>
<div class="math notranslate nohighlight" id="equation-eq-fem-2d-transient-weak-matrix">
<span class="eqno">(145)<a class="headerlink" href="#equation-eq-fem-2d-transient-weak-matrix" title="Link to this equation"></a></span>\[\begin{split}\left( \rho c_p M  + \Delta t A  \right ) T^{n+1} =  \rho c_p M  T^{n} + BC \\\end{split}\]</div>
<p>With the matrices being define as:</p>
<div class="math notranslate nohighlight" id="equation-eq-fem-2d-transient-weak-matrix-v2">
<span class="eqno">(146)<a class="headerlink" href="#equation-eq-fem-2d-transient-weak-matrix-v2" title="Link to this equation"></a></span>\[\begin{split}\begin{align}
\begin{split}
M &amp;= \int_\Omega N_i N_j  d\Omega \ \ \ \ \ \ \ i,j=1,2,...,n\\
A &amp;= \int_\Omega \left ( \frac{\partial N_i}{\partial x}k\frac{\partial N_j }{\partial x} + \frac{\partial N_i}{\partial y}k\frac{\partial N_j }{\partial y} d\Omega \right ) d\Omega\ \ \ \ \ \ \ i,j=1,2,...,n\\
\end{split}
\end{align}\end{split}\]</div>
<p>The matrix <span class="math notranslate nohighlight">\(M\)</span> is called the mass matrix. The terms in brackets on the LHS of <a class="reference internal" href="#equation-eq-fem-2d-transient-weak-matrix">equation (145)</a> will become the new matrix that is assembled per element and added to the global stiffness matrix.</p>
</section>
<section id="implementation">
<h2>Implementation<a class="headerlink" href="#implementation" title="Link to this heading"></a></h2>
<p>We implement the transient behavior into our triangle script from the previous lecture. If you didn’t complete it, you can download it from here (<a class="reference download internal" download="" href="../_downloads/5ea8b5ce96749a30d75b2bcc04c7bd29/2d_fem_transient_triangle.py"><code class="xref download docutils literal notranslate"><span class="pre">2d_fem_transient_triangle.py</span></code></a>).</p>
<p>We will have to make several changes to the code:</p>
<section id="time-loop-and-output-writing">
<h3>Time loop and output writing<a class="headerlink" href="#time-loop-and-output-writing" title="Link to this heading"></a></h3>
<p>For transient problems, we will need a time loop over all time steps and a way to store/visualize the evolving solution. So far, we have plotted only steady-state solutions that we could directly plot using <code class="code docutils literal notranslate"><span class="pre">matplotlib</span></code>. Now we will have to come up with a different strategy as we want to visualize and analyze the complete transient solution. One good way is to use the <code class="code docutils literal notranslate"><span class="pre">meshio</span></code> python package to save the solution in vtk format and to later analyze is using <a class="reference external" href="https://www.paraview.org">Paraview</a> If you don’t have paraview installed, no is the time ;)</p>
<p>Here is a code snippit that illustrates the logic:</p>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-number">Listing 2 </span><span class="caption-text">Output writing.</span><a class="headerlink" href="#id1" title="Link to this code"></a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># mesh information</span>
<span class="n">points</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">GCOORD</span><span class="p">,</span> <span class="n">GCOORD</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">0</span><span class="p">))</span> <span class="c1">#must have 3 components (x,y,z)</span>
<span class="n">cells</span><span class="o">=</span><span class="p">[(</span><span class="s2">&quot;triangle&quot;</span><span class="p">,</span><span class="n">EL2NOD</span><span class="p">)]</span>

<span class="c1"># write initial mesh</span>
<span class="n">writer</span><span class="o">=</span><span class="n">meshio</span><span class="o">.</span><span class="n">xdmf</span><span class="o">.</span><span class="n">TimeSeriesWriter</span><span class="p">(</span><span class="s1">&#39;transient.xmf&#39;</span><span class="p">)</span>
<span class="n">writer</span><span class="o">.</span><span class="fm">__enter__</span><span class="p">()</span> <span class="c1"># have to add this: import hdf5 and open file ...</span>
<span class="n">writer</span><span class="o">.</span><span class="n">write_points_cells</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">cells</span><span class="p">)</span>

<span class="n">dt</span> <span class="o">=</span> <span class="mf">0.025</span>
<span class="n">nt</span> <span class="o">=</span> <span class="mi">40</span>

<span class="c1"># model time loop</span>
<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">nt</span><span class="p">):</span>
    <span class="c1">#our FEM code here</span>

    <span class="c1">#save results</span>
    <span class="c1">#cell data</span>
    <span class="n">U</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">Q_x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">Q_y</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)))</span>
    <span class="n">U</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">U</span><span class="p">,</span><span class="n">U</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">0</span><span class="p">))</span>

    <span class="c1">#save data</span>
    <span class="n">writer</span><span class="o">.</span><span class="n">write_data</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">point_data</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;T&quot;</span><span class="p">:</span> <span class="n">T</span><span class="p">},</span><span class="n">cell_data</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;U&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">U</span><span class="p">],</span> <span class="s2">&quot;K&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">Kel</span><span class="p">]})</span>
<span class="n">writer</span><span class="o">.</span><span class="fm">__exit__</span><span class="p">()</span> <span class="c1"># close file</span>
</pre></div>
</div>
</div>
<p>Note the time loop over all time steps. The number of time steps and the time step itself are chosen to make the final results look nice - they don’t have a physical meaning for the time being.</p>
<p>Note also, that we don’t need the python plotting at the end of the script anymore.</p>
</section>
<section id="matrix-assembly">
<h3>Matrix assembly<a class="headerlink" href="#matrix-assembly" title="Link to this heading"></a></h3>
<p>If we look at <a class="reference internal" href="#equation-eq-fem-2d-transient-weak-matrix-v2">equation (146)</a>, we notice that we have to change the matrix assembly to 1) account for the mass matrix in the element stiffness matrix, and 2) to integrate the old temperatures into the force vector. This can be done like this:</p>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-number">Listing 3 </span><span class="caption-text">matrix assembly.</span><a class="headerlink" href="#id2" title="Link to this code"></a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># 4. compute element stiffness matrix</span>
<span class="n">Ael</span>     <span class="o">=</span> <span class="n">Ael</span> <span class="o">+</span> <span class="p">(</span><span class="n">rho</span><span class="o">*</span><span class="n">cp</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">)</span> <span class="o">+</span>  <span class="n">dt</span><span class="o">*</span><span class="n">Kel</span><span class="p">[</span><span class="n">iel</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">dNdx</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">dNdx</span><span class="p">))</span><span class="o">*</span><span class="n">detJ</span><span class="o">*</span><span class="n">weights</span><span class="p">[</span><span class="n">ip</span><span class="p">]</span> <span class="c1"># [nnodel,1]*[1,nnodel] / weights are missing, they are 1</span>

<span class="c1"># 5. assemble right-hand side</span>
<span class="n">Rhs_el</span>     <span class="o">=</span> <span class="n">Rhs_el</span> <span class="o">+</span> <span class="n">rho</span><span class="o">*</span><span class="n">cp</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">EL2NOD</span><span class="p">[</span><span class="n">iel</span><span class="p">,:],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span> <span class="p">))</span><span class="o">*</span><span class="n">detJ</span><span class="o">*</span><span class="n">weights</span><span class="p">[</span><span class="n">ip</span><span class="p">]</span>
</pre></div>
</div>
</div>
<p>Notice how the logic for the element thermal conductivity has changed - and that we need two additional physical parameters <span class="math notranslate nohighlight">\(\rho\)</span> and <span class="math notranslate nohighlight">\(c_p\)</span> .</p>
<div class="literal-block-wrapper docutils container" id="id3">
<div class="code-block-caption"><span class="caption-number">Listing 4 </span><span class="caption-text">model parameters.</span><a class="headerlink" href="#id3" title="Link to this code"></a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">rho</span>         <span class="o">=</span> <span class="mi">1</span>
<span class="n">cp</span>          <span class="o">=</span> <span class="mi">1</span>

<span class="n">Kel</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">nel</span><span class="p">)</span><span class="o">*</span><span class="n">k1</span>
<span class="n">Kel</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Phases</span><span class="o">==</span><span class="mi">100</span><span class="p">)]</span> <span class="o">=</span> <span class="n">k2</span>
</pre></div>
</div>
</div>
<p>Make sure that the new logical for <code class="code docutils literal notranslate"><span class="pre">Kel</span></code> is also used in the post-processing step when computing heat fluxes.</p>
<p>Results of transient diffusion problem.</p>
<video width=100% autoplay muted controls loop>
<source src="../_static/video/T.mp4" type="video/mp4">
   Your browser does not support HTML video.
</video></section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="overview.html" class="btn btn-neutral float-left" title="Overview" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="turing_coupled_problem.html" class="btn btn-neutral float-right" title="Coupled diffusion problems" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Lars Ruepke and Zhikui Guo.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
      
        <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
          <span class="rst-current-version" data-toggle="rst-current-version">
            <span class="fa fa-book"> Finite Element Modeling in Geodynamics</span>
            v: latest
            <span class="fa fa-caret-down"></span>
          </span>
          <div class="rst-other-versions">
            <dl>
              
                
                <dd><a href="https://lruepke.github.io/FEM_lecture/downloads/LectureNote.pdf">latest</a></dd>
                
                <dd><a href="#/LectureNote.pdf">2.0</a></dd>
                
              
          </div>
        </div>
      
    

</body>
</html>