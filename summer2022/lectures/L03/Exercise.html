
<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Exercises &mdash; HydrothermalFoam Lecture  documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/tabs.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/plot_directive.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/style.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/tabs.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Theoretical background" href="Theory.html" />
    <link rel="prev" title="Flow on the pore scale" href="FirstCase.html" /> 
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-EJ32EEFYRN"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-EJ32EEFYRN');
    </script>   

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> HydrothermalFoam Lecture
            <img src="../../_static/DRP_vert_cover.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
    
              <p class="caption" role="heading"><span class="caption-text">Course information</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../general-info/course-details.html">Course details</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Lecture 1</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../L01/Overview.html">Lecture overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L01/Installation.html">Installation guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L01/OpenFoam.html">Getting started with OpenFoam</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L01/FirstCase.html">A first test case - heat diffusion</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Lecture 2</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../L02/Overview.html">Lecture overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L02/Example.html">Navier-Stokes flow with OpenFoam</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L02/Exercise.html">Excercise</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Lecture 3</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Overview.html">Lecture overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="intro.html">Digital Rock Physics - Effective Permeability of Rocks</a></li>
<li class="toctree-l1"><a class="reference internal" href="FirstCase.html">Flow on the pore scale</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Exercises</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#vertical-versus-horizontal-permeability">Vertical versus horizontal permeability</a></li>
<li class="toctree-l2"><a class="reference internal" href="#changes-to-the-geometry">Changes to the geometry</a></li>
<li class="toctree-l2"><a class="reference internal" href="#adding-scalar-transport">Adding scalar transport</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Theory.html">Theoretical background</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Lecture 4</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../L04/Overview.html">Lecture overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L04/intro.html">Porous Flow - Submarine Hydrothermal Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L04/FirstCase.html">Hydrothermal convection test case</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L04/Exercise.html">Excercises</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Lecture 5</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../L05/Overview.html">Lecture overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L05/intro.html">Upflow temperatures in submarine hydrothermal systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L05/Exercise1.html">Exercise 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L05/Exercise2.html">Exercise 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L05/Exercise3.html">Exercise 3</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Lecture 6</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../L06/Overview.html">Lecture overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L06/intro.html">Structural controls on hydrothermal flow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L06/Exercise1.html">Exercise 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L06/Exercise2.html">Exercise 2</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Lecture 7</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../L_FVM/Overview.html">Lecture overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L_FVM/intro.html">FVM and OpenFoam</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L_FVM/Exercise1.html">Exercise 1</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Projects</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../L_PROJECTS/Project1.html">Project 1: Flow along a detachment fault</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L_PROJECTS/Project2.html">Project 2: How long can a magmatic intrusion sustain high temperature venting?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L_PROJECTS/Project3.html">Project 3: Hydrofracturing and localized venting above sill intrusion?</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../refs.html">References</a></li>
</ul>


    
        <p class="caption">
            <span class="caption-text">Getting help</span>
        </p>
        <ul>
            
                <li class="toctree-l1"><a href="https://lruepke.github.io/HTF_lecture/imprint/"><i class="fa fa-stamp"></i> Imprint</a></li>
            
                <li class="toctree-l1"><a href="mailto:lruepke@geomar.de"><i class="fa fa-envelope fa-fw"></i> Prof. Lars Ruepke</a></li>
            
                <li class="toctree-l1"><a href="mailto:zguo@geomar.de"><i class="fa fa-envelope fa-fw"></i> Dr. Zhikui Guo</a></li>
            
                <li class="toctree-l1"><a href="https://www.hydrothermalfoam.info"><i class="fa fa-gitlab fa-fw"></i> HydrothermalFoam</a></li>
            
                <li class="toctree-l1"><a href="https://www.openfoam.org"><i class="fa fa-github fa-fw"></i> OpenFOAM</a></li>
            
                <li class="toctree-l1"><a href="https://lruepke.github.io/HTF_lecture/"><i class="fa fa-home fa-fw"></i> Public site</a></li>
            
                <li class="toctree-l1"><a href="https://lms.uni-kiel.de/url/RepositoryEntry/3664576582"><i class="fa fa-home fa-fw"></i> University site</a></li>
            
        </ul>
    

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">HydrothermalFoam Lecture</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Exercises</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/lruepke/HTF_lecture/blob/main/Summer2022/source/lectures/L03/Exercise.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="exercises">
<span id="l03-exercise"></span><h1>Exercises<a class="headerlink" href="#exercises" title="Permalink to this headline"></a></h1>
<p>Let’s explore the solution in a bit more detail.</p>
<section id="vertical-versus-horizontal-permeability">
<h2>Vertical versus horizontal permeability<a class="headerlink" href="#vertical-versus-horizontal-permeability" title="Permalink to this headline"></a></h2>
<p>Make a copy of your case and repeat the analysis in the vertical direction. You will need to</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>adapt the face types in blockMeshDict</p></li>
<li><p>modify the boundary conditions in <code class="code docutils literal notranslate"><span class="pre">0/p</span></code> and <code class="code docutils literal notranslate"><span class="pre">0/U</span></code></p></li>
<li><p>modify the post-processing script to compute vertical velocity</p></li>
</ol>
</div></blockquote>
<p>You should get something like this:</p>
<figure class="align-center" id="fig-rp-vert-perm-fig" style="width: 100%">
<img alt="../../_images/DRP_vert_perm.png" src="../../_images/DRP_vert_perm.png" />
<figcaption>
<p><span class="caption-number">Fig. 15 </span><span class="caption-text">Pore-level flow in the vertical direction.</span><a class="headerlink" href="#fig-rp-vert-perm-fig" title="Permalink to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="changes-to-the-geometry">
<h2>Changes to the geometry<a class="headerlink" href="#changes-to-the-geometry" title="Permalink to this headline"></a></h2>
<p>Check if/how the solution changes if you distort the mesh. For example, squeeze it a bit in the vertical direction by modifying the <code class="code docutils literal notranslate"><span class="pre">transformPoints</span> <span class="pre">-scale</span> <span class="pre">&quot;(1e-6</span> <span class="pre">1e-6</span> <span class="pre">1e-6)&quot;</span></code> statement. Also check if the absolute dimensions matter!</p>
<p>Numerical models should (usually) not surprise us. So before running the different case, ask yourself what you expect.</p>
<blockquote>
<div><ul class="simple">
<li><p>will permeability increase or decrease if you squeeze the sample, for example by half in one direction?</p></li>
<li><p>Do the absolute dimension matter?</p></li>
</ul>
</div></blockquote>
</section>
<section id="adding-scalar-transport">
<h2>Adding scalar transport<a class="headerlink" href="#adding-scalar-transport" title="Permalink to this headline"></a></h2>
<p>In the next session, we will progress towards submarine hydrothermal systems and will explore Darcy flow in detail. In preparation for that, let’s explore how scalar transport (like advecting temperature) would look like in our synthetic pore model.</p>
<p>OpenFOAM’s scalarTransportFoam application solves the 3-D advection-diffusion equation for a given velocity field:</p>
<div class="math notranslate nohighlight" id="equation-eq-scalar-transport">
<span class="eqno">(8)<a class="headerlink" href="#equation-eq-scalar-transport" title="Permalink to this equation"></a></span>\[    \frac{\partial T}{\partial t} = -\nabla \cdot ( \vec{U} T ) + \nabla \cdot (D_T \nabla T) + S_T,\]</div>
<p>with <code class="code docutils literal notranslate"><span class="pre">T</span></code> being the transported scalar, <code class="code docutils literal notranslate"><span class="pre">DT</span></code> the diffusivity with units of <span class="math notranslate nohighlight">\(m^2/s\)</span> , and <code class="code docutils literal notranslate"><span class="pre">ST</span></code> is a source term. Note that it is tempting to think of T as temperature but here it is simply a transported scalar (like a solute in groundwater flow). The energy conservation equation written in terms of temperature looks slightly different, as we will learn in the next chapter.</p>
<p>The key source code of <a class="reference external" href="https://cpp.openfoam.org/v9/scalarTransportFoam_8C_source.html">scalarTransportFoam</a> looks like this:</p>
<div class="highlight-foam notranslate"><div class="highlight"><pre><span></span><span class="p">...</span>
<span class="n">fvScalarMatrix</span> <span class="n">TEqn</span>
<span class="p">(</span>
    <span class="n">fvm</span><span class="o">::</span><span class="n">ddt</span><span class="p">(</span><span class="k">T</span><span class="p">)</span>
    <span class="o">+</span> <span class="n">fvm</span><span class="o">::</span><span class="n">div</span><span class="p">(</span><span class="k">phi</span><span class="p">,</span> <span class="k">T</span><span class="p">)</span>
    <span class="o">-</span> <span class="n">fvm</span><span class="o">::</span><span class="n">laplacian</span><span class="p">(</span><span class="n">DT</span><span class="p">,</span> <span class="k">T</span><span class="p">)</span>
    <span class="o">==</span>
    <span class="n">fvModels</span><span class="p">.</span><span class="n">source</span><span class="p">(</span><span class="k">T</span><span class="p">)</span>
<span class="p">);</span>

<span class="n">TEqn</span><span class="p">.</span><span class="n">relax</span><span class="p">();</span>
<span class="n">fvConstraints</span><span class="p">.</span><span class="n">constrain</span><span class="p">(</span><span class="n">TEqn</span><span class="p">);</span>
<span class="n">TEqn</span><span class="p">.</span><span class="n">solve</span><span class="p">();</span>
<span class="n">fvConstraints</span><span class="p">.</span><span class="n">constrain</span><span class="p">(</span><span class="k">T</span><span class="p">);</span>
<span class="p">...</span>
</pre></div>
</div>
<p>Since we have already computed the velocity field (and made the mesh etc.), we can now use our results as the starting point for a scalarTransportFoam case. The foam tuturials are always a good starting point for a new case. scalarTransportFoam is handled in <code class="code docutils literal notranslate"><span class="pre">$FOAM_TUTORIALS/basic/scalarTransportFoam/pitzDaily/</span></code> . Let’s copy it over to our working directory, add our velocity field and mesh, and modify the control dictionoaries.</p>
<p>In the docker do this:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> <span class="nv">$HOME</span>/HydrothermalFoam_runs
cp -r <span class="nv">$FOAM_TUTORIALS</span>/basic/scalarTransportFoam/pitzDaily/ ./DRP_transport
cp -r ./DRP_permeability_2D/constant/polyMesh ./DRP_transport/
cp ./DRP_permeability_2D/0/U ./DRP_transport/0/
</pre></div>
</div>
<p>This assumes that you used the  case and directory names; if not, modify the names accordingly.</p>
<p>Now go back to our local shell and Visual Studio and modify the scripts:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="code docutils literal notranslate"><span class="pre">0/T</span></code> to make “temperature” 1 at the inlet and zeroGradient at the outlet</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">constant/transportProperties</span></code> set the diffusivity to something small, like <span class="math notranslate nohighlight">\(1e-{12}\)</span>, so that the problem is advection-dominated</p></li>
<li><p>change <code class="code docutils literal notranslate"><span class="pre">system/controlDict</span></code> so that the endTime is 20, deltaT is 0.1, and writeInterval   is 3e-1. These are somewhat arbitrary changes making sure we get a reasonable solution for our synthetic setup.</p></li>
</ul>
</div></blockquote>
<p>That’s it, run it and explore the solution!</p>
<video width=100% autoplay muted controls loop>
   <source src="../../_static/video/scalarTransport.mp4" type="video/mp4">
   Your browser does not support HTML video.
</video><p>Would the temperature evolution in our rock sample look like this? What would the grains do the speed of the thermal front?</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="FirstCase.html" class="btn btn-neutral float-left" title="Flow on the pore scale" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="Theory.html" class="btn btn-neutral float-right" title="Theoretical background" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Lars Ruepke and Zhikui Guo.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>