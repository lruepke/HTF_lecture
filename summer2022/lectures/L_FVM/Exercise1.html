
<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Exercise 1 &mdash; HydrothermalFoam Lecture  documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/tabs.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/plot_directive.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/style.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/tabs.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="1. Read and plot mesh information" href="cases/jupyter/VisualizeResults.html" />
    <link rel="prev" title="FVM and OpenFoam" href="intro.html" /> 
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-EJ32EEFYRN"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-EJ32EEFYRN');
    </script>   

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> HydrothermalFoam Lecture
            <img src="../../_static/htf_picto2.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
    
              <p class="caption" role="heading"><span class="caption-text">Course information</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../general-info/course-details.html">Course details</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Lecture 1</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../L01/Overview.html">Lecture overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L01/slide.html">Accompanying slide deck</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L01/Installation.html">Installation guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L01/OpenFoam.html">Getting started with OpenFoam</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L01/FirstCase.html">A first test case - heat diffusion</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Lecture 2</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../L02/Overview.html">Lecture overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L02/slide.html">Accompanying slide deck</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L02/intro.html">Navier-Stokes flow with OpenFoam</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L02/Example.html">Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L02/Exercise.html">Excercise</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Lecture 3</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../L03/Overview.html">Lecture overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L03/slide.html">Accompanying slide deck</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L03/intro.html">Porous Flow - Submarine Hydrothermal Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L03/FirstCase.html">Hydrothermal convection test case</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L03/Exercise.html">Excercises</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Lecture 4</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../L04/Overview.html">Lecture overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L04/intro.html">Upflow temperatures in submarine hydrothermal systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L04/Exercise1.html">Exercise 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L04/Exercise2.html">Exercise 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L04/Exercise3.html">Exercise 3</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Lecture 5</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../L05/Overview.html">Lecture overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L05/intro.html">Structural controls on hydrothermal flow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L05/Exercise1.html">Exercise 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L05/Exercise2.html">Exercise 2</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Lecture 6</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Overview.html">Lecture overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="intro.html">FVM and OpenFoam</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Exercise 1</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#theory">Theory</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#step-1-geometric-and-physical-modeling">Step 1, Geometric and physical modeling</a></li>
<li class="toctree-l3"><a class="reference internal" href="#step-2-domain-discretization">Step 2, Domain discretization</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mesh-structure-and-topology">Mesh structure and topology</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#step-3-spatial-discretization-the-diffusion-term">Step 3, Spatial discretization: The diffusion term</a></li>
<li class="toctree-l3"><a class="reference internal" href="#step-4-temporal-discretization-the-transient-term">Step 4, Temporal Discretization: The Transient Term</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#first-order-implicit-euler-scheme">First order implicit Euler scheme</a></li>
<li class="toctree-l4"><a class="reference internal" href="#first-order-explicit-euler-scheme">First order explicit Euler scheme</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#step-6-solution-of-the-discretized-equations">Step 6: Solution of the discretized equations</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#openfoam-implementation">OpenFOAM implementation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#step0-generate-mesh">Step0, Generate mesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="#step-1-read-mesh-and-input-field">Step 1, Read mesh and input field</a></li>
<li class="toctree-l3"><a class="reference internal" href="#step-2-discretize-laplacian-term">Step 2, discretize Laplacian term</a></li>
<li class="toctree-l3"><a class="reference internal" href="#step-3-discretize-transient-term">Step 3, discretize transient term</a></li>
<li class="toctree-l3"><a class="reference internal" href="#step-4-construct-the-final-coefficient-matrix-and-rhs">Step 4, construct the final coefficient matrix and RHS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#step-5-solve">Step 5, solve</a></li>
<li class="toctree-l3"><a class="reference internal" href="#step-6-write">Step 6, write</a></li>
<li class="toctree-l3"><a class="reference internal" href="#jupyter-notebook">Jupyter notebook</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cases/jupyter/VisualizeResults.html">1. Read and plot mesh information</a></li>
<li class="toctree-l4"><a class="reference internal" href="cases/jupyter/VisualizeResults.html#2.-Boundary-conditions">2. Boundary conditions</a></li>
<li class="toctree-l4"><a class="reference internal" href="cases/jupyter/VisualizeResults.html#3.-Plot-coefficients-matrix">3. Plot coefficients matrix</a></li>
<li class="toctree-l4"><a class="reference internal" href="cases/jupyter/VisualizeResults.html#1.-Coordinates-and-delta-coefficients-of-internal-cell">1. Coordinates and delta coefficients of internal cell</a></li>
<li class="toctree-l4"><a class="reference internal" href="cases/jupyter/VisualizeResults.html#2.-Coordinates-and-delta-coefficients-of-boundary-cell">2. Coordinates and delta coefficients of boundary cell</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Projects</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../L_PROJECTS/Project1.html">Project 1: Flow along a detachment fault</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L_PROJECTS/Project2.html">Project 2: How long can a magmatic intrusion sustain high temperature venting?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L_PROJECTS/Project3.html">Project 3: Hydrofracturing and localized venting above sill intrusion?</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../refs.html">References</a></li>
</ul>


    
        <p class="caption">
            <span class="caption-text">Getting help</span>
        </p>
        <ul>
            
                <li class="toctree-l1"><a href="mailto:lruepke@geomar.de"><i class="fa fa-envelope fa-fw"></i> Prof. Lars Ruepke</a></li>
            
                <li class="toctree-l1"><a href="mailto:zguo@geomar.de"><i class="fa fa-envelope fa-fw"></i> Dr. Zhikui Guo</a></li>
            
                <li class="toctree-l1"><a href="https://www.hydrothermalfoam.info"><i class="fa fa-gitlab fa-fw"></i> HydrothermalFoam</a></li>
            
                <li class="toctree-l1"><a href="https://www.openfoam.org"><i class="fa fa-github fa-fw"></i> OpenFOAM</a></li>
            
                <li class="toctree-l1"><a href="https://lruepke.github.io/HTF_lecture/"><i class="fa fa-home fa-fw"></i> Public site</a></li>
            
                <li class="toctree-l1"><a href="https://lms.uni-kiel.de/url/RepositoryEntry/3664576582"><i class="fa fa-home fa-fw"></i> University site</a></li>
            
        </ul>
    

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">HydrothermalFoam Lecture</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Exercise 1</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/lruepke/HTF_lecture/blob/main//source/lectures/L_FVM/Exercise1.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="admonition warning" id="l-fvm-exercise1">
<p class="admonition-title">Warning</p>
<p>Before we start the exercise 1, please download (<a class="reference download internal" download="" href="../../_downloads/5cadc0ff36497aaf1c4155bb17c6dc5e/test_laplacianFoam.zip"><code class="xref download docutils literal notranslate"><span class="pre">test_laplacianFoam</span></code></a>) the modified Laplacian solver first.
Then put it in the shared folder and compile (<code class="code docutils literal notranslate"><span class="pre">wmake</span></code>) it in the docker container.
This modified solver writes out detailed information on matrix coefficients into the log file, so that it is possible to check the derived values against the computed values.</p>
</div>
<section id="exercise-1">
<h1>Exercise 1<a class="headerlink" href="#exercise-1" title="Permalink to this headline"></a></h1>
<section id="theory">
<h2>Theory<a class="headerlink" href="#theory" title="Permalink to this headline"></a></h2>
<div class="admonition-goals admonition">
<p class="admonition-title">Goals</p>
<ul class="simple">
<li><p>explore FVM theory</p></li>
<li><p>link FVM theory and OpenFOAM solver implementation</p></li>
<li><p>step by step exploring details of the solver and solving process</p></li>
</ul>
</div>
<section id="step-1-geometric-and-physical-modeling">
<h3>Step 1, Geometric and physical modeling<a class="headerlink" href="#step-1-geometric-and-physical-modeling" title="Permalink to this headline"></a></h3>
<div class="math notranslate nohighlight" id="equation-eq-fvm-laplacian-con">
<span class="eqno">(27)<a class="headerlink" href="#equation-eq-fvm-laplacian-con" title="Permalink to this equation"></a></span>\[\rho c_p\frac{\partial T}{\partial t} - \nabla \cdot k \nabla T = 0\]</div>
<div class="math notranslate nohighlight" id="equation-eq-fvm-laplacian-dif">
<span class="eqno">(28)<a class="headerlink" href="#equation-eq-fvm-laplacian-dif" title="Permalink to this equation"></a></span>\[\frac{\partial T}{\partial t} - \nabla \cdot D \nabla T =0\]</div>
<p><span class="math notranslate nohighlight">\(k\)</span> is the thermal conductivity and <span class="math notranslate nohighlight">\(D\)</span> is the thermal diffusivity <span class="math notranslate nohighlight">\(\frac{k}{\rho c_p}\)</span> . We here assume that <span class="math notranslate nohighlight">\(D\)</span> is a constant value.
see also <a class="reference internal" href="../L01/FirstCase.html#theory-heat-diffusion"><span class="std std-ref">Theory</span></a>.</p>
<p>Below is a simple 2D setup for a heat diffusion test case. We will use it to learn about the details of how openFOAM’s FV method works.</p>
<figure class="align-center" id="fvm-geometry-bcs-regularbox" style="width: 100%">
<img alt="../../_images/boundaryConditions_FVM_regularBox.svg" src="../../_images/boundaryConditions_FVM_regularBox.svg" /><figcaption>
<p><span class="caption-number">Fig. 33 </span><span class="caption-text">Model geometry, boundary conditions and initial condition.</span><a class="headerlink" href="#fvm-geometry-bcs-regularbox" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<div class="admonition-what-we-need-to-solve admonition">
<p class="admonition-title">What we need to solve ?</p>
<p>Temperature field <span class="math notranslate nohighlight">\(T\)</span> of the model region at time <span class="math notranslate nohighlight">\(t\)</span>,
therefore <span class="math notranslate nohighlight">\(T\)</span> is the only unknown variable of our problem.</p>
</div>
</section>
<section id="step-2-domain-discretization">
<h3>Step 2, Domain discretization<a class="headerlink" href="#step-2-domain-discretization" title="Permalink to this headline"></a></h3>
<section id="mesh-structure-and-topology">
<h4>Mesh structure and topology<a class="headerlink" href="#mesh-structure-and-topology" title="Permalink to this headline"></a></h4>
<p>Create a 2D regular box mesh using <code class="code docutils literal notranslate"><span class="pre">blockMesh</span></code> utility (<a class="reference download internal" download="" href="../../_downloads/182fc0c7918b295146e8ff66ee704105/regularBox.zip"><code class="xref download docutils literal notranslate"><span class="pre">Regular</span> <span class="pre">box</span> <span class="pre">case</span></code></a>).
Therefore, the mesh topology shown below is the same as OpenFOAM polyMesh.</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--0-input--1" name="tab-set--0" type="radio"><label class="tab-label" for="tab-set--0-input--1">Regular mesh</label><div class="tab-content docutils container">
<figure class="align-center" id="fig-polymesh-regularbox" style="width: 100%">
<img alt="../../_images/mesh_FVM_regularBox.svg" src="../../_images/mesh_FVM_regularBox.svg" /><figcaption>
<p><span class="caption-number">Fig. 34 </span><span class="caption-text">2D regular mesh structure and topology information of OpenFOAM polyMesh (See <a class="reference internal" href="cases/jupyter/VisualizeResults.html#1.-Read-and-plot-mesh-information"><span class="std std-ref">1. Read and plot mesh information</span></a> in the notebook).</span><a class="headerlink" href="#fig-polymesh-regularbox" title="Permalink to this image"></a></p>
</figcaption>
</figure>
</div>
<input class="tab-input" id="tab-set--0-input--2" name="tab-set--0" type="radio"><label class="tab-label" for="tab-set--0-input--2">Unstructured mesh</label><div class="tab-content docutils container">
<figure class="align-center" id="fig-polymesh-unstructured" style="width: 100%">
<img alt="../../_images/mesh_FVM_unstructured.svg" src="../../_images/mesh_FVM_unstructured.svg" /><figcaption>
<p><span class="caption-number">Fig. 35 </span><span class="caption-text">2D unstructured mesh topology information (<a class="reference download internal" download="" href="../../_downloads/511a4a1fe2a54b529f96db7ce8318cd3/unstructured.zip"><code class="xref download docutils literal notranslate"><span class="pre">Regular</span> <span class="pre">box</span> <span class="pre">case</span></code></a>).</span><a class="headerlink" href="#fig-polymesh-unstructured" title="Permalink to this image"></a></p>
</figcaption>
</figure>
</div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>All internal faces have and only have two attributes, <strong>owner</strong> and <strong>neighbour</strong>,
denote the cell indices who share the face.
While the boundary faces only have <strong>owner</strong> attribute.
The normal vector of face always points from the <strong>owner</strong> cell to the <strong>neighbour</strong> cell. The numbering of the vertices that make up the face is again done using the right-hand rule and the face normal always points from the cell with the lower index to the cell with the larger index.</p>
<p>You can find details on the mesh description in the <a class="reference external" href="https://cfd.direct/openfoam/user-guide/v8-mesh-description/">OpenFoam manual</a>. Have a look at it and check the structure of the files in <code class="code docutils literal notranslate"><span class="pre">constant\polymesh</span></code>.</p>
</div>
</section>
</section>
<section id="step-3-spatial-discretization-the-diffusion-term">
<h3>Step 3, Spatial discretization: The diffusion term<a class="headerlink" href="#step-3-spatial-discretization-the-diffusion-term" title="Permalink to this headline"></a></h3>
<p>The equation discretization step is performed over each element of the computational domain to yield an algebraic relation that connects the value of a variable in an element to the values of the variable in the neighboring elements <span id="id1">[<a class="reference internal" href="../../refs.html#id2" title="Fadl Moukalled, L Mangani, Marwan Darwish, and others. The finite volume method in computational fluid dynamics. Volume 6. Springer, 2016.">Moukalled et al., 2016</a>]</span>.</p>
<div class="admonition-goal admonition">
<p class="admonition-title">Goal</p>
<p>Transform partial differential <a class="reference internal" href="#equation-eq-fvm-laplacian-dif">equation (28)</a> into a set of algebraic equations: <span class="math notranslate nohighlight">\(\mathbf{A}[T] = \mathbf{b}\)</span>.</p>
</div>
<ol class="arabic simple">
<li><p>Integrate <a class="reference internal" href="#equation-eq-fvm-laplacian-dif">equation (28)</a> over element <span class="math notranslate nohighlight">\(C\)</span> (the green cell in <a class="reference internal" href="#fig-polymesh-regularbox"><span class="std std-numref">Fig. 34</span></a>) that enables recovering its integral balance form as,</p></li>
</ol>
<div class="math notranslate nohighlight" id="equation-eq-fvm-volume-int">
<span class="eqno">(29)<a class="headerlink" href="#equation-eq-fvm-volume-int" title="Permalink to this equation"></a></span>\[\iiint\limits_{V_C} \frac{\partial T}{\partial t} dV - \iiint\limits_{V_C} \nabla \cdot D\nabla T dV = 0\]</div>
<p><strong>Note</strong> that the transient term <span class="math notranslate nohighlight">\(\iiint\limits_{V_C} \frac{\partial T}{\partial t} dV\)</span> will be processed in the later section. Let’s set it to zero for the moment and assume steady-state.</p>
<ol class="arabic simple" start="2">
<li><p>Transform the volume integral of the heat flux into a surface integral by applying the divergence theorem,</p></li>
</ol>
<div class="math notranslate nohighlight" id="equation-eq-fvm-surface-int">
<span class="eqno">(30)<a class="headerlink" href="#equation-eq-fvm-surface-int" title="Permalink to this equation"></a></span>\[- \iiint\limits_{V_C} \nabla \cdot D\nabla T dV = -\oint\limits_{\partial V_C} (D\nabla T)\cdot d\vec{S} = 0\]</div>
<p>The <a class="reference internal" href="#equation-eq-fvm-surface-int">equation (30)</a> is actually a heat balance over cell <span class="math notranslate nohighlight">\(C\)</span>.
It is basically the integral form of the original partial differential equation and involves <strong>no approximation</strong>.</p>
<p>The integrant is the <strong>diffusive heat flux</strong>,</p>
<div class="math notranslate nohighlight" id="equation-eq-fvm-flux-d">
<span class="eqno">(31)<a class="headerlink" href="#equation-eq-fvm-flux-d" title="Permalink to this equation"></a></span>\[\vec{J}^{T,D} \equiv -D\nabla T\]</div>
<ol class="arabic simple" start="3">
<li><p>Transform the surface integral in <a class="reference internal" href="#equation-eq-fvm-surface-int">equation (30)</a> as a summation over the control volume faces (<strong>still no approximation</strong>),</p></li>
</ol>
<div class="math notranslate nohighlight" id="equation-eq-fvm-surface-sum">
<span class="eqno">(32)<a class="headerlink" href="#equation-eq-fvm-surface-sum" title="Permalink to this equation"></a></span>\[\sum\limits_{f\sim faces(V_C)} \iint\limits_{f}\vec{J}^{T,D}_f \cdot d\vec{S}_f =0\]</div>
<p>Here <span class="math notranslate nohighlight">\(f\)</span> denotes the boundary face of cell <span class="math notranslate nohighlight">\(V_C\)</span>.</p>
<p>Now, the key problem is how to calculate flux integral on a face.</p>
<ol class="arabic simple" start="4">
<li><p>Evaluating flux integral on the faces</p></li>
</ol>
<p>It’s worth noting that there are only two kinds of cells in the discretized domain, one is <strong>internal cell</strong>, the other is <strong>boundary cell</strong>.
All faces of a internal cell are internal faces. The remain cells are boundary cells which contain at least one boundary face.</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--1-input--1" name="tab-set--1" type="radio"><label class="tab-label" for="tab-set--1-input--1">Internal cell</label><div class="tab-content docutils container">
<p>For a specific internal cell <span class="math notranslate nohighlight">\(C\)</span>, e.g. cell 12, shown in <a class="reference internal" href="#fig-polymesh-regularbox"><span class="std std-numref">Fig. 34</span></a>,
the <a class="reference internal" href="#equation-eq-fvm-surface-sum">equation (32)</a> can be expanded as,</p>
<div class="math notranslate nohighlight" id="equation-eq-fvm-surface-sum-expand">
<span class="eqno">(33)<a class="headerlink" href="#equation-eq-fvm-surface-sum-expand" title="Permalink to this equation"></a></span>\[\color{red}{\iint_{f_{23}}\vec{J}^{T,D}_{f_{23}} \cdot \vec{S}_{f_{23}}} + \iint_{f_{24}}\vec{J}^{T,D}_{f_{24}} \cdot \vec{S}_{f_{24}} + \iint_{f_{21}}\vec{J}^{T,D}_{f_{21}} \cdot \vec{S}_{f_{21}}  + \iint_{f_{5}}\vec{J}^{T,D}_{f_{5}} \cdot \vec{S}_{f_{5}} = 0\]</div>
<p>Note that the surface normals <span class="math notranslate nohighlight">\(\vec{S}\)</span> always point out of the cell; for example, <span class="math notranslate nohighlight">\(\vec{S}_{f_{23}}\)</span> would have a positive and <span class="math notranslate nohighlight">\(\vec{S}_{f_{21}}\)</span> a negative sign.</p>
<p>4.1 Considering face <span class="math notranslate nohighlight">\(f_{23}\)</span>, calculate the first term on the right hand side of the <a class="reference internal" href="#equation-eq-fvm-surface-sum-expand">equation (33)</a> (we have to introduce the <strong>first approximation</strong> at this step). Using a Gaussian quadrature the integral at the face <span class="math notranslate nohighlight">\(f_{23}\)</span>, for example, becomes,</p>
<div class="math notranslate nohighlight" id="equation-fvm-flux-gaussian-integral">
<span class="eqno">(34)<a class="headerlink" href="#equation-fvm-flux-gaussian-integral" title="Permalink to this equation"></a></span>\[\color{red}{\iint_{f_{23}}\vec{J}^{T,D}_{f_{23}} \cdot \vec{S}_{f_{23}}} = \iint_{f_{23}} (\vec{J}^{T,D}_{f_{23}} \cdot \vec{n}_{f_{23}}) dS_{f_{23}} \approx \color{orange}{\sum\limits_{ip\sim ip(f_{23})} (\vec{J}^{T,D} \cdot \vec{n}_{ip})\omega_{ip} S_{f_{23}}}\]</div>
<p>where <span class="math notranslate nohighlight">\(S_f\)</span> is the area of face <span class="math notranslate nohighlight">\(f_{23}\)</span>, <span class="math notranslate nohighlight">\(ip\)</span> refers to a integration point and <span class="math notranslate nohighlight">\(ip(f_{23})\)</span> the number of integration points along surface <span class="math notranslate nohighlight">\(f_{23}\)</span>, <span class="math notranslate nohighlight">\(\omega_{ip}\)</span> is the integral weights.</p>
<figure class="align-center" id="fig-fig5-2">
<a class="reference internal image-reference" href="../../_images/Fig5.2_RedBook.svg"><img alt="../../_images/Fig5.2_RedBook.svg" src="../../_images/Fig5.2_RedBook.svg" width="100%" /></a>
<figcaption>
<p><span class="caption-number">Fig. 36 </span><span class="caption-text">Surface integration of fluxes using (a) one integration point, (b) two integration points, and (c) three integration points <span id="id2">[<a class="reference internal" href="../../refs.html#id2" title="Fadl Moukalled, L Mangani, Marwan Darwish, and others. The finite volume method in computational fluid dynamics. Volume 6. Springer, 2016.">Moukalled et al., 2016</a>]</span>. The total flux <span class="math notranslate nohighlight">\(FluxT_f\)</span> is computed as linear combinations of the two cell values plus a source term.</span><a class="headerlink" href="#fig-fig5-2" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Only the <strong>one integration point scheme</strong>, i.e. <a class="reference internal" href="#fig-fig5-2"><span class="std std-numref">Fig. 36</span></a> (a), is implemented in OpenFOAM (at least before version 8).
Therefore the first keyword of Laplacian scheme in <code class="code docutils literal notranslate"><span class="pre">system/fvScheme</span></code> dictionary file of a case has only one option, it is <code class="code docutils literal notranslate"><span class="pre">Gauss</span></code>.</p>
</div>
<p>4.2 Choose integral scheme or integral points</p>
<p>To simply explain the calculation process/logic and to also be consistent with OpenFOAM, we here adopt an <strong>one integration point</strong> scheme with weight <span class="math notranslate nohighlight">\(\omega = 1\)</span>, thus <a class="reference internal" href="#equation-fvm-flux-gaussian-integral">equation (34)</a> becomes,</p>
<div class="math notranslate nohighlight" id="equation-eq-fvm-surface-term-f1">
<span class="eqno">(35)<a class="headerlink" href="#equation-eq-fvm-surface-term-f1" title="Permalink to this equation"></a></span>\[\color{orange}{\sum\limits_{ip\sim ip(f_{23})} (\vec{J}^{T,D} \cdot \vec{n}_{ip})\omega S_f } = -\left(D \frac{\partial T}{\partial x} \vec{i} + D\frac{\partial T}{\partial y} \vec{j} \right)_{f_{23}} \cdot \Delta y_{f_{23}} \vec{i} = -\color{blue}{\left( D\frac{\partial T}{\partial x} \right)_{f_{23}} \Delta y_{f_{23}}}\]</div>
<p>where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(S_{f_{23}} = \Delta y_{f_{23}}\)</span>  is the area of face  <span class="math notranslate nohighlight">\(f_{23}\)</span> by assuming <span class="math notranslate nohighlight">\(\Delta z = 1\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\vec{S}_{f_{23}} = S_{f_{23}} \vec{n}_{f_{23}}\)</span> is the surface vector of face <span class="math notranslate nohighlight">\(f_{23}\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\vec{n}_{f_{23}} = \vec{i}\)</span> is the normal vector of the face <span class="math notranslate nohighlight">\(f_{23}\)</span> directed out of the cell <span class="math notranslate nohighlight">\(C\)</span> (see <a class="reference internal" href="#fig-polymesh-regularbox"><span class="std std-numref">Fig. 34</span></a>).</p></li>
</ul>
<p>4.3 Calculate gradient of <span class="math notranslate nohighlight">\(T\)</span> at face centroid, here introduce <strong>the second approximation</strong>, e.g. assuming linear variation of T and then the gradient term in the <a class="reference internal" href="#equation-eq-fvm-surface-term-f1">equation (35)</a> can be approximated as,</p>
<div class="math notranslate nohighlight">
\[-\color{blue}{\left( D\frac{\partial T}{\partial x} \right)_{f_{23}} \Delta y_{f_{23}}} = -D\frac{T_{13} - T_{C}}{x_{13} - x_C}\Delta y_{f_{23}} = -\frac{D \Delta y_{f_{23}}}   {\delta x_{f_{23}}}   (T_{13} - T_{C})\]</div>
<p>where <span class="math notranslate nohighlight">\(\delta x_{f_{23}}\)</span> represents the distance between center of cells who share face <span class="math notranslate nohighlight">\(f_{23}\)</span>, they are cell 12 and cell 13.</p>
<p>Now let’s look at the western face <span class="math notranslate nohighlight">\(f_{21}\)</span> . Using a single integration point, we can again write:</p>
<div class="math notranslate nohighlight" id="equation-eq-fvm-surface-term-f1-west">
<span class="eqno">(36)<a class="headerlink" href="#equation-eq-fvm-surface-term-f1-west" title="Permalink to this equation"></a></span>\[\color{orange}{\sum\limits_{ip\sim ip(f_{21})} (\vec{J}^{T,D} \cdot \vec{n}_{ip})\omega S_f } = -\left(D \frac{\partial T}{\partial x} \vec{i} + D\frac{\partial T}{\partial y} \vec{j} \right)_{f_{21}} \cdot \Delta y_{f_{21}} \cdot-\vec{i} = \color{blue}{\left( D\frac{\partial T}{\partial x} \right)_{f_{21}} \Delta y_{f_{21}}}\]</div>
<p>Notice how the surface normal now has the opposite sign!</p>
<p>We continue to spell out the flux across face <span class="math notranslate nohighlight">\(f_{21}\)</span> as:</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\color{blue}{\left( D\frac{\partial T}{\partial x} \right)_{f_{21}} \Delta y_{f_{21}}} = D\frac{T_{C} - T_{11}}{x_{11} - x_C}\Delta y_{f_{21}} = -\frac{D \Delta y_{f_{21}}}   {\delta x_{f_{21}}}   (T_{11} - T_{C})\]</div>
</div></blockquote>
<p>Do the same thing for the remain faces (<span class="math notranslate nohighlight">\(f_5, f_{24}\)</span>).</p>
<p>4.3 Construct coefficients of a specific cell <span class="math notranslate nohighlight">\(C_{12}\)</span></p>
<p>Now we get all the coefficients, thus the <a class="reference internal" href="#equation-eq-fvm-surface-sum-expand">equation (33)</a> can be discretized and expressed as a matrix form,</p>
<div class="math notranslate nohighlight" id="equation-eq-fvm-matrix-form-internalcell">
<span class="eqno">(37)<a class="headerlink" href="#equation-eq-fvm-matrix-form-internalcell" title="Permalink to this equation"></a></span>\[a_{C} T_C + a_{F_{23}} T_{F_{23}} + a_{F_{24}} T_{F_{24}} + a_{F_{21}} T_{F_{21}} + a_{F_{5}} T_{F_{5}} = 0\]</div>
<p>with</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{eqnarray}
a_{23} &amp; = &amp;  -\frac{D \Delta y_{f_{23}}}   {\delta x_{f_{23}}} \\
a_{24} &amp; = &amp;  -\frac{D \Delta y_{f_{24}}}   {\delta x_{f_{24}}} \\
a_{21} &amp; = &amp;  -\frac{D \Delta y_{f_{21}}}   {\delta x_{f_{21}}} \\
a_{5} &amp; = &amp;  -\frac{D \Delta y_{f_{5}}}   {\delta x_{f_{5}}} \\
a_{C} &amp; = &amp; -(a_{23} + a_{24} + a_{21}  + a_{5}) \\
\end{eqnarray}\end{split}\]</div>
<div class="math notranslate nohighlight" id="equation-eq-fvm-matrix-form-internalcell12">
<span class="eqno">(38)<a class="headerlink" href="#equation-eq-fvm-matrix-form-internalcell12" title="Permalink to this equation"></a></span>\[\mathbf{A}_{N\times N}[12,:] \mathbf{T}_{N\times 1} =  0\]</div>
</div>
<input class="tab-input" id="tab-set--1-input--2" name="tab-set--1" type="radio"><label class="tab-label" for="tab-set--1-input--2">Boundary cell</label><div class="tab-content docutils container">
<p>For a specific boundary cell, e.g. <strong>cell 19</strong> shown in <a class="reference internal" href="#fig-polymesh-regularbox"><span class="std std-numref">Fig. 34</span></a>, the <a class="reference internal" href="#equation-eq-fvm-surface-sum">equation (32)</a> can be rewritten as,</p>
<div class="math notranslate nohighlight" id="equation-eq-fvm-surface-sum-expand-boundary">
<span class="eqno">(39)<a class="headerlink" href="#equation-eq-fvm-surface-sum-expand-boundary" title="Permalink to this equation"></a></span>\[\iint_{f_{18}}\vec{J}^{T,D}_{f_{18}} \cdot \vec{S}_{f_{18}} + \iint_{f_{35}}\vec{J}^{T,D}_{f_{35}} \cdot \vec{S}_{f_{35}} +\iint_{f_{37}}\vec{J}^{T,D}_{f_{37}} \cdot \vec{S}_{f_{37}} + \color{red}{\iint_{f_{51}}\vec{J}^{T,D}_{f_{51}} \cdot \vec{S}_{f_{51}}} = 0\]</div>
<p>The first three terms are normal fluxes across internal faces, so there is nothing special and we can just calculate them following steps for internal faces as before. The special thing is the boundary face <span class="math notranslate nohighlight">\(f_{52}\)</span>, we can call it <span class="math notranslate nohighlight">\(f_b\)</span> for a general case. <strong>Now the problem is how to evaluate flux on the boundary face</strong> <span class="math notranslate nohighlight">\(f_b\)</span>.</p>
<p>The fluxes on the interior faces are discretized as before, while <strong>the boundary flux is discretized with the aim of constructing a linearization with respect to</strong> the cell field <span class="math notranslate nohighlight">\(T_C\)</span>, e.g. <span class="math notranslate nohighlight">\(T_{C_{19}}\)</span> of cell <span class="math notranslate nohighlight">\(C_{19}\)</span> shown in <a class="reference internal" href="#fig-polymesh-regularbox"><span class="std std-numref">Fig. 34</span></a>, thus</p>
<div class="math notranslate nohighlight" id="equation-eq-fvm-surface-flux-boundary">
<span class="eqno">(40)<a class="headerlink" href="#equation-eq-fvm-surface-flux-boundary" title="Permalink to this equation"></a></span>\[\color{red}{\iint_{f_{b}}\vec{J}^{T,D}_{f_{b}} \cdot d\vec{S}_{f_{b}}} = a_{F_b} T_C + c_{F_b}\]</div>
<p>All right, <strong>now out goal is to determine the coefficients of</strong> <span class="math notranslate nohighlight">\(a_{F_b}\)</span> and <span class="math notranslate nohighlight">\(c_{F_b}\)</span> according to the boundary conditions. Generally there are two basic kinds of boundary conditions, they are <strong>Dirichlet boundary condition</strong> (also called the first type or fixed value boundary condition) and <strong>Von Neumann boundary condition</strong> (all called the second type or fixed flux boundary condition), respectively.</p>
<p>4.1 Fixed value boundary condition</p>
<p>Fixed value means the value of field <span class="math notranslate nohighlight">\(T\)</span> is given on the boundary face is give, i.e. <span class="math notranslate nohighlight">\(\color{purple}{T_{f_b}}\)</span> is given. There fore we can calculate flux on boundary face, <span class="math notranslate nohighlight">\(f_{51}\)</span> for example,</p>
<div class="math notranslate nohighlight" id="equation-eq-fvm-flux-boundary">
<span class="eqno">(41)<a class="headerlink" href="#equation-eq-fvm-flux-boundary" title="Permalink to this equation"></a></span>\[\color{red}{\iint_{f_{51}}\vec{J}^{T,D}_{f_{51}} \cdot \vec{S}_{f_{51}}} = \iint_{f_{51}} (\vec{J}^{T,D}_{f_{51}} \cdot \vec{n}_{f_{51}}) dS_{f_{51}} \approx \color{orange}{\sum\limits_{ip\sim ip(f_{51})} (\vec{J}^{T,D} \cdot \vec{n}_{ip})\omega_{ip} S_{f_{51}}}\]</div>
<p>Here we still use one integration point scheme to explain the calculation process,</p>
<div class="math notranslate nohighlight" id="equation-eq-fvm-flux-gaussian-integral-boundary">
<span class="eqno">(42)<a class="headerlink" href="#equation-eq-fvm-flux-gaussian-integral-boundary" title="Permalink to this equation"></a></span>\[\color{orange}{\sum\limits_{ip\sim ip(f_{51})} (\vec{J}^{T,D} \cdot \vec{n}_{ip})\omega S_f } = -\left(D \frac{\partial T}{\partial x} \vec{i} + D\frac{\partial T}{\partial y} \vec{j} \right)_{f_{51}} \cdot \Delta y_{f_{51}} \vec{i} = -\color{blue}{\left( D\frac{\partial T}{\partial x} \right)_{f_{51}} \Delta y_{f_{51}}}\]</div>
<p>Now let’s calculate the gradient on the boundary face,</p>
<div class="math notranslate nohighlight" id="equation-eq-fvm-gradient-boundary">
<span class="eqno">(43)<a class="headerlink" href="#equation-eq-fvm-gradient-boundary" title="Permalink to this equation"></a></span>\[-\color{blue}{\left( D\frac{\partial T}{\partial x} \right)_{f_{51}} \Delta y_{f_{51}}} = -D\frac{\color{purple}{T_{f_{51}}} - T_{C}}{x_{f_{51}} - x_C}\Delta y_{f_{51}} = -\frac{D \Delta y_{f_{51}}}{\delta x_{f_{51}}}(\color{purple}{T_{f_{51}}} - T_{C}) = a_{f_{51}}(-T_{C}) +  c_{f_{51}}\]</div>
<p>Substituting <a class="reference internal" href="#equation-eq-fvm-gradient-boundary">equation (43)</a> back to  <a class="reference internal" href="#equation-eq-fvm-flux-gaussian-integral-boundary">equation (42)</a>, <a class="reference internal" href="#equation-eq-fvm-flux-boundary">equation (41)</a> and  <a class="reference internal" href="#equation-eq-fvm-surface-flux-boundary">equation (40)</a>, we can get Laplacian discretization coefficients <span class="math notranslate nohighlight">\(a_{f_{51}}\)</span> and <span class="math notranslate nohighlight">\(c_{f_{51}}\)</span>,</p>
<div class="math notranslate nohighlight" id="equation-eq-fvm-laplacian-coeff-boundary-fixedvalue">
<span class="eqno">(44)<a class="headerlink" href="#equation-eq-fvm-laplacian-coeff-boundary-fixedvalue" title="Permalink to this equation"></a></span>\[\begin{split}\begin{eqnarray}
a_{F_{51}} &amp;=&amp; -D\frac{\Delta y_{f_{51}}}{\delta x_{f_{51}}}\\
c_{F_{51}} &amp;=&amp; a_{F_{51}}\color{purple}{T_{f_{51}}}
\end{eqnarray}\end{split}\]</div>
<p>Notice how <span class="math notranslate nohighlight">\(\color{purple}{T_{f_{51}}}\)</span> is known (a boundary condition), so that the term <span class="math notranslate nohighlight">\(-a_{F_{51}}\color{purple}{T_{f_{51}}}\)</span> will end up on the right-hand side and not in the coefficient matrix.</p>
<p>4.2 Fixed flux boundary condition</p>
<p><strong>Fixed flux</strong> means <strong>normal gradient to the boundary face</strong> of field <span class="math notranslate nohighlight">\(T\)</span> is given, i.e. <span class="math notranslate nohighlight">\(\color{purple}{\vec{J}^{T,D}_{f_{b}} \cdot \vec{n}_{f_{b}} = q_{f_b}}\)</span> is given. There fore we can calculate flux on boundary face, <span class="math notranslate nohighlight">\(f_{51}\)</span> for example,</p>
<div class="math notranslate nohighlight" id="equation-eq-fvm-fixedflux-boundary">
<span class="eqno">(45)<a class="headerlink" href="#equation-eq-fvm-fixedflux-boundary" title="Permalink to this equation"></a></span>\[\color{red}{\iint_{f_{51}}\vec{J}^{T,D}_{f_{51}} \cdot \vec{S}_{f_{51}}} = \iint_{f_{51}} (\vec{J}^{T,D}_{f_{51}} \cdot \vec{n}_{f_{51}}) dS_{f_{51}} = \iint_{f_{51}} \color{purple}{q_{f_{51}}} dS_{f_{51}} = \color{purple}{q_{f_{51}}} S_{f_{51}} = \color{purple}{q_{f_{51}}} \Delta y_{f_{51}}\]</div>
<p>Substituting <a class="reference internal" href="#equation-eq-fvm-fixedflux-boundary">equation (45)</a> back to <a class="reference internal" href="#equation-eq-fvm-surface-flux-boundary">equation (40)</a>, we can get Laplacian discretization coefficients <span class="math notranslate nohighlight">\(a_{f_{51}}\)</span> and <span class="math notranslate nohighlight">\(c_{f_{51}}\)</span>,</p>
<div class="math notranslate nohighlight" id="equation-eq-fvm-laplacian-coeff-boundary-fixedflux">
<span class="eqno">(46)<a class="headerlink" href="#equation-eq-fvm-laplacian-coeff-boundary-fixedflux" title="Permalink to this equation"></a></span>\[\begin{split}\begin{eqnarray}
a_{F_{51}} &amp;=&amp; 0 \\
c_{F_{51}} &amp;=&amp; \color{purple}{q_{f_{51}}} \Delta y_{f_{51}}
\end{eqnarray}\end{split}\]</div>
<p>4.3 Construct coefficients of the boundary cell <span class="math notranslate nohighlight">\(C_{19}\)</span></p>
<p>Do the same thing as 4.1 or 4.2 (depends on the type of boundary condition) for all boundary faces of a boundary cell <span class="math notranslate nohighlight">\(C\)</span> and calculate the coefficients of <span class="math notranslate nohighlight">\(a_{F_b}\)</span> and <span class="math notranslate nohighlight">\(c_{F_b}\)</span>, then the <a class="reference internal" href="#equation-eq-fvm-surface-sum-expand-boundary">equation (39)</a> can be expressed as,</p>
<div class="math notranslate nohighlight" id="equation-eq-fvm-matrix-form-boundarycell">
<span class="eqno">(47)<a class="headerlink" href="#equation-eq-fvm-matrix-form-boundarycell" title="Permalink to this equation"></a></span>\[\begin{split}  \begin{eqnarray}
b_{C_{19}} &amp; =  &amp; a_{F_{18}} (T_{F_{18}} - T_C) + a_{F_{35}} (T_{F_{35}} - T_C) + a_{F_{37}} (T_{F_{37}} - T_C) + a_{F_{51}} (-T_C) +c_{F_{51}} \\
   &amp; = &amp; \sum\limits_{f\in[18, 35, 37]} a_{F_f} T_{F_f} + \left(-\sum\limits_{f\in[18, 35, 37, 51]} a_{F_f} \right) T_C + \sum\limits_{f\in[51]} c_{F_f} \\
   &amp; = &amp; \sum\limits_{f\sim nb(\text{internal face})} a_{F_f} T_{F_f} + \left(-\sum\limits_{f\sim nb(\text{all face})} a_{F_f} \right) T_C + \sum\limits_{f\sim nb(\text{boundary face})} c_{F_f}
\end{eqnarray}\end{split}\]</div>
<div class="math notranslate nohighlight" id="equation-eq-fvm-matrix-form-boundarycell19">
<span class="eqno">(48)<a class="headerlink" href="#equation-eq-fvm-matrix-form-boundarycell19" title="Permalink to this equation"></a></span>\[\mathbf{A}_{N\times N}[19,:] \mathbf{T}_{N\times 1} =  B_{19}\]</div>
<p>where <span class="math notranslate nohighlight">\(B_{19} = b_{C_{19}} - \sum\limits_{f\sim nb(\text{boundary face})} c_{F_f}\)</span>.</p>
</div>
</div>
<ol class="arabic simple" start="5">
<li><p>Construct general matrix form of the <a class="reference internal" href="#equation-eq-fvm-surface-sum">equation (32)</a></p></li>
</ol>
<div class="math notranslate nohighlight" id="equation-eq-fvm-matrix-form0">
<span class="eqno">(49)<a class="headerlink" href="#equation-eq-fvm-matrix-form0" title="Permalink to this equation"></a></span>\[\begin{split}\begin{eqnarray}
-\sum\limits_{f\sim nb(C)} (D\nabla T)_{F_f}\cdot \vec{S}_{F_f} &amp; = &amp;  \sum\limits_{f\sim \text{internal faces}(C)} a_{F_f} T_{C} + \left(-\sum\limits_{f\sim nb(C)} a_{F_f} \right)T_{F_f} + \sum\limits_{f\sim \text{boundary faces}(C)} c_{F_{F_f}} \\
&amp; = &amp; a_CT_C - \sum\limits_{f\sim \text{internal faces}(C)} a_{F_f} T_{F_f} + \sum\limits_{f\sim \text{boundary faces}(C)} c_{F_{f}}
\end{eqnarray}\end{split}\]</div>
<p>Matrix form of the <a class="reference internal" href="#equation-eq-fvm-surface-sum">equation (32)</a> can be written as,</p>
<div class="math notranslate nohighlight" id="equation-fvm-matrix-form">
<span class="eqno">(50)<a class="headerlink" href="#equation-fvm-matrix-form" title="Permalink to this equation"></a></span>\[\mathbf{A}_{N \times N} \mathbf{T}_{N\times1} = \mathbf{B}_{N\times1}\]</div>
<p>here <span class="math notranslate nohighlight">\(N\)</span> is the number of cell, <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> is a sparse matrix of coefficients,
<span class="math notranslate nohighlight">\(\mathbf{T}\)</span> is cell-centered temperature field.
The matrix is visualized as <a class="reference internal" href="#fig-fvm-matrix"><span class="std std-numref">Fig. 37</span></a>.
It should be noted that <strong>the coefficients matrix of Laplacian term is a symmetric matrix and the boundary conditions only affect diagonal entry of the coefficients matrix</strong>. Further, only the fixed value boundary condition affects the matrix and the fixed flux boundary condition affects the RHS(Right hand of side) <span class="math notranslate nohighlight">\(B\)</span>.</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--2-input--1" name="tab-set--2" type="radio"><label class="tab-label" for="tab-set--2-input--1">Regular mesh</label><div class="tab-content docutils container">
<figure class="align-center" id="fig-fvm-matrix" style="width: 100%">
<img alt="../../_images/matrix_FVM_regularBox.svg" src="../../_images/matrix_FVM_regularBox.svg" /><figcaption>
<p><span class="caption-number">Fig. 37 </span><span class="caption-text">Visualization of <span class="math notranslate nohighlight">\(\mathbf{A}_{N \times N} \mathbf{T}_{N\times1} = \mathbf{b}_{N\times1}\)</span>.
The coefficients of the selected cell <span class="math notranslate nohighlight">\(C\)</span> (<a class="reference internal" href="#fig-polymesh-regularbox"><span class="std std-numref">Fig. 34</span></a>) are marked by green rectangle.</span><a class="headerlink" href="#fig-fvm-matrix" title="Permalink to this image"></a></p>
</figcaption>
</figure>
</div>
<input class="tab-input" id="tab-set--2-input--2" name="tab-set--2" type="radio"><label class="tab-label" for="tab-set--2-input--2">Unstructured mesh</label><div class="tab-content docutils container">
<figure class="align-center" id="fig-fvm-matrix-unstructured" style="width: 100%">
<img alt="../../_images/matrix_FVM_unstructured.svg" src="../../_images/matrix_FVM_unstructured.svg" /><figcaption>
<p><span class="caption-number">Fig. 38 </span><span class="caption-text">Visualization of <span class="math notranslate nohighlight">\(\mathbf{A}_{N \times N} \mathbf{T}_{N\times1} = \mathbf{b}_{N\times1}\)</span>.
The coefficients of the selected cell <span class="math notranslate nohighlight">\(C\)</span> (<a class="reference internal" href="#fig-polymesh-regularbox"><span class="std std-numref">Fig. 34</span></a>) are marked by green rectangle.</span><a class="headerlink" href="#fig-fvm-matrix-unstructured" title="Permalink to this image"></a></p>
</figcaption>
</figure>
</div>
</div>
</section>
<section id="step-4-temporal-discretization-the-transient-term">
<h3>Step 4, Temporal Discretization: The Transient Term<a class="headerlink" href="#step-4-temporal-discretization-the-transient-term" title="Permalink to this headline"></a></h3>
<p>After spatial discretization, the <a class="reference internal" href="#equation-eq-fvm-volume-int">equation (29)</a> can be expressed as,</p>
<div class="math notranslate nohighlight" id="equation-eq-fvm-diffusioneq-spatial-dis">
<span class="eqno">(51)<a class="headerlink" href="#equation-eq-fvm-diffusioneq-spatial-dis" title="Permalink to this equation"></a></span>\[\frac{\partial T}{\partial t} V_C - L(T_C^t) =0\]</div>
<p>where <span class="math notranslate nohighlight">\(V_C\)</span> is the volume of the discretization cell and <span class="math notranslate nohighlight">\(L(T_C^t)\)</span> is the spatial discretization operator expressed at some reference time <span class="math notranslate nohighlight">\(t\)</span>, which can be written as algebraic form (see also <a class="reference internal" href="#equation-eq-fvm-matrix-form0">equation (49)</a>),</p>
<div class="math notranslate nohighlight" id="equation-eq-fvm-spatial-dis-algebraic">
<span class="eqno">(52)<a class="headerlink" href="#equation-eq-fvm-spatial-dis-algebraic" title="Permalink to this equation"></a></span>\[L(T_C^t) = a_C T_C^t + \sum\limits_{F\sim NB(C)} a_F T_F^t + \sum\limits_{F\sim NB(C)} c_F\]</div>
<p>where <span class="math notranslate nohighlight">\(a_C\)</span> is the diagonal coefficients of the matrix, <span class="math notranslate nohighlight">\(a_F\)</span> is the off-diagonal coefficients, and the <span class="math notranslate nohighlight">\(c_F\)</span> is the source coefficients as right hand side of matrix of system.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>For specific cell <span class="math notranslate nohighlight">\(C\)</span>,</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(a_F\)</span> is only contributed from internal faces.</p></li>
<li><p><span class="math notranslate nohighlight">\(a_C\)</span> is the negative summation of <span class="math notranslate nohighlight">\(a_F\)</span>, contributed from all faces, but equation of the <span class="math notranslate nohighlight">\(a_F\)</span> for a boundary faces (<a class="reference internal" href="#equation-eq-fvm-laplacian-coeff-boundary-fixedvalue">equation (44)</a> and <a class="reference internal" href="#equation-eq-fvm-laplacian-coeff-boundary-fixedflux">equation (46)</a>) is a little bit different from internal face.</p></li>
<li><p><span class="math notranslate nohighlight">\(c_F\)</span> only comes from boundary faces of cell <span class="math notranslate nohighlight">\(C\)</span> if it has boundary face, see also <a class="reference internal" href="#equation-eq-fvm-laplacian-coeff-boundary-fixedvalue">equation (44)</a> and <a class="reference internal" href="#equation-eq-fvm-laplacian-coeff-boundary-fixedflux">equation (46)</a>. <span class="math notranslate nohighlight">\(c_F\)</span> will contribute to RHS (<span class="math notranslate nohighlight">\(\mathbf{B}\)</span>) of the algebraic <a class="reference internal" href="#equation-fvm-matrix-form">equation (50)</a>.</p></li>
</ul>
</div>
<p>Let’s do the temporal discretization for the first term of <a class="reference internal" href="#equation-eq-fvm-diffusioneq-spatial-dis">equation (51)</a>,</p>
<div class="math notranslate nohighlight">
\[\frac{T^{t+\Delta t/2} - T^{t - \Delta t/2}}{\Delta t} V_C + L(T_C^t) = 0\]</div>
<p>To derive the full discretized equation, an interpolation profile expressing the face values at (<span class="math notranslate nohighlight">\(t-\Delta t/2\)</span>) and (<span class="math notranslate nohighlight">\(t+\Delta t\)</span>) in terms of the element values at (<span class="math notranslate nohighlight">\(t\)</span>), (<span class="math notranslate nohighlight">\(t-\Delta t\)</span>), etc., is needed.Independent of the profile used, the flux will be linearized based on old and new values as,</p>
<div class="math notranslate nohighlight" id="equation-eq-fvm-temporal-linear">
<span class="eqno">(53)<a class="headerlink" href="#equation-eq-fvm-temporal-linear" title="Permalink to this equation"></a></span>\[b_C = FluxC T_C + FluxC^o T_C^o + FluxV\]</div>
<p>where the superscript <span class="math notranslate nohighlight">\(^{o}\)</span> refers to old values. With the format of the linearization,
the coefficient <span class="math notranslate nohighlight">\(FluxC\)</span> will be <strong>added to diagonal element</strong> and the coefficient <span class="math notranslate nohighlight">\(FluxC^o T_C^o + FluxV\)</span> will be <strong>added to the source or RHS</strong> (<span class="math notranslate nohighlight">\(B\)</span>).</p>
<section id="first-order-implicit-euler-scheme">
<h4>First order implicit Euler scheme<a class="headerlink" href="#first-order-implicit-euler-scheme" title="Permalink to this headline"></a></h4>
<div class="math notranslate nohighlight" id="equation-eq-fvm-firstorder-euler-imp">
<span class="eqno">(54)<a class="headerlink" href="#equation-eq-fvm-firstorder-euler-imp" title="Permalink to this equation"></a></span>\[\frac{T^t - T^{t-\Delta t}}{\Delta t} V_C - L(T^{t}) = 0\]</div>
<p>Therefore the coefficients will be</p>
<div class="math notranslate nohighlight" id="equation-eq-fvm-firstorder-euler-imp-coeff">
<span class="eqno">(55)<a class="headerlink" href="#equation-eq-fvm-firstorder-euler-imp-coeff" title="Permalink to this equation"></a></span>\[FluxC = \frac{V_C}{\Delta t}, ~ FluxC^o = - \frac{V_C}{\Delta t}, ~ FluxV =0\]</div>
</section>
<section id="first-order-explicit-euler-scheme">
<h4>First order explicit Euler scheme<a class="headerlink" href="#first-order-explicit-euler-scheme" title="Permalink to this headline"></a></h4>
<div class="math notranslate nohighlight" id="equation-eq-fvm-firstorder-euler-exp">
<span class="eqno">(56)<a class="headerlink" href="#equation-eq-fvm-firstorder-euler-exp" title="Permalink to this equation"></a></span>\[\frac{T^{t+\Delta t} - T^t}{\Delta t} V_C - L(T^{t}) = 0\]</div>
<p>Note that now the new time is at <span class="math notranslate nohighlight">\(t+\Delta t\)</span> and that the spatial operator (<span class="math notranslate nohighlight">\(L\)</span>) of <a class="reference internal" href="#equation-eq-fvm-firstorder-euler-exp">equation (56)</a> has to be evaluated at time <span class="math notranslate nohighlight">\(t\)</span>.
Therefore, in order to find the value of <span class="math notranslate nohighlight">\(T\)</span> at time <span class="math notranslate nohighlight">\(t+\Delta t\)</span>, we don’t need to solve a set of linear algebraic equations,</p>
<div class="math notranslate nohighlight" id="equation-eq-fvm-firstorder-euler-exp-coef">
<span class="eqno">(57)<a class="headerlink" href="#equation-eq-fvm-firstorder-euler-exp-coef" title="Permalink to this equation"></a></span>\[T^{t+\Delta t} = \frac{\Delta t}{V_C} L(T^{t}) + T^t\]</div>
</section>
</section>
<section id="step-6-solution-of-the-discretized-equations">
<h3>Step 6: Solution of the discretized equations<a class="headerlink" href="#step-6-solution-of-the-discretized-equations" title="Permalink to this headline"></a></h3>
<p>The discretization of the differential equation results in a set of discrete algebraic equations, which must be solved to obtain the discrete values of T. The coefficients of these equations may be independent of T (i.e., linear) or dependent on T (i.e. non-linear). The techniques to solve this algebraic system of equations are independent of the discretization method.
The solution methods for solving systems of algebraic equations may be broadly
classified as direct or iterative.</p>
</section>
</section>
<section id="openfoam-implementation">
<h2>OpenFOAM implementation<a class="headerlink" href="#openfoam-implementation" title="Permalink to this headline"></a></h2>
<p>Ok, now let’s do some practical tings,
(0) <strong>generate mesh</strong>;
(1) <strong>read mesh and do some useful calculation</strong>, e.g. cell volume, face area, …, etc;
(2) <strong>discretize Laplacian term and get coefficients</strong>;
(3) <strong>discretize transient term and get additional coefficients</strong>;
(4) <strong>construct the final coefficient matrix and RHS</strong>;
(5) <strong>solve the system of algebraic equations</strong>;
(6) <strong>write solution to file</strong>.</p>
<div class="admonition-goal admonition">
<p class="admonition-title">Goal</p>
<p>Deeply look into OpenFOAM and understand how it works!</p>
</div>
<p>In order to better understand OpenFOAM’s logic and its work flow, we have to look at the basic structure of the <a class="reference external" href="https://cpp.openfoam.org/v6/laplacianFoam_8C_source.html">source code</a> of a basic solver, <code class="code docutils literal notranslate"><span class="pre">laplacianFoam</span></code>.</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--3-input--1" name="tab-set--3" type="radio"><label class="tab-label" for="tab-set--3-input--1">laplacianFoam.C</label><div class="tab-content docutils container">
<div class="literal-block-wrapper docutils container" id="lst-source-laplacianfoam">
<div class="code-block-caption"><span class="caption-number">Listing 20 </span><span class="caption-text">Source code of laplacianFoam</span><a class="headerlink" href="#lst-source-laplacianfoam" title="Permalink to this code"></a></div>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;fvCFD.H&quot;</span><span class="c1">               // Basic head file of OF</span><span class="cp"></span>
<span class="linenos"> 2</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;simpleControl.H&quot;</span><span class="c1">       // Basic head file of OF</span><span class="cp"></span>
<span class="linenos"> 3</span><span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">argv</span><span class="p">[])</span><span class="w"> </span><span class="c1">// Typical c++ main control function</span>
<span class="linenos"> 4</span><span class="p">{</span><span class="w"></span>
<span class="linenos"> 5</span><span class="w">   </span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;setRootCaseLists.H&quot;</span><span class="c1"> // Do some case/file path-related thing</span><span class="cp"></span>
<span class="linenos"> 6</span><span class="w">   </span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;createTime.H&quot;</span><span class="c1">       // Create a time object: read controlDict, ...</span><span class="cp"></span>
<span class="hll"><span class="linenos"> 7</span><span class="w">   </span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;createMesh.H&quot;</span><span class="c1">       // (2) Create mesh object: read mesh and do some useful calculation</span><span class="cp"></span>
</span><span class="linenos"> 8</span><span class="w">   </span><span class="n">simpleControl</span><span class="w"> </span><span class="n">simple</span><span class="p">(</span><span class="n">mesh</span><span class="p">);</span><span class="w">   </span><span class="c1">// Time loop control object</span>
<span class="hll"><span class="linenos"> 9</span><span class="w">   </span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;createFields.H&quot;</span><span class="c1">     // (3) Read input data: T and D in the PDE</span><span class="cp"></span>
</span><span class="linenos">10</span>
<span class="linenos">11</span><span class="w">   </span><span class="n">Info</span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">Calculating temperature distribution</span><span class="se">\n</span><span class="s">&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="linenos">12</span><span class="w">   </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">simple</span><span class="p">.</span><span class="n">loop</span><span class="p">(</span><span class="n">runTime</span><span class="p">))</span><span class="w"> </span><span class="c1">// do time loop</span>
<span class="linenos">13</span><span class="w">   </span><span class="p">{</span><span class="w"></span>
<span class="linenos">14</span><span class="w">      </span><span class="n">Info</span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Time = &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">runTime</span><span class="p">.</span><span class="n">timeName</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">nl</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="linenos">15</span><span class="w">      </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">simple</span><span class="p">.</span><span class="n">correctNonOrthogonal</span><span class="p">())</span><span class="w">  </span><span class="c1">// Non-orthogonal correction loop for the unstructured/non-orthogonal mesh</span>
<span class="linenos">16</span><span class="w">      </span><span class="p">{</span><span class="w"></span>
<span class="hll"><span class="linenos">17</span><span class="w">         </span><span class="n">fvScalarMatrix</span><span class="w"> </span><span class="n">TEqn</span><span class="w">                 </span><span class="c1">// (5) construct the final coefficient matrix, include RHS (.source)</span>
</span><span class="linenos">18</span><span class="w">            </span><span class="p">(</span><span class="w"></span>
<span class="hll"><span class="linenos">19</span><span class="w">               </span><span class="n">fvm</span><span class="o">::</span><span class="n">ddt</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="w">                   </span><span class="c1">// (4) Discretization of the transient term, return a fvMatrix object</span>
</span><span class="linenos">20</span><span class="w">               </span><span class="o">-</span><span class="w"></span>
<span class="hll"><span class="linenos">21</span><span class="w">               </span><span class="n">fvm</span><span class="o">::</span><span class="n">laplacian</span><span class="p">(</span><span class="n">DT</span><span class="p">,</span><span class="w"> </span><span class="n">T</span><span class="p">)</span><span class="w">         </span><span class="c1">// (3) Discretization of the Laplacian, return a fvMatrix object</span>
</span><span class="linenos">22</span><span class="w">            </span><span class="p">);</span><span class="w"></span>
<span class="hll"><span class="linenos">23</span><span class="w">            </span><span class="n">TEqn</span><span class="p">.</span><span class="n">solve</span><span class="p">();</span><span class="w">                    </span><span class="c1">// (6) Solve the system of algebraic equations</span>
</span><span class="linenos">24</span><span class="w">      </span><span class="p">}</span><span class="w"></span>
<span class="linenos">25</span><span class="w">      </span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;write.H&quot;</span><span class="c1">                     // (7) Save solution to file.</span><span class="cp"></span>
<span class="linenos">26</span><span class="w">      </span><span class="n">Info</span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;ExecutionTime = &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">runTime</span><span class="p">.</span><span class="n">elapsedCpuTime</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; s&quot;</span><span class="w"></span>
<span class="linenos">27</span><span class="w">            </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;  ClockTime = &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">runTime</span><span class="p">.</span><span class="n">elapsedClockTime</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; s&quot;</span><span class="w"></span>
<span class="linenos">28</span><span class="w">            </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">nl</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="linenos">29</span><span class="w">   </span><span class="p">}</span><span class="w"></span>
<span class="linenos">30</span><span class="w">   </span><span class="n">Info</span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;End</span><span class="se">\n</span><span class="s">&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="linenos">31</span><span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="linenos">32</span><span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</div>
<table class="docutils align-default" id="id3">
<caption><span class="caption-number">Table 1 </span><span class="caption-text">Comparison between equation and code</span><a class="headerlink" href="#id3" title="Permalink to this table"></a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Term</p></td>
<td><p>Equation</p></td>
<td><p>Code</p></td>
<td><p>Coefficients(ldu:b)</p></td>
<td><p>Reference</p></td>
</tr>
<tr class="row-even"><td><p>Transient</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{\partial T}{\partial t}\)</span></p></td>
<td><p><code class="code docutils literal notranslate"><span class="pre">fvm::ddt(T)</span></code></p></td>
<td><p>d(<span class="math notranslate nohighlight">\(FluxC\)</span>), b(<span class="math notranslate nohighlight">\(FluxC^o\)</span>)</p></td>
<td><p><a class="reference internal" href="#equation-eq-fvm-firstorder-euler-exp-coef">equation (57)</a></p></td>
</tr>
<tr class="row-odd"><td><p>Laplacian</p></td>
<td><p><span class="math notranslate nohighlight">\(\nabla \cdot D \nabla T\)</span></p></td>
<td><p><code class="code docutils literal notranslate"><span class="pre">fvm::laplacian(DT,</span> <span class="pre">T)</span></code></p></td>
<td><p>d(<span class="math notranslate nohighlight">\(\sum\limits_{F\sim NB(C)}a_F\)</span>), u(<span class="math notranslate nohighlight">\(a_F\)</span> only internal faces)</p></td>
<td><p><a class="reference internal" href="#equation-eq-fvm-matrix-form-internalcell">equation (37)</a>, <a class="reference internal" href="#equation-eq-fvm-laplacian-coeff-boundary-fixedvalue">equation (44)</a>, <a class="reference internal" href="#equation-eq-fvm-laplacian-coeff-boundary-fixedflux">equation (46)</a></p></td>
</tr>
</tbody>
</table>
</div>
<input class="tab-input" id="tab-set--3-input--2" name="tab-set--3" type="radio"><label class="tab-label" for="tab-set--3-input--2">createFields.H</label><div class="tab-content docutils container">
<div class="literal-block-wrapper docutils container" id="lst-createfields">
<div class="code-block-caption"><span class="caption-number">Listing 21 </span><span class="caption-text">createFields.H</span><a class="headerlink" href="#lst-createfields" title="Permalink to this code"></a></div>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="n">volScalarField</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="c1">//Read input data of T, include ICs and BCs</span>
<span class="linenos"> 2</span><span class="p">(</span><span class="w"></span>
<span class="linenos"> 3</span><span class="w">   </span><span class="n">IOobject</span><span class="w"></span>
<span class="linenos"> 4</span><span class="w">   </span><span class="p">(</span><span class="w"></span>
<span class="linenos"> 5</span><span class="w">      </span><span class="s">&quot;T&quot;</span><span class="p">,</span><span class="w"></span>
<span class="linenos"> 6</span><span class="w">      </span><span class="n">runTime</span><span class="p">.</span><span class="n">timeName</span><span class="p">(),</span><span class="w"></span>
<span class="linenos"> 7</span><span class="w">      </span><span class="n">mesh</span><span class="p">,</span><span class="w"></span>
<span class="linenos"> 8</span><span class="w">      </span><span class="n">IOobject</span><span class="o">::</span><span class="n">MUST_READ</span><span class="p">,</span><span class="w"></span>
<span class="linenos"> 9</span><span class="w">      </span><span class="n">IOobject</span><span class="o">::</span><span class="n">AUTO_WRITE</span><span class="w"></span>
<span class="linenos">10</span><span class="w">   </span><span class="p">),</span><span class="w"></span>
<span class="linenos">11</span><span class="w">   </span><span class="n">mesh</span><span class="w"></span>
<span class="linenos">12</span><span class="p">);</span><span class="w"></span>
<span class="linenos">13</span>
<span class="linenos">14</span><span class="n">IOdictionary</span><span class="w"> </span><span class="n">transportProperties</span><span class="w"> </span><span class="c1">// Read dictionary file of transportProperties</span>
<span class="linenos">15</span><span class="p">(</span><span class="w"></span>
<span class="linenos">16</span><span class="w">   </span><span class="n">IOobject</span><span class="w"></span>
<span class="linenos">17</span><span class="w">   </span><span class="p">(</span><span class="w"></span>
<span class="linenos">18</span><span class="w">      </span><span class="s">&quot;transportProperties&quot;</span><span class="p">,</span><span class="w"></span>
<span class="linenos">19</span><span class="w">      </span><span class="n">runTime</span><span class="p">.</span><span class="n">constant</span><span class="p">(),</span><span class="w"></span>
<span class="linenos">20</span><span class="w">      </span><span class="n">mesh</span><span class="p">,</span><span class="w"></span>
<span class="linenos">21</span><span class="w">      </span><span class="n">IOobject</span><span class="o">::</span><span class="n">MUST_READ_IF_MODIFIED</span><span class="p">,</span><span class="w"></span>
<span class="linenos">22</span><span class="w">      </span><span class="n">IOobject</span><span class="o">::</span><span class="n">NO_WRITE</span><span class="w"></span>
<span class="linenos">23</span><span class="w">   </span><span class="p">)</span><span class="w"></span>
<span class="linenos">24</span><span class="p">);</span><span class="w"></span>
<span class="linenos">25</span><span class="n">dimensionedScalar</span><span class="w"> </span><span class="n">DT</span><span class="w"> </span><span class="c1">// Read the diffusivity D (constant) from transportProperties object</span>
<span class="linenos">26</span><span class="p">(</span><span class="w"></span>
<span class="linenos">27</span><span class="w">   </span><span class="n">transportProperties</span><span class="p">.</span><span class="n">lookup</span><span class="p">(</span><span class="s">&quot;DT&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">28</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<input class="tab-input" id="tab-set--3-input--3" name="tab-set--3" type="radio"><label class="tab-label" for="tab-set--3-input--3">Input data 1</label><div class="tab-content docutils container">
<div class="literal-block-wrapper docutils container" id="lst-transportproperties">
<div class="code-block-caption"><span class="caption-number">Listing 22 </span><span class="caption-text">constant/transportProperties</span><a class="headerlink" href="#lst-transportproperties" title="Permalink to this code"></a></div>
<div class="highlight-foam notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="k">FoamFile</span>
<span class="linenos">2</span><span class="p">{</span>
<span class="linenos">3</span>   <span class="kt">version</span>     <span class="mf">2.0</span><span class="p">;</span>
<span class="linenos">4</span>   <span class="kt">format</span>      <span class="k">ascii</span><span class="p">;</span>
<span class="linenos">5</span>   <span class="kt">class</span>       <span class="k">dictionary</span><span class="p">;</span>
<span class="linenos">6</span>   <span class="kt">location</span>    <span class="s">&quot;constant&quot;</span><span class="p">;</span>
<span class="linenos">7</span>   <span class="kt">object</span>      <span class="k">transportProperties</span><span class="p">;</span>
<span class="linenos">8</span><span class="p">}</span>
<span class="linenos">9</span><span class="n">DT</span>              <span class="n">DT</span> <span class="p">[</span><span class="mi">0</span> <span class="mi">2</span> <span class="o">-</span><span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span><span class="p">]</span> <span class="mf">4e-05</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<input class="tab-input" id="tab-set--3-input--4" name="tab-set--3" type="radio"><label class="tab-label" for="tab-set--3-input--4">Input data 2</label><div class="tab-content docutils container">
<div class="literal-block-wrapper docutils container" id="lst-0-t">
<div class="code-block-caption"><span class="caption-number">Listing 23 </span><span class="caption-text">0/T</span><a class="headerlink" href="#lst-0-t" title="Permalink to this code"></a></div>
<div class="highlight-foam notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="k">FoamFile</span>
<span class="linenos"> 2</span><span class="p">{</span>
<span class="linenos"> 3</span>   <span class="kt">version</span>     <span class="mf">2.0</span><span class="p">;</span>
<span class="linenos"> 4</span>   <span class="kt">format</span>      <span class="k">ascii</span><span class="p">;</span>
<span class="linenos"> 5</span>   <span class="kt">class</span>       <span class="n">volScalarField</span><span class="p">;</span>
<span class="linenos"> 6</span>   <span class="kt">object</span>      <span class="k">T</span><span class="p">;</span>
<span class="linenos"> 7</span><span class="p">}</span>
<span class="linenos"> 8</span><span class="kt">dimensions</span>      <span class="p">[</span><span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span><span class="p">];</span>
<span class="linenos"> 9</span><span class="kt">internalField</span>   <span class="k">uniform</span> <span class="mi">273</span><span class="p">;</span>
<span class="linenos">10</span><span class="k">boundaryField</span>
<span class="linenos">11</span><span class="p">{</span>
<span class="linenos">12</span>   <span class="n">left</span>
<span class="linenos">13</span>   <span class="p">{</span>
<span class="linenos">14</span>      <span class="kt">type</span>            <span class="k">fixedValue</span><span class="p">;</span>
<span class="linenos">15</span>      <span class="kt">value</span>           <span class="k">uniform</span> <span class="mi">273</span><span class="p">;</span>
<span class="linenos">16</span>   <span class="p">}</span>
<span class="linenos">17</span>   <span class="n">right</span>
<span class="linenos">18</span>   <span class="p">{</span>
<span class="linenos">19</span>      <span class="kt">type</span>            <span class="k">fixedValue</span><span class="p">;</span>
<span class="linenos">20</span>      <span class="kt">value</span>           <span class="k">uniform</span> <span class="mi">573</span><span class="p">;</span>
<span class="linenos">21</span>   <span class="p">}</span>
<span class="linenos">22</span>   <span class="s">&quot;(top|bottom)&quot;</span>
<span class="linenos">23</span>   <span class="p">{</span>
<span class="linenos">24</span>      <span class="kt">type</span>            <span class="k">zeroGradient</span><span class="p">;</span>
<span class="linenos">25</span>   <span class="p">}</span>
<span class="linenos">26</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</div>
<section id="step0-generate-mesh">
<h3>Step0, Generate mesh<a class="headerlink" href="#step0-generate-mesh" title="Permalink to this headline"></a></h3>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--4-input--1" name="tab-set--4" type="radio"><label class="tab-label" for="tab-set--4-input--1">Generate mesh</label><div class="tab-content docutils container">
<p>Nothing special, just a meshing process.
Here we use the OpenFOAM utility <code class="code docutils literal notranslate"><span class="pre">blockMesh</span></code> to generate a regular mesh (<a class="reference download internal" download="" href="../../_downloads/182fc0c7918b295146e8ff66ee704105/regularBox.zip"><code class="xref download docutils literal notranslate"><span class="pre">Regular</span> <span class="pre">box</span> <span class="pre">case</span></code></a>) same as <a class="reference internal" href="#fig-polymesh-regularbox"><span class="std std-numref">Fig. 34</span></a>.</p>
</div>
<input class="tab-input" id="tab-set--4-input--2" name="tab-set--4" type="radio"><label class="tab-label" for="tab-set--4-input--2">OpenFOAM script</label><div class="tab-content docutils container">
<div class="literal-block-wrapper docutils container" id="lst-blockmesh-regularbox">
<div class="code-block-caption"><span class="caption-number">Listing 24 </span><span class="caption-text">blockMeshDict of a regular box mesh we shown above</span><a class="headerlink" href="#lst-blockmesh-regularbox" title="Permalink to this code"></a></div>
<div class="highlight-foam notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="cm">/*--------------------------------*- C++ -*----------------------------------*\</span>
<span class="linenos"> 2</span><span class="cm">| =========                 |                                                 |</span>
<span class="linenos"> 3</span><span class="cm">| \\      /  F ield         | OpenFOAM: The Open Source CFD Toolbox           |</span>
<span class="linenos"> 4</span><span class="cm">|  \\    /   O peration     | Version:  5                                     |</span>
<span class="linenos"> 5</span><span class="cm">|   \\  /    A nd           | Web:      www.OpenFOAM.org                      |</span>
<span class="linenos"> 6</span><span class="cm">|    \\/     M anipulation  |                                                 |</span>
<span class="linenos"> 7</span><span class="cm">\*---------------------------------------------------------------------------*/</span>
<span class="linenos"> 8</span><span class="k">FoamFile</span>
<span class="linenos"> 9</span><span class="p">{</span>
<span class="linenos">10</span>   <span class="kt">version</span>     <span class="mf">2.0</span><span class="p">;</span>
<span class="linenos">11</span>   <span class="kt">format</span>      <span class="k">ascii</span><span class="p">;</span>
<span class="linenos">12</span>   <span class="kt">class</span>       <span class="k">dictionary</span><span class="p">;</span>
<span class="linenos">13</span>   <span class="kt">object</span>      <span class="n">blockMeshDict</span><span class="p">;</span>
<span class="linenos">14</span><span class="p">}</span>
<span class="linenos">15</span><span class="c1">// * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * //</span>
<span class="linenos">16</span>
<span class="linenos">17</span><span class="k">convertToMeters</span> <span class="mi">1</span><span class="p">;</span>
<span class="linenos">18</span><span class="n">xmin</span> <span class="o">-</span><span class="mf">0.05</span><span class="p">;</span>    <span class="c1">//variable definition</span>
<span class="linenos">19</span><span class="n">xmax</span> <span class="mf">0.05</span><span class="p">;</span>
<span class="linenos">20</span><span class="n">ymin</span> <span class="o">-</span><span class="mf">0.015</span><span class="p">;</span>
<span class="linenos">21</span><span class="n">ymax</span> <span class="mf">0.015</span><span class="p">;</span>
<span class="linenos">22</span><span class="n">Lz</span> <span class="mf">0.01</span><span class="p">;</span>
<span class="linenos">23</span><span class="k">vertices</span>    <span class="c1">//vertices definition</span>
<span class="linenos">24</span><span class="p">(</span>
<span class="linenos">25</span>   <span class="p">(</span><span class="k">$</span><span class="n">xmin</span>      <span class="k">$</span><span class="n">ymin</span>   <span class="mi">0</span><span class="p">)</span>  <span class="c1">//coordinate of vertex 0</span>
<span class="linenos">26</span>   <span class="p">(</span><span class="k">$</span><span class="n">xmax</span>    <span class="k">$</span><span class="n">ymin</span>   <span class="mi">0</span><span class="p">)</span>  <span class="c1">//coordinate of vertex 1</span>
<span class="linenos">27</span>   <span class="p">(</span><span class="k">$</span><span class="n">xmax</span>    <span class="k">$</span><span class="n">ymax</span>   <span class="mi">0</span><span class="p">)</span>  <span class="c1">//coordinate of vertex 2</span>
<span class="linenos">28</span>   <span class="p">(</span><span class="k">$</span><span class="n">xmin</span>      <span class="k">$</span><span class="n">ymax</span>   <span class="mi">0</span><span class="p">)</span>  <span class="c1">//coordinate of vertex 3</span>
<span class="linenos">29</span>   <span class="p">(</span><span class="k">$</span><span class="n">xmin</span>      <span class="k">$</span><span class="n">ymin</span>   <span class="k">$</span><span class="n">Lz</span><span class="p">)</span><span class="c1">//coordinate of vertex 4</span>
<span class="linenos">30</span>   <span class="p">(</span><span class="k">$</span><span class="n">xmax</span>    <span class="k">$</span><span class="n">ymin</span>   <span class="k">$</span><span class="n">Lz</span><span class="p">)</span><span class="c1">//coordinate of vertex 5</span>
<span class="linenos">31</span>   <span class="p">(</span><span class="k">$</span><span class="n">xmax</span>    <span class="k">$</span><span class="n">ymax</span>   <span class="k">$</span><span class="n">Lz</span><span class="p">)</span><span class="c1">//coordinate of vertex 6</span>
<span class="linenos">32</span>   <span class="p">(</span><span class="k">$</span><span class="n">xmin</span>      <span class="k">$</span><span class="n">ymax</span>   <span class="k">$</span><span class="n">Lz</span><span class="p">)</span><span class="c1">//coordinate of vertex 7</span>
<span class="linenos">33</span><span class="p">);</span>
<span class="linenos">34</span><span class="k">blocks</span>
<span class="linenos">35</span><span class="p">(</span>
<span class="linenos">36</span>   <span class="k">hex</span> <span class="p">(</span><span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span><span class="p">)</span> <span class="p">(</span><span class="mi">10</span> <span class="mi">3</span> <span class="mi">1</span><span class="p">)</span> <span class="k">simpleGrading</span> <span class="p">(</span><span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span><span class="p">)</span>
<span class="linenos">37</span><span class="p">);</span>
<span class="linenos">38</span><span class="k">boundary</span>
<span class="linenos">39</span><span class="p">(</span>
<span class="linenos">40</span>   <span class="n">left</span>    <span class="c1">//patch name</span>
<span class="linenos">41</span>   <span class="p">{</span>
<span class="linenos">42</span>      <span class="kt">type</span> <span class="n">patch</span> <span class="p">;</span>
<span class="linenos">43</span>      <span class="k">faces</span>   <span class="c1">//face list</span>
<span class="linenos">44</span>      <span class="p">(</span>
<span class="linenos">45</span>            <span class="p">(</span><span class="mi">0</span> <span class="mi">4</span> <span class="mi">7</span> <span class="mi">3</span><span class="p">)</span>
<span class="linenos">46</span>      <span class="p">);</span>
<span class="linenos">47</span>   <span class="p">}</span>
<span class="linenos">48</span>   <span class="n">right</span>
<span class="linenos">49</span>   <span class="p">{</span>
<span class="linenos">50</span>      <span class="kt">type</span> <span class="n">patch</span><span class="p">;</span>
<span class="linenos">51</span>      <span class="k">faces</span>
<span class="linenos">52</span>      <span class="p">(</span>
<span class="linenos">53</span>            <span class="p">(</span><span class="mi">2</span> <span class="mi">6</span> <span class="mi">5</span> <span class="mi">1</span><span class="p">)</span>
<span class="linenos">54</span>      <span class="p">);</span>
<span class="linenos">55</span>   <span class="p">}</span>
<span class="linenos">56</span>   <span class="n">top</span>
<span class="linenos">57</span>   <span class="p">{</span>
<span class="linenos">58</span>      <span class="kt">type</span> <span class="n">patch</span><span class="p">;</span>
<span class="linenos">59</span>      <span class="k">faces</span>
<span class="linenos">60</span>      <span class="p">(</span>
<span class="linenos">61</span>            <span class="p">(</span><span class="mi">3</span> <span class="mi">7</span> <span class="mi">6</span> <span class="mi">2</span><span class="p">)</span>
<span class="linenos">62</span>      <span class="p">);</span>
<span class="linenos">63</span>   <span class="p">}</span>
<span class="linenos">64</span>   <span class="n">bottom</span>
<span class="linenos">65</span>   <span class="p">{</span>
<span class="linenos">66</span>      <span class="kt">type</span> <span class="n">patch</span><span class="p">;</span>
<span class="linenos">67</span>      <span class="k">faces</span>
<span class="linenos">68</span>      <span class="p">(</span>
<span class="linenos">69</span>            <span class="p">(</span><span class="mi">1</span> <span class="mi">5</span> <span class="mi">4</span> <span class="mi">0</span><span class="p">)</span>
<span class="linenos">70</span>      <span class="p">);</span>
<span class="linenos">71</span>   <span class="p">}</span>
<span class="linenos">72</span>   <span class="n">frontAndBack</span>    <span class="c1">//patch name</span>
<span class="linenos">73</span>   <span class="p">{</span>
<span class="linenos">74</span>      <span class="kt">type</span> <span class="n">empty</span><span class="p">;</span>
<span class="linenos">75</span>      <span class="k">faces</span> <span class="c1">//face list</span>
<span class="linenos">76</span>      <span class="p">(</span>
<span class="linenos">77</span>            <span class="p">(</span><span class="mi">0</span> <span class="mi">3</span> <span class="mi">2</span> <span class="mi">1</span><span class="p">)</span>   <span class="c1">//back face</span>
<span class="linenos">78</span>            <span class="p">(</span><span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span><span class="p">)</span>   <span class="c1">//front face</span>
<span class="linenos">79</span>      <span class="p">);</span>
<span class="linenos">80</span>   <span class="p">}</span>
<span class="linenos">81</span><span class="p">);</span>
<span class="linenos">82</span><span class="c1">// ************************************************************************* //</span>
</pre></div>
</div>
</div>
</div>
</div>
<p>Ok, let’s exploring the main steps of the <code class="code docutils literal notranslate"><span class="pre">laplacianFoam</span></code>.
Please download (<a class="reference download internal" download="" href="../../_downloads/5cadc0ff36497aaf1c4155bb17c6dc5e/test_laplacianFoam.zip"><code class="xref download docutils literal notranslate"><span class="pre">test_laplacianFoam</span></code></a>) and do the following practice/debug steps in <code class="code docutils literal notranslate"><span class="pre">test_laplacianFoam.C</span></code>.</p>
</section>
<section id="step-1-read-mesh-and-input-field">
<h3>Step 1, Read mesh and input field<a class="headerlink" href="#step-1-read-mesh-and-input-field" title="Permalink to this headline"></a></h3>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--6-input--1" name="tab-set--6" type="radio"><label class="tab-label" for="tab-set--6-input--1">Read data</label><div class="tab-content docutils container">
<p>The basic properties of cells and faces, e.g. area, volume, face normal vector, will be evaluated after mesh reading, all these processes are happened in the mesh object.
It means that after calling <code class="code docutils literal notranslate"><span class="pre">creatFields.H</span></code> all these properties are evaluated and stored in the <code class="code docutils literal notranslate"><span class="pre">mesh</span></code> object. Of course the temperature field object <code class="code docutils literal notranslate"><span class="pre">T</span></code> (volScalarField) with BCs and ICs, and thermal diffusivity <code class="code docutils literal notranslate"><span class="pre">DT</span></code> are also initialized from input data after calling <code class="code docutils literal notranslate"><span class="pre">creatFields.H</span></code>.
<strong>It should be noted</strong> that the part of Laplacian discretization coefficients are also calculated in this step. If the mesh is not changed during simulation time, the mesh related coefficients just need to be calculated one time.</p>
<table class="docutils align-default" id="id4">
<caption><span class="caption-number">Table 2 </span><span class="caption-text">Mesh- and Field-related coefficients</span><a class="headerlink" href="#id4" title="Permalink to this table"></a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Object</p></td>
<td><p>Equation</p></td>
<td><p>Code</p></td>
<td><p>Faces</p></td>
<td><p>Reference</p></td>
</tr>
<tr class="row-even"><td><p><code class="code docutils literal notranslate"><span class="pre">mesh</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(1/\delta_{C\leftrightarrow F}\)</span></p></td>
<td><p><code class="code docutils literal notranslate"><span class="pre">mesh.deltaCoeffs()</span></code></p></td>
<td><p>All faces</p></td>
<td><p><a class="reference internal" href="#equation-eq-fvm-matrix-form-internalcell">equation (37)</a>, <a class="reference internal" href="#equation-eq-fvm-laplacian-coeff-boundary-fixedvalue">equation (44)</a>, <a class="reference internal" href="#equation-eq-fvm-laplacian-coeff-boundary-fixedflux">equation (46)</a></p></td>
</tr>
<tr class="row-odd"><td><p><code class="code docutils literal notranslate"><span class="pre">T</span></code></p></td>
<td><p>Dependents on BCs type</p></td>
<td><p><code class="code docutils literal notranslate"><span class="pre">gradientInternalCoeffs</span></code> (diagonal), <code class="code docutils literal notranslate"><span class="pre">gradientBoundaryCoeffs</span></code> (source)</p></td>
<td><p>Boundary patch/faces</p></td>
<td><p><a class="reference internal" href="#equation-eq-fvm-laplacian-coeff-boundary-fixedvalue">equation (44)</a>, <a class="reference internal" href="#equation-eq-fvm-laplacian-coeff-boundary-fixedflux">equation (46)</a></p></td>
</tr>
</tbody>
</table>
</div>
<input class="tab-input" id="tab-set--6-input--2" name="tab-set--6" type="radio"><label class="tab-label" for="tab-set--6-input--2">Access mesh and field properties</label><div class="tab-content docutils container">
<div class="literal-block-wrapper docutils container" id="lst-access-mesh">
<div class="code-block-caption"><span class="caption-number">Listing 25 </span><span class="caption-text">Access mesh properties and field boundary properties</span><a class="headerlink" href="#lst-access-mesh" title="Permalink to this code"></a></div>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1">// (1). read data</span>
<span class="linenos"> 2</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;createMesh.H&quot;</span><span class="cp"></span>
<span class="linenos"> 3</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;createFields.H&quot;</span><span class="cp"></span>
<span class="linenos"> 4</span><span class="c1">// 1.1 access internal faces</span>
<span class="linenos"> 5</span><span class="n">Info</span><span class="o">&lt;&lt;</span><span class="s">&quot;</span><span class="se">\n\n</span><span class="s">Access internal mesh&quot;</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="linenos"> 6</span><span class="n">surfaceVectorField</span><span class="w"> </span><span class="n">Cf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mesh</span><span class="p">.</span><span class="n">Cf</span><span class="p">();</span><span class="w"></span>
<span class="linenos"> 7</span><span class="n">surfaceVectorField</span><span class="w"> </span><span class="n">Sf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mesh</span><span class="p">.</span><span class="n">Sf</span><span class="p">();</span><span class="w"></span>
<span class="linenos"> 8</span><span class="n">surfaceScalarField</span><span class="w"> </span><span class="n">S</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mesh</span><span class="p">.</span><span class="n">magSf</span><span class="p">();</span><span class="w"></span>
<span class="linenos"> 9</span><span class="n">forAll</span><span class="p">(</span><span class="n">Cf</span><span class="p">,</span><span class="w"> </span><span class="n">iface</span><span class="p">)</span><span class="w"></span>
<span class="linenos">10</span><span class="p">{</span><span class="w"></span>
<span class="linenos">11</span><span class="w">   </span><span class="n">Info</span><span class="o">&lt;&lt;</span><span class="n">iface</span><span class="o">&lt;&lt;</span><span class="s">&quot;: face center &quot;</span><span class="o">&lt;&lt;</span><span class="n">Cf</span><span class="p">[</span><span class="n">iface</span><span class="p">]</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="linenos">12</span><span class="w">   </span><span class="n">Info</span><span class="o">&lt;&lt;</span><span class="n">iface</span><span class="o">&lt;&lt;</span><span class="s">&quot;: face area vector &quot;</span><span class="o">&lt;&lt;</span><span class="n">Sf</span><span class="p">[</span><span class="n">iface</span><span class="p">]</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="linenos">13</span><span class="w">   </span><span class="n">Info</span><span class="o">&lt;&lt;</span><span class="n">iface</span><span class="o">&lt;&lt;</span><span class="s">&quot;: face area &quot;</span><span class="o">&lt;&lt;</span><span class="n">S</span><span class="p">[</span><span class="n">iface</span><span class="p">]</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="linenos">14</span><span class="w">   </span><span class="n">Info</span><span class="o">&lt;&lt;</span><span class="n">iface</span><span class="o">&lt;&lt;</span><span class="s">&quot;: face delta coeff &quot;</span><span class="o">&lt;&lt;</span><span class="n">mesh</span><span class="p">.</span><span class="n">deltaCoeffs</span><span class="p">()[</span><span class="n">iface</span><span class="p">]</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="linenos">15</span><span class="w">   </span><span class="n">Info</span><span class="o">&lt;&lt;</span><span class="n">iface</span><span class="o">&lt;&lt;</span><span class="s">&quot;: coeff(D*magSf*deltacoeff) &quot;</span><span class="o">&lt;&lt;</span><span class="n">mesh</span><span class="p">.</span><span class="n">deltaCoeffs</span><span class="p">()[</span><span class="n">iface</span><span class="p">]</span><span class="o">*</span><span class="n">DT</span><span class="o">*</span><span class="n">S</span><span class="p">[</span><span class="n">iface</span><span class="p">]</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="linenos">16</span><span class="p">}</span><span class="w"></span>
<span class="linenos">17</span><span class="c1">// 1.2. access boundary mesh</span>
<span class="linenos">18</span><span class="n">Info</span><span class="o">&lt;&lt;</span><span class="s">&quot;</span><span class="se">\n\n</span><span class="s">Access boundary mesh&quot;</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="linenos">19</span><span class="k">const</span><span class="w"> </span><span class="n">fvBoundaryMesh</span><span class="o">&amp;</span><span class="w"> </span><span class="n">boundaryMesh</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mesh</span><span class="p">.</span><span class="n">boundary</span><span class="p">();</span><span class="w"></span>
<span class="linenos">20</span><span class="n">forAll</span><span class="p">(</span><span class="n">boundaryMesh</span><span class="p">,</span><span class="w"> </span><span class="n">patchI</span><span class="p">)</span><span class="w"></span>
<span class="linenos">21</span><span class="p">{</span><span class="w"></span>
<span class="linenos">22</span><span class="w">   </span><span class="k">const</span><span class="w"> </span><span class="n">fvPatch</span><span class="o">&amp;</span><span class="w"> </span><span class="n">patch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">boundaryMesh</span><span class="p">[</span><span class="n">patchI</span><span class="p">];</span><span class="w"></span>
<span class="linenos">23</span><span class="w">   </span><span class="n">forAll</span><span class="p">(</span><span class="n">patch</span><span class="p">,</span><span class="w"> </span><span class="n">faceI</span><span class="p">)</span><span class="w"></span>
<span class="linenos">24</span><span class="w">   </span><span class="p">{</span><span class="w"></span>
<span class="linenos">25</span><span class="w">      </span><span class="n">Info</span><span class="o">&lt;&lt;</span><span class="s">&quot;Patch &quot;</span><span class="o">&lt;&lt;</span><span class="n">patch</span><span class="p">.</span><span class="n">name</span><span class="p">()</span><span class="o">&lt;&lt;</span><span class="s">&quot; face &quot;</span><span class="o">&lt;&lt;</span><span class="n">faceI</span><span class="o">&lt;&lt;</span><span class="s">&quot;: face center &quot;</span><span class="o">&lt;&lt;</span><span class="n">patch</span><span class="p">.</span><span class="n">Cf</span><span class="p">()[</span><span class="n">faceI</span><span class="p">]</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="linenos">26</span><span class="w">      </span><span class="n">Info</span><span class="o">&lt;&lt;</span><span class="s">&quot;Patch &quot;</span><span class="o">&lt;&lt;</span><span class="n">patch</span><span class="p">.</span><span class="n">name</span><span class="p">()</span><span class="o">&lt;&lt;</span><span class="s">&quot; face &quot;</span><span class="o">&lt;&lt;</span><span class="n">faceI</span><span class="o">&lt;&lt;</span><span class="s">&quot;: face area vector &quot;</span><span class="o">&lt;&lt;</span><span class="n">patch</span><span class="p">.</span><span class="n">Sf</span><span class="p">()[</span><span class="n">faceI</span><span class="p">]</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="linenos">27</span><span class="w">      </span><span class="n">Info</span><span class="o">&lt;&lt;</span><span class="s">&quot;Patch &quot;</span><span class="o">&lt;&lt;</span><span class="n">patch</span><span class="p">.</span><span class="n">name</span><span class="p">()</span><span class="o">&lt;&lt;</span><span class="s">&quot; face &quot;</span><span class="o">&lt;&lt;</span><span class="n">faceI</span><span class="o">&lt;&lt;</span><span class="s">&quot;: face area &quot;</span><span class="o">&lt;&lt;</span><span class="n">patch</span><span class="p">.</span><span class="n">magSf</span><span class="p">()[</span><span class="n">faceI</span><span class="p">]</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="linenos">28</span><span class="w">      </span><span class="n">Info</span><span class="o">&lt;&lt;</span><span class="s">&quot;Patch &quot;</span><span class="o">&lt;&lt;</span><span class="n">patch</span><span class="p">.</span><span class="n">name</span><span class="p">()</span><span class="o">&lt;&lt;</span><span class="s">&quot; face &quot;</span><span class="o">&lt;&lt;</span><span class="n">faceI</span><span class="o">&lt;&lt;</span><span class="s">&quot;: face delta coeff &quot;</span><span class="o">&lt;&lt;</span><span class="n">patch</span><span class="p">.</span><span class="n">deltaCoeffs</span><span class="p">()[</span><span class="n">faceI</span><span class="p">]</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="linenos">29</span><span class="w">      </span><span class="n">Info</span><span class="o">&lt;&lt;</span><span class="s">&quot;Patch &quot;</span><span class="o">&lt;&lt;</span><span class="n">patch</span><span class="p">.</span><span class="n">name</span><span class="p">()</span><span class="o">&lt;&lt;</span><span class="s">&quot; face &quot;</span><span class="o">&lt;&lt;</span><span class="n">faceI</span><span class="o">&lt;&lt;</span><span class="s">&quot;: owner cell &quot;</span><span class="o">&lt;&lt;</span><span class="n">patch</span><span class="p">.</span><span class="n">faceCells</span><span class="p">()[</span><span class="n">faceI</span><span class="p">]</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="linenos">30</span><span class="w">   </span><span class="p">}</span><span class="w"></span>
<span class="linenos">31</span><span class="p">}</span><span class="w"></span>
<span class="linenos">32</span><span class="c1">// 1.3. access boundary field, boundary field coefficients,</span>
<span class="linenos">33</span><span class="n">forAll</span><span class="p">(</span><span class="n">T</span><span class="p">.</span><span class="n">boundaryField</span><span class="p">(),</span><span class="w"> </span><span class="n">patchI</span><span class="p">)</span><span class="w"></span>
<span class="linenos">34</span><span class="p">{</span><span class="w"></span>
<span class="linenos">35</span><span class="w">   </span><span class="n">Info</span><span class="o">&lt;&lt;</span><span class="s">&quot;Boundary patch: &quot;</span><span class="o">&lt;&lt;</span><span class="n">mesh</span><span class="p">.</span><span class="n">boundary</span><span class="p">()[</span><span class="n">patchI</span><span class="p">].</span><span class="n">name</span><span class="p">()</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="linenos">36</span><span class="w">   </span><span class="n">Info</span><span class="o">&lt;&lt;</span><span class="s">&quot;Is coupled ? &quot;</span><span class="o">&lt;&lt;</span><span class="n">mesh</span><span class="p">.</span><span class="n">boundary</span><span class="p">()[</span><span class="n">patchI</span><span class="p">].</span><span class="n">coupled</span><span class="p">()</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="linenos">37</span><span class="w">   </span><span class="n">Info</span><span class="o">&lt;&lt;</span><span class="s">&quot;gradientInternalCoeffs of field T &quot;</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="linenos">38</span><span class="w">   </span><span class="n">Info</span><span class="o">&lt;&lt;</span><span class="n">T</span><span class="p">.</span><span class="n">boundaryField</span><span class="p">()[</span><span class="n">patchI</span><span class="p">].</span><span class="n">gradientInternalCoeffs</span><span class="p">()</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span><span class="w"> </span><span class="c1">//Diagonal coeff [A]</span>
<span class="linenos">39</span><span class="w">   </span><span class="n">Info</span><span class="o">&lt;&lt;</span><span class="s">&quot;gradientBoundaryCoeffs of field T &quot;</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="linenos">40</span><span class="w">   </span><span class="n">Info</span><span class="o">&lt;&lt;</span><span class="n">T</span><span class="p">.</span><span class="n">boundaryField</span><span class="p">()[</span><span class="n">patchI</span><span class="p">].</span><span class="n">gradientBoundaryCoeffs</span><span class="p">()</span><span class="o">&lt;&lt;</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span><span class="w"> </span><span class="c1">//source coeff, [B]</span>
<span class="linenos">41</span><span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<input class="tab-input" id="tab-set--6-input--3" name="tab-set--6" type="radio"><label class="tab-label" for="tab-set--6-input--3">Internal mesh</label><div class="tab-content docutils container">
<div class="literal-block-wrapper docutils container" id="lst-log-internalmesh">
<div class="code-block-caption"><span class="caption-number">Listing 26 </span><span class="caption-text">Internal mesh properties of the regular mesh shown in <a class="reference internal" href="#fig-polymesh-regularbox"><span class="std std-numref">Fig. 34</span></a>.</span><a class="headerlink" href="#lst-log-internalmesh" title="Permalink to this code"></a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="linenos">  1</span><span class="m">46</span>: coeff<span class="o">(</span>D*magSf*deltacoeff<span class="o">)</span> <span class="o">((</span><span class="m">100</span>*DT<span class="o">)</span>*0.0001<span class="o">)</span> <span class="o">[</span><span class="m">0</span> <span class="m">2</span> -1 <span class="m">0</span> <span class="m">0</span> <span class="m">0</span> <span class="m">0</span><span class="o">]</span> 4e-07Access internal mesh
<span class="linenos">  2</span><span class="m">0</span>: face center <span class="o">(</span>-0.04 -0.01 <span class="m">0</span>.005<span class="o">)</span>
<span class="linenos">  3</span><span class="m">0</span>: face area vector <span class="o">(</span><span class="m">0</span>.0001 <span class="m">0</span> <span class="m">0</span><span class="o">)</span>
<span class="linenos">  4</span><span class="m">0</span>: face area <span class="m">0</span>.0001
<span class="linenos">  5</span><span class="m">0</span>: face delta coeff <span class="m">100</span>
<span class="linenos">  6</span><span class="m">0</span>: coeff<span class="o">(</span>D*magSf*deltacoeff<span class="o">)</span> <span class="o">((</span><span class="m">100</span>*DT<span class="o">)</span>*0.0001<span class="o">)</span> <span class="o">[</span><span class="m">0</span> <span class="m">2</span> -1 <span class="m">0</span> <span class="m">0</span> <span class="m">0</span> <span class="m">0</span><span class="o">]</span> 4e-07
<span class="linenos">  7</span><span class="m">1</span>: face center <span class="o">(</span>-0.045 -0.005 <span class="m">0</span>.005<span class="o">)</span>
<span class="linenos">  8</span><span class="m">1</span>: face area vector <span class="o">(</span><span class="m">0</span> <span class="m">0</span>.0001 <span class="m">0</span><span class="o">)</span>
<span class="linenos">  9</span><span class="m">1</span>: face area <span class="m">0</span>.0001
<span class="linenos"> 10</span><span class="m">1</span>: face delta coeff <span class="m">100</span>
<span class="linenos"> 11</span><span class="m">1</span>: coeff<span class="o">(</span>D*magSf*deltacoeff<span class="o">)</span> <span class="o">((</span><span class="m">100</span>*DT<span class="o">)</span>*0.0001<span class="o">)</span> <span class="o">[</span><span class="m">0</span> <span class="m">2</span> -1 <span class="m">0</span> <span class="m">0</span> <span class="m">0</span> <span class="m">0</span><span class="o">]</span> 4e-07
<span class="linenos"> 12</span><span class="m">2</span>: face center <span class="o">(</span>-0.03 -0.01 <span class="m">0</span>.005<span class="o">)</span>
<span class="linenos"> 13</span><span class="m">2</span>: face area vector <span class="o">(</span><span class="m">0</span>.0001 <span class="m">0</span> <span class="m">0</span><span class="o">)</span>
<span class="linenos"> 14</span><span class="m">2</span>: face area <span class="m">0</span>.0001
<span class="linenos"> 15</span><span class="m">2</span>: face delta coeff <span class="m">100</span>
<span class="linenos"> 16</span><span class="m">2</span>: coeff<span class="o">(</span>D*magSf*deltacoeff<span class="o">)</span> <span class="o">((</span><span class="m">100</span>*DT<span class="o">)</span>*0.0001<span class="o">)</span> <span class="o">[</span><span class="m">0</span> <span class="m">2</span> -1 <span class="m">0</span> <span class="m">0</span> <span class="m">0</span> <span class="m">0</span><span class="o">]</span> 4e-07
<span class="linenos"> 17</span><span class="m">3</span>: face center <span class="o">(</span>-0.035 -0.005 <span class="m">0</span>.005<span class="o">)</span>
<span class="linenos"> 18</span><span class="m">3</span>: face area vector <span class="o">(</span><span class="m">0</span> <span class="m">0</span>.0001 <span class="m">0</span><span class="o">)</span>
<span class="linenos"> 19</span><span class="m">3</span>: face area <span class="m">0</span>.0001
<span class="linenos"> 20</span><span class="m">3</span>: face delta coeff <span class="m">100</span>
<span class="linenos"> 21</span><span class="m">3</span>: coeff<span class="o">(</span>D*magSf*deltacoeff<span class="o">)</span> <span class="o">((</span><span class="m">100</span>*DT<span class="o">)</span>*0.0001<span class="o">)</span> <span class="o">[</span><span class="m">0</span> <span class="m">2</span> -1 <span class="m">0</span> <span class="m">0</span> <span class="m">0</span> <span class="m">0</span><span class="o">]</span> 4e-07
<span class="linenos"> 22</span><span class="m">4</span>: face center <span class="o">(</span>-0.02 -0.01 <span class="m">0</span>.005<span class="o">)</span>
<span class="linenos"> 23</span><span class="m">4</span>: face area vector <span class="o">(</span><span class="m">0</span>.0001 <span class="m">0</span> <span class="m">0</span><span class="o">)</span>
<span class="linenos"> 24</span><span class="m">4</span>: face area <span class="m">0</span>.0001
<span class="linenos"> 25</span><span class="m">4</span>: face delta coeff <span class="m">100</span>
<span class="linenos"> 26</span><span class="m">4</span>: coeff<span class="o">(</span>D*magSf*deltacoeff<span class="o">)</span> <span class="o">((</span><span class="m">100</span>*DT<span class="o">)</span>*0.0001<span class="o">)</span> <span class="o">[</span><span class="m">0</span> <span class="m">2</span> -1 <span class="m">0</span> <span class="m">0</span> <span class="m">0</span> <span class="m">0</span><span class="o">]</span> 4e-07
<span class="linenos"> 27</span><span class="m">5</span>: face center <span class="o">(</span>-0.025 -0.005 <span class="m">0</span>.005<span class="o">)</span>
<span class="linenos"> 28</span><span class="m">5</span>: face area vector <span class="o">(</span><span class="m">0</span> <span class="m">0</span>.0001 <span class="m">0</span><span class="o">)</span>
<span class="linenos"> 29</span><span class="m">5</span>: face area <span class="m">0</span>.0001
<span class="linenos"> 30</span><span class="m">5</span>: face delta coeff <span class="m">100</span>
<span class="linenos"> 31</span><span class="m">5</span>: coeff<span class="o">(</span>D*magSf*deltacoeff<span class="o">)</span> <span class="o">((</span><span class="m">100</span>*DT<span class="o">)</span>*0.0001<span class="o">)</span> <span class="o">[</span><span class="m">0</span> <span class="m">2</span> -1 <span class="m">0</span> <span class="m">0</span> <span class="m">0</span> <span class="m">0</span><span class="o">]</span> 4e-07
<span class="linenos"> 32</span><span class="m">6</span>: face center <span class="o">(</span>-0.01 -0.01 <span class="m">0</span>.005<span class="o">)</span>
<span class="linenos"> 33</span><span class="m">6</span>: face area vector <span class="o">(</span><span class="m">0</span>.0001 <span class="m">0</span> <span class="m">0</span><span class="o">)</span>
<span class="linenos"> 34</span><span class="m">6</span>: face area <span class="m">0</span>.0001
<span class="linenos"> 35</span><span class="m">6</span>: face delta coeff <span class="m">100</span>
<span class="linenos"> 36</span><span class="m">6</span>: coeff<span class="o">(</span>D*magSf*deltacoeff<span class="o">)</span> <span class="o">((</span><span class="m">100</span>*DT<span class="o">)</span>*0.0001<span class="o">)</span> <span class="o">[</span><span class="m">0</span> <span class="m">2</span> -1 <span class="m">0</span> <span class="m">0</span> <span class="m">0</span> <span class="m">0</span><span class="o">]</span> 4e-07
<span class="linenos"> 37</span><span class="m">7</span>: face center <span class="o">(</span>-0.015 -0.005 <span class="m">0</span>.005<span class="o">)</span>
<span class="linenos"> 38</span><span class="m">7</span>: face area vector <span class="o">(</span><span class="m">0</span> <span class="m">0</span>.0001 <span class="m">0</span><span class="o">)</span>
<span class="linenos"> 39</span><span class="m">7</span>: face area <span class="m">0</span>.0001
<span class="linenos"> 40</span><span class="m">7</span>: face delta coeff <span class="m">100</span>
<span class="linenos"> 41</span><span class="m">7</span>: coeff<span class="o">(</span>D*magSf*deltacoeff<span class="o">)</span> <span class="o">((</span><span class="m">100</span>*DT<span class="o">)</span>*0.0001<span class="o">)</span> <span class="o">[</span><span class="m">0</span> <span class="m">2</span> -1 <span class="m">0</span> <span class="m">0</span> <span class="m">0</span> <span class="m">0</span><span class="o">]</span> 4e-07
<span class="linenos"> 42</span><span class="m">8</span>: face center <span class="o">(</span><span class="m">0</span> -0.01 <span class="m">0</span>.005<span class="o">)</span>
<span class="linenos"> 43</span><span class="m">8</span>: face area vector <span class="o">(</span><span class="m">0</span>.0001 <span class="m">0</span> <span class="m">0</span><span class="o">)</span>
<span class="linenos"> 44</span><span class="m">8</span>: face area <span class="m">0</span>.0001
<span class="linenos"> 45</span><span class="m">8</span>: face delta coeff <span class="m">100</span>
<span class="linenos"> 46</span><span class="m">8</span>: coeff<span class="o">(</span>D*magSf*deltacoeff<span class="o">)</span> <span class="o">((</span><span class="m">100</span>*DT<span class="o">)</span>*0.0001<span class="o">)</span> <span class="o">[</span><span class="m">0</span> <span class="m">2</span> -1 <span class="m">0</span> <span class="m">0</span> <span class="m">0</span> <span class="m">0</span><span class="o">]</span> 4e-07
<span class="linenos"> 47</span><span class="m">9</span>: face center <span class="o">(</span>-0.005 -0.005 <span class="m">0</span>.005<span class="o">)</span>
<span class="linenos"> 48</span><span class="m">9</span>: face area vector <span class="o">(</span><span class="m">0</span> <span class="m">0</span>.0001 <span class="m">0</span><span class="o">)</span>
<span class="linenos"> 49</span><span class="m">9</span>: face area <span class="m">0</span>.0001
<span class="linenos"> 50</span><span class="m">9</span>: face delta coeff <span class="m">100</span>
<span class="linenos"> 51</span><span class="m">9</span>: coeff<span class="o">(</span>D*magSf*deltacoeff<span class="o">)</span> <span class="o">((</span><span class="m">100</span>*DT<span class="o">)</span>*0.0001<span class="o">)</span> <span class="o">[</span><span class="m">0</span> <span class="m">2</span> -1 <span class="m">0</span> <span class="m">0</span> <span class="m">0</span> <span class="m">0</span><span class="o">]</span> 4e-07
<span class="linenos"> 52</span><span class="m">10</span>: face center <span class="o">(</span><span class="m">0</span>.01 -0.01 <span class="m">0</span>.005<span class="o">)</span>
<span class="linenos"> 53</span><span class="m">10</span>: face area vector <span class="o">(</span><span class="m">0</span>.0001 <span class="m">0</span> <span class="m">0</span><span class="o">)</span>
<span class="linenos"> 54</span><span class="m">10</span>: face area <span class="m">0</span>.0001
<span class="linenos"> 55</span><span class="m">10</span>: face delta coeff <span class="m">100</span>
<span class="linenos"> 56</span><span class="m">10</span>: coeff<span class="o">(</span>D*magSf*deltacoeff<span class="o">)</span> <span class="o">((</span><span class="m">100</span>*DT<span class="o">)</span>*0.0001<span class="o">)</span> <span class="o">[</span><span class="m">0</span> <span class="m">2</span> -1 <span class="m">0</span> <span class="m">0</span> <span class="m">0</span> <span class="m">0</span><span class="o">]</span> 4e-07
<span class="linenos"> 57</span><span class="m">11</span>: face center <span class="o">(</span><span class="m">0</span>.005 -0.005 <span class="m">0</span>.005<span class="o">)</span>
<span class="linenos"> 58</span><span class="m">11</span>: face area vector <span class="o">(</span><span class="m">0</span> <span class="m">0</span>.0001 <span class="m">0</span><span class="o">)</span>
<span class="linenos"> 59</span><span class="m">11</span>: face area <span class="m">0</span>.0001
<span class="linenos"> 60</span><span class="m">11</span>: face delta coeff <span class="m">100</span>
<span class="linenos"> 61</span><span class="m">11</span>: coeff<span class="o">(</span>D*magSf*deltacoeff<span class="o">)</span> <span class="o">((</span><span class="m">100</span>*DT<span class="o">)</span>*0.0001<span class="o">)</span> <span class="o">[</span><span class="m">0</span> <span class="m">2</span> -1 <span class="m">0</span> <span class="m">0</span> <span class="m">0</span> <span class="m">0</span><span class="o">]</span> 4e-07
<span class="linenos"> 62</span><span class="m">12</span>: face center <span class="o">(</span><span class="m">0</span>.02 -0.01 <span class="m">0</span>.005<span class="o">)</span>
<span class="linenos"> 63</span><span class="m">12</span>: face area vector <span class="o">(</span><span class="m">0</span>.0001 <span class="m">0</span> <span class="m">0</span><span class="o">)</span>
<span class="linenos"> 64</span><span class="m">12</span>: face area <span class="m">0</span>.0001
<span class="linenos"> 65</span><span class="m">12</span>: face delta coeff <span class="m">100</span>
<span class="linenos"> 66</span><span class="m">12</span>: coeff<span class="o">(</span>D*magSf*deltacoeff<span class="o">)</span> <span class="o">((</span><span class="m">100</span>*DT<span class="o">)</span>*0.0001<span class="o">)</span> <span class="o">[</span><span class="m">0</span> <span class="m">2</span> -1 <span class="m">0</span> <span class="m">0</span> <span class="m">0</span> <span class="m">0</span><span class="o">]</span> 4e-07
<span class="linenos"> 67</span><span class="m">13</span>: face center <span class="o">(</span><span class="m">0</span>.015 -0.005 <span class="m">0</span>.005<span class="o">)</span>
<span class="linenos"> 68</span><span class="m">13</span>: face area vector <span class="o">(</span><span class="m">0</span> <span class="m">0</span>.0001 <span class="m">0</span><span class="o">)</span>
<span class="linenos"> 69</span><span class="m">13</span>: face area <span class="m">0</span>.0001
<span class="linenos"> 70</span><span class="m">13</span>: face delta coeff <span class="m">100</span>
<span class="linenos"> 71</span><span class="m">13</span>: coeff<span class="o">(</span>D*magSf*deltacoeff<span class="o">)</span> <span class="o">((</span><span class="m">100</span>*DT<span class="o">)</span>*0.0001<span class="o">)</span> <span class="o">[</span><span class="m">0</span> <span class="m">2</span> -1 <span class="m">0</span> <span class="m">0</span> <span class="m">0</span> <span class="m">0</span><span class="o">]</span> 4e-07
<span class="linenos"> 72</span><span class="m">14</span>: face center <span class="o">(</span><span class="m">0</span>.03 -0.01 <span class="m">0</span>.005<span class="o">)</span>
<span class="linenos"> 73</span><span class="m">14</span>: face area vector <span class="o">(</span><span class="m">0</span>.0001 <span class="m">0</span> <span class="m">0</span><span class="o">)</span>
<span class="linenos"> 74</span><span class="m">14</span>: face area <span class="m">0</span>.0001
<span class="linenos"> 75</span><span class="m">14</span>: face delta coeff <span class="m">100</span>
<span class="linenos"> 76</span><span class="m">14</span>: coeff<span class="o">(</span>D*magSf*deltacoeff<span class="o">)</span> <span class="o">((</span><span class="m">100</span>*DT<span class="o">)</span>*0.0001<span class="o">)</span> <span class="o">[</span><span class="m">0</span> <span class="m">2</span> -1 <span class="m">0</span> <span class="m">0</span> <span class="m">0</span> <span class="m">0</span><span class="o">]</span> 4e-07
<span class="linenos"> 77</span><span class="m">15</span>: face center <span class="o">(</span><span class="m">0</span>.025 -0.005 <span class="m">0</span>.005<span class="o">)</span>
<span class="linenos"> 78</span><span class="m">15</span>: face area vector <span class="o">(</span><span class="m">0</span> <span class="m">0</span>.0001 <span class="m">0</span><span class="o">)</span>
<span class="linenos"> 79</span><span class="m">15</span>: face area <span class="m">0</span>.0001
<span class="linenos"> 80</span><span class="m">15</span>: face delta coeff <span class="m">100</span>
<span class="linenos"> 81</span><span class="m">15</span>: coeff<span class="o">(</span>D*magSf*deltacoeff<span class="o">)</span> <span class="o">((</span><span class="m">100</span>*DT<span class="o">)</span>*0.0001<span class="o">)</span> <span class="o">[</span><span class="m">0</span> <span class="m">2</span> -1 <span class="m">0</span> <span class="m">0</span> <span class="m">0</span> <span class="m">0</span><span class="o">]</span> 4e-07
<span class="linenos"> 82</span><span class="m">16</span>: face center <span class="o">(</span><span class="m">0</span>.04 -0.01 <span class="m">0</span>.005<span class="o">)</span>
<span class="linenos"> 83</span><span class="m">16</span>: face area vector <span class="o">(</span><span class="m">0</span>.0001 <span class="m">0</span> <span class="m">0</span><span class="o">)</span>
<span class="linenos"> 84</span><span class="m">16</span>: face area <span class="m">0</span>.0001
<span class="linenos"> 85</span><span class="m">16</span>: face delta coeff <span class="m">100</span>
<span class="linenos"> 86</span><span class="m">16</span>: coeff<span class="o">(</span>D*magSf*deltacoeff<span class="o">)</span> <span class="o">((</span><span class="m">100</span>*DT<span class="o">)</span>*0.0001<span class="o">)</span> <span class="o">[</span><span class="m">0</span> <span class="m">2</span> -1 <span class="m">0</span> <span class="m">0</span> <span class="m">0</span> <span class="m">0</span><span class="o">]</span> 4e-07
<span class="linenos"> 87</span><span class="m">17</span>: face center <span class="o">(</span><span class="m">0</span>.035 -0.005 <span class="m">0</span>.005<span class="o">)</span>
<span class="linenos"> 88</span><span class="m">17</span>: face area vector <span class="o">(</span><span class="m">0</span> <span class="m">0</span>.0001 <span class="m">0</span><span class="o">)</span>
<span class="linenos"> 89</span><span class="m">17</span>: face area <span class="m">0</span>.0001
<span class="linenos"> 90</span><span class="m">17</span>: face delta coeff <span class="m">100</span>
<span class="linenos"> 91</span><span class="m">17</span>: coeff<span class="o">(</span>D*magSf*deltacoeff<span class="o">)</span> <span class="o">((</span><span class="m">100</span>*DT<span class="o">)</span>*0.0001<span class="o">)</span> <span class="o">[</span><span class="m">0</span> <span class="m">2</span> -1 <span class="m">0</span> <span class="m">0</span> <span class="m">0</span> <span class="m">0</span><span class="o">]</span> 4e-07
<span class="linenos"> 92</span><span class="m">18</span>: face center <span class="o">(</span><span class="m">0</span>.045 -0.005 <span class="m">0</span>.005<span class="o">)</span>
<span class="linenos"> 93</span><span class="m">18</span>: face area vector <span class="o">(</span><span class="m">0</span> <span class="m">0</span>.0001 <span class="m">0</span><span class="o">)</span>
<span class="linenos"> 94</span><span class="m">18</span>: face area <span class="m">0</span>.0001
<span class="linenos"> 95</span><span class="m">18</span>: face delta coeff <span class="m">100</span>
<span class="linenos"> 96</span><span class="m">18</span>: coeff<span class="o">(</span>D*magSf*deltacoeff<span class="o">)</span> <span class="o">((</span><span class="m">100</span>*DT<span class="o">)</span>*0.0001<span class="o">)</span> <span class="o">[</span><span class="m">0</span> <span class="m">2</span> -1 <span class="m">0</span> <span class="m">0</span> <span class="m">0</span> <span class="m">0</span><span class="o">]</span> 4e-07
<span class="linenos"> 97</span><span class="m">19</span>: face center <span class="o">(</span>-0.04 <span class="m">0</span> <span class="m">0</span>.005<span class="o">)</span>
<span class="linenos"> 98</span><span class="m">19</span>: face area vector <span class="o">(</span><span class="m">0</span>.0001 <span class="m">0</span> <span class="m">0</span><span class="o">)</span>
<span class="linenos"> 99</span><span class="m">19</span>: face area <span class="m">0</span>.0001
<span class="linenos">100</span><span class="m">19</span>: face delta coeff <span class="m">100</span>
<span class="linenos">101</span><span class="m">19</span>: coeff<span class="o">(</span>D*magSf*deltacoeff<span class="o">)</span> <span class="o">((</span><span class="m">100</span>*DT<span class="o">)</span>*0.0001<span class="o">)</span> <span class="o">[</span><span class="m">0</span> <span class="m">2</span> -1 <span class="m">0</span> <span class="m">0</span> <span class="m">0</span> <span class="m">0</span><span class="o">]</span> 4e-07
<span class="linenos">102</span><span class="m">20</span>: face center <span class="o">(</span>-0.045 <span class="m">0</span>.005 <span class="m">0</span>.005<span class="o">)</span>
<span class="linenos">103</span><span class="m">20</span>: face area vector <span class="o">(</span><span class="m">0</span> <span class="m">0</span>.0001 <span class="m">0</span><span class="o">)</span>
<span class="linenos">104</span><span class="m">20</span>: face area <span class="m">0</span>.0001
<span class="linenos">105</span><span class="m">20</span>: face delta coeff <span class="m">100</span>
<span class="linenos">106</span><span class="m">20</span>: coeff<span class="o">(</span>D*magSf*deltacoeff<span class="o">)</span> <span class="o">((</span><span class="m">100</span>*DT<span class="o">)</span>*0.0001<span class="o">)</span> <span class="o">[</span><span class="m">0</span> <span class="m">2</span> -1 <span class="m">0</span> <span class="m">0</span> <span class="m">0</span> <span class="m">0</span><span class="o">]</span> 4e-07
<span class="linenos">107</span><span class="m">21</span>: face center <span class="o">(</span>-0.03 <span class="m">0</span> <span class="m">0</span>.005<span class="o">)</span>
<span class="linenos">108</span><span class="m">21</span>: face area vector <span class="o">(</span><span class="m">0</span>.0001 <span class="m">0</span> <span class="m">0</span><span class="o">)</span>
<span class="linenos">109</span><span class="m">21</span>: face area <span class="m">0</span>.0001
<span class="linenos">110</span><span class="m">21</span>: face delta coeff <span class="m">100</span>
<span class="linenos">111</span><span class="m">21</span>: coeff<span class="o">(</span>D*magSf*deltacoeff<span class="o">)</span> <span class="o">((</span><span class="m">100</span>*DT<span class="o">)</span>*0.0001<span class="o">)</span> <span class="o">[</span><span class="m">0</span> <span class="m">2</span> -1 <span class="m">0</span> <span class="m">0</span> <span class="m">0</span> <span class="m">0</span><span class="o">]</span> 4e-07
<span class="linenos">112</span><span class="m">22</span>: face center <span class="o">(</span>-0.035 <span class="m">0</span>.005 <span class="m">0</span>.005<span class="o">)</span>
<span class="linenos">113</span><span class="m">22</span>: face area vector <span class="o">(</span><span class="m">0</span> <span class="m">0</span>.0001 <span class="m">0</span><span class="o">)</span>
<span class="linenos">114</span><span class="m">22</span>: face area <span class="m">0</span>.0001
<span class="linenos">115</span><span class="m">22</span>: face delta coeff <span class="m">100</span>
<span class="linenos">116</span><span class="m">22</span>: coeff<span class="o">(</span>D*magSf*deltacoeff<span class="o">)</span> <span class="o">((</span><span class="m">100</span>*DT<span class="o">)</span>*0.0001<span class="o">)</span> <span class="o">[</span><span class="m">0</span> <span class="m">2</span> -1 <span class="m">0</span> <span class="m">0</span> <span class="m">0</span> <span class="m">0</span><span class="o">]</span> 4e-07
<span class="linenos">117</span><span class="m">23</span>: face center <span class="o">(</span>-0.02 <span class="m">0</span> <span class="m">0</span>.005<span class="o">)</span>
<span class="linenos">118</span><span class="m">23</span>: face area vector <span class="o">(</span><span class="m">0</span>.0001 <span class="m">0</span> <span class="m">0</span><span class="o">)</span>
<span class="linenos">119</span><span class="m">23</span>: face area <span class="m">0</span>.0001
<span class="linenos">120</span><span class="m">23</span>: face delta coeff <span class="m">100</span>
<span class="linenos">121</span><span class="m">23</span>: coeff<span class="o">(</span>D*magSf*deltacoeff<span class="o">)</span> <span class="o">((</span><span class="m">100</span>*DT<span class="o">)</span>*0.0001<span class="o">)</span> <span class="o">[</span><span class="m">0</span> <span class="m">2</span> -1 <span class="m">0</span> <span class="m">0</span> <span class="m">0</span> <span class="m">0</span><span class="o">]</span> 4e-07
<span class="linenos">122</span><span class="m">24</span>: face center <span class="o">(</span>-0.025 <span class="m">0</span>.005 <span class="m">0</span>.005<span class="o">)</span>
<span class="linenos">123</span><span class="m">24</span>: face area vector <span class="o">(</span><span class="m">0</span> <span class="m">0</span>.0001 <span class="m">0</span><span class="o">)</span>
<span class="linenos">124</span><span class="m">24</span>: face area <span class="m">0</span>.0001
<span class="linenos">125</span><span class="m">24</span>: face delta coeff <span class="m">100</span>
<span class="linenos">126</span><span class="m">24</span>: coeff<span class="o">(</span>D*magSf*deltacoeff<span class="o">)</span> <span class="o">((</span><span class="m">100</span>*DT<span class="o">)</span>*0.0001<span class="o">)</span> <span class="o">[</span><span class="m">0</span> <span class="m">2</span> -1 <span class="m">0</span> <span class="m">0</span> <span class="m">0</span> <span class="m">0</span><span class="o">]</span> 4e-07
<span class="linenos">127</span><span class="m">25</span>: face center <span class="o">(</span>-0.01 <span class="m">0</span> <span class="m">0</span>.005<span class="o">)</span>
<span class="linenos">128</span><span class="m">25</span>: face area vector <span class="o">(</span><span class="m">0</span>.0001 <span class="m">0</span> <span class="m">0</span><span class="o">)</span>
<span class="linenos">129</span><span class="m">25</span>: face area <span class="m">0</span>.0001
<span class="linenos">130</span><span class="m">25</span>: face delta coeff <span class="m">100</span>
<span class="linenos">131</span><span class="m">25</span>: coeff<span class="o">(</span>D*magSf*deltacoeff<span class="o">)</span> <span class="o">((</span><span class="m">100</span>*DT<span class="o">)</span>*0.0001<span class="o">)</span> <span class="o">[</span><span class="m">0</span> <span class="m">2</span> -1 <span class="m">0</span> <span class="m">0</span> <span class="m">0</span> <span class="m">0</span><span class="o">]</span> 4e-07
<span class="linenos">132</span><span class="m">26</span>: face center <span class="o">(</span>-0.015 <span class="m">0</span>.005 <span class="m">0</span>.005<span class="o">)</span>
<span class="linenos">133</span><span class="m">26</span>: face area vector <span class="o">(</span><span class="m">0</span> <span class="m">0</span>.0001 <span class="m">0</span><span class="o">)</span>
<span class="linenos">134</span><span class="m">26</span>: face area <span class="m">0</span>.0001
<span class="linenos">135</span><span class="m">26</span>: face delta coeff <span class="m">100</span>
<span class="linenos">136</span><span class="m">26</span>: coeff<span class="o">(</span>D*magSf*deltacoeff<span class="o">)</span> <span class="o">((</span><span class="m">100</span>*DT<span class="o">)</span>*0.0001<span class="o">)</span> <span class="o">[</span><span class="m">0</span> <span class="m">2</span> -1 <span class="m">0</span> <span class="m">0</span> <span class="m">0</span> <span class="m">0</span><span class="o">]</span> 4e-07
<span class="linenos">137</span><span class="m">27</span>: face center <span class="o">(</span><span class="m">0</span> <span class="m">0</span> <span class="m">0</span>.005<span class="o">)</span>
<span class="linenos">138</span><span class="m">27</span>: face area vector <span class="o">(</span><span class="m">0</span>.0001 <span class="m">0</span> <span class="m">0</span><span class="o">)</span>
<span class="linenos">139</span><span class="m">27</span>: face area <span class="m">0</span>.0001
<span class="linenos">140</span><span class="m">27</span>: face delta coeff <span class="m">100</span>
<span class="linenos">141</span><span class="m">27</span>: coeff<span class="o">(</span>D*magSf*deltacoeff<span class="o">)</span> <span class="o">((</span><span class="m">100</span>*DT<span class="o">)</span>*0.0001<span class="o">)</span> <span class="o">[</span><span class="m">0</span> <span class="m">2</span> -1 <span class="m">0</span> <span class="m">0</span> <span class="m">0</span> <span class="m">0</span><span class="o">]</span> 4e-07
<span class="linenos">142</span><span class="m">28</span>: face center <span class="o">(</span>-0.005 <span class="m">0</span>.005 <span class="m">0</span>.005<span class="o">)</span>
<span class="linenos">143</span><span class="m">28</span>: face area vector <span class="o">(</span><span class="m">0</span> <span class="m">0</span>.0001 <span class="m">0</span><span class="o">)</span>
<span class="linenos">144</span><span class="m">28</span>: face area <span class="m">0</span>.0001
<span class="linenos">145</span><span class="m">28</span>: face delta coeff <span class="m">100</span>
<span class="linenos">146</span><span class="m">28</span>: coeff<span class="o">(</span>D*magSf*deltacoeff<span class="o">)</span> <span class="o">((</span><span class="m">100</span>*DT<span class="o">)</span>*0.0001<span class="o">)</span> <span class="o">[</span><span class="m">0</span> <span class="m">2</span> -1 <span class="m">0</span> <span class="m">0</span> <span class="m">0</span> <span class="m">0</span><span class="o">]</span> 4e-07
<span class="linenos">147</span><span class="m">29</span>: face center <span class="o">(</span><span class="m">0</span>.01 <span class="m">0</span> <span class="m">0</span>.005<span class="o">)</span>
<span class="linenos">148</span><span class="m">29</span>: face area vector <span class="o">(</span><span class="m">0</span>.0001 <span class="m">0</span> <span class="m">0</span><span class="o">)</span>
<span class="linenos">149</span><span class="m">29</span>: face area <span class="m">0</span>.0001
<span class="linenos">150</span><span class="m">29</span>: face delta coeff <span class="m">100</span>
<span class="linenos">151</span><span class="m">29</span>: coeff<span class="o">(</span>D*magSf*deltacoeff<span class="o">)</span> <span class="o">((</span><span class="m">100</span>*DT<span class="o">)</span>*0.0001<span class="o">)</span> <span class="o">[</span><span class="m">0</span> <span class="m">2</span> -1 <span class="m">0</span> <span class="m">0</span> <span class="m">0</span> <span class="m">0</span><span class="o">]</span> 4e-07
<span class="linenos">152</span><span class="m">30</span>: face center <span class="o">(</span><span class="m">0</span>.005 <span class="m">0</span>.005 <span class="m">0</span>.005<span class="o">)</span>
<span class="linenos">153</span><span class="m">30</span>: face area vector <span class="o">(</span><span class="m">0</span> <span class="m">0</span>.0001 <span class="m">0</span><span class="o">)</span>
<span class="linenos">154</span><span class="m">30</span>: face area <span class="m">0</span>.0001
<span class="linenos">155</span><span class="m">30</span>: face delta coeff <span class="m">100</span>
<span class="linenos">156</span><span class="m">30</span>: coeff<span class="o">(</span>D*magSf*deltacoeff<span class="o">)</span> <span class="o">((</span><span class="m">100</span>*DT<span class="o">)</span>*0.0001<span class="o">)</span> <span class="o">[</span><span class="m">0</span> <span class="m">2</span> -1 <span class="m">0</span> <span class="m">0</span> <span class="m">0</span> <span class="m">0</span><span class="o">]</span> 4e-07
<span class="linenos">157</span><span class="m">31</span>: face center <span class="o">(</span><span class="m">0</span>.02 <span class="m">0</span> <span class="m">0</span>.005<span class="o">)</span>
<span class="linenos">158</span><span class="m">31</span>: face area vector <span class="o">(</span><span class="m">0</span>.0001 <span class="m">0</span> <span class="m">0</span><span class="o">)</span>
<span class="linenos">159</span><span class="m">31</span>: face area <span class="m">0</span>.0001
<span class="linenos">160</span><span class="m">31</span>: face delta coeff <span class="m">100</span>
<span class="linenos">161</span><span class="m">31</span>: coeff<span class="o">(</span>D*magSf*deltacoeff<span class="o">)</span> <span class="o">((</span><span class="m">100</span>*DT<span class="o">)</span>*0.0001<span class="o">)</span> <span class="o">[</span><span class="m">0</span> <span class="m">2</span> -1 <span class="m">0</span> <span class="m">0</span> <span class="m">0</span> <span class="m">0</span><span class="o">]</span> 4e-07
<span class="linenos">162</span><span class="m">32</span>: face center <span class="o">(</span><span class="m">0</span>.015 <span class="m">0</span>.005 <span class="m">0</span>.005<span class="o">)</span>
<span class="linenos">163</span><span class="m">32</span>: face area vector <span class="o">(</span><span class="m">0</span> <span class="m">0</span>.0001 <span class="m">0</span><span class="o">)</span>
<span class="linenos">164</span><span class="m">32</span>: face area <span class="m">0</span>.0001
<span class="linenos">165</span><span class="m">32</span>: face delta coeff <span class="m">100</span>
<span class="linenos">166</span><span class="m">32</span>: coeff<span class="o">(</span>D*magSf*deltacoeff<span class="o">)</span> <span class="o">((</span><span class="m">100</span>*DT<span class="o">)</span>*0.0001<span class="o">)</span> <span class="o">[</span><span class="m">0</span> <span class="m">2</span> -1 <span class="m">0</span> <span class="m">0</span> <span class="m">0</span> <span class="m">0</span><span class="o">]</span> 4e-07
<span class="linenos">167</span><span class="m">33</span>: face center <span class="o">(</span><span class="m">0</span>.03 <span class="m">0</span> <span class="m">0</span>.005<span class="o">)</span>
<span class="linenos">168</span><span class="m">33</span>: face area vector <span class="o">(</span><span class="m">0</span>.0001 <span class="m">0</span> <span class="m">0</span><span class="o">)</span>
<span class="linenos">169</span><span class="m">33</span>: face area <span class="m">0</span>.0001
<span class="linenos">170</span><span class="m">33</span>: face delta coeff <span class="m">100</span>
<span class="linenos">171</span><span class="m">33</span>: coeff<span class="o">(</span>D*magSf*deltacoeff<span class="o">)</span> <span class="o">((</span><span class="m">100</span>*DT<span class="o">)</span>*0.0001<span class="o">)</span> <span class="o">[</span><span class="m">0</span> <span class="m">2</span> -1 <span class="m">0</span> <span class="m">0</span> <span class="m">0</span> <span class="m">0</span><span class="o">]</span> 4e-07
<span class="linenos">172</span><span class="m">34</span>: face center <span class="o">(</span><span class="m">0</span>.025 <span class="m">0</span>.005 <span class="m">0</span>.005<span class="o">)</span>
<span class="linenos">173</span><span class="m">34</span>: face area vector <span class="o">(</span><span class="m">0</span> <span class="m">0</span>.0001 <span class="m">0</span><span class="o">)</span>
<span class="linenos">174</span><span class="m">34</span>: face area <span class="m">0</span>.0001
<span class="linenos">175</span><span class="m">34</span>: face delta coeff <span class="m">100</span>
<span class="linenos">176</span><span class="m">34</span>: coeff<span class="o">(</span>D*magSf*deltacoeff<span class="o">)</span> <span class="o">((</span><span class="m">100</span>*DT<span class="o">)</span>*0.0001<span class="o">)</span> <span class="o">[</span><span class="m">0</span> <span class="m">2</span> -1 <span class="m">0</span> <span class="m">0</span> <span class="m">0</span> <span class="m">0</span><span class="o">]</span> 4e-07
<span class="linenos">177</span><span class="m">35</span>: face center <span class="o">(</span><span class="m">0</span>.04 <span class="m">0</span> <span class="m">0</span>.005<span class="o">)</span>
<span class="linenos">178</span><span class="m">35</span>: face area vector <span class="o">(</span><span class="m">0</span>.0001 <span class="m">0</span> <span class="m">0</span><span class="o">)</span>
<span class="linenos">179</span><span class="m">35</span>: face area <span class="m">0</span>.0001
<span class="linenos">180</span><span class="m">35</span>: face delta coeff <span class="m">100</span>
<span class="linenos">181</span><span class="m">35</span>: coeff<span class="o">(</span>D*magSf*deltacoeff<span class="o">)</span> <span class="o">((</span><span class="m">100</span>*DT<span class="o">)</span>*0.0001<span class="o">)</span> <span class="o">[</span><span class="m">0</span> <span class="m">2</span> -1 <span class="m">0</span> <span class="m">0</span> <span class="m">0</span> <span class="m">0</span><span class="o">]</span> 4e-07
<span class="linenos">182</span><span class="m">36</span>: face center <span class="o">(</span><span class="m">0</span>.035 <span class="m">0</span>.005 <span class="m">0</span>.005<span class="o">)</span>
<span class="linenos">183</span><span class="m">36</span>: face area vector <span class="o">(</span><span class="m">0</span> <span class="m">0</span>.0001 <span class="m">0</span><span class="o">)</span>
<span class="linenos">184</span><span class="m">36</span>: face area <span class="m">0</span>.0001
<span class="linenos">185</span><span class="m">36</span>: face delta coeff <span class="m">100</span>
<span class="linenos">186</span><span class="m">36</span>: coeff<span class="o">(</span>D*magSf*deltacoeff<span class="o">)</span> <span class="o">((</span><span class="m">100</span>*DT<span class="o">)</span>*0.0001<span class="o">)</span> <span class="o">[</span><span class="m">0</span> <span class="m">2</span> -1 <span class="m">0</span> <span class="m">0</span> <span class="m">0</span> <span class="m">0</span><span class="o">]</span> 4e-07
<span class="linenos">187</span><span class="m">37</span>: face center <span class="o">(</span><span class="m">0</span>.045 <span class="m">0</span>.005 <span class="m">0</span>.005<span class="o">)</span>
<span class="linenos">188</span><span class="m">37</span>: face area vector <span class="o">(</span><span class="m">0</span> <span class="m">0</span>.0001 <span class="m">0</span><span class="o">)</span>
<span class="linenos">189</span><span class="m">37</span>: face area <span class="m">0</span>.0001
<span class="linenos">190</span><span class="m">37</span>: face delta coeff <span class="m">100</span>
<span class="linenos">191</span><span class="m">37</span>: coeff<span class="o">(</span>D*magSf*deltacoeff<span class="o">)</span> <span class="o">((</span><span class="m">100</span>*DT<span class="o">)</span>*0.0001<span class="o">)</span> <span class="o">[</span><span class="m">0</span> <span class="m">2</span> -1 <span class="m">0</span> <span class="m">0</span> <span class="m">0</span> <span class="m">0</span><span class="o">]</span> 4e-07
<span class="linenos">192</span><span class="m">38</span>: face center <span class="o">(</span>-0.04 <span class="m">0</span>.01 <span class="m">0</span>.005<span class="o">)</span>
<span class="linenos">193</span><span class="m">38</span>: face area vector <span class="o">(</span><span class="m">0</span>.0001 <span class="m">0</span> <span class="m">0</span><span class="o">)</span>
<span class="linenos">194</span><span class="m">38</span>: face area <span class="m">0</span>.0001
<span class="linenos">195</span><span class="m">38</span>: face delta coeff <span class="m">100</span>
<span class="linenos">196</span><span class="m">38</span>: coeff<span class="o">(</span>D*magSf*deltacoeff<span class="o">)</span> <span class="o">((</span><span class="m">100</span>*DT<span class="o">)</span>*0.0001<span class="o">)</span> <span class="o">[</span><span class="m">0</span> <span class="m">2</span> -1 <span class="m">0</span> <span class="m">0</span> <span class="m">0</span> <span class="m">0</span><span class="o">]</span> 4e-07
<span class="linenos">197</span><span class="m">39</span>: face center <span class="o">(</span>-0.03 <span class="m">0</span>.01 <span class="m">0</span>.005<span class="o">)</span>
<span class="linenos">198</span><span class="m">39</span>: face area vector <span class="o">(</span><span class="m">0</span>.0001 <span class="m">0</span> <span class="m">0</span><span class="o">)</span>
<span class="linenos">199</span><span class="m">39</span>: face area <span class="m">0</span>.0001
<span class="linenos">200</span><span class="m">39</span>: face delta coeff <span class="m">100</span>
<span class="linenos">201</span><span class="m">39</span>: coeff<span class="o">(</span>D*magSf*deltacoeff<span class="o">)</span> <span class="o">((</span><span class="m">100</span>*DT<span class="o">)</span>*0.0001<span class="o">)</span> <span class="o">[</span><span class="m">0</span> <span class="m">2</span> -1 <span class="m">0</span> <span class="m">0</span> <span class="m">0</span> <span class="m">0</span><span class="o">]</span> 4e-07
<span class="linenos">202</span><span class="m">40</span>: face center <span class="o">(</span>-0.02 <span class="m">0</span>.01 <span class="m">0</span>.005<span class="o">)</span>
<span class="linenos">203</span><span class="m">40</span>: face area vector <span class="o">(</span><span class="m">0</span>.0001 <span class="m">0</span> <span class="m">0</span><span class="o">)</span>
<span class="linenos">204</span><span class="m">40</span>: face area <span class="m">0</span>.0001
<span class="linenos">205</span><span class="m">40</span>: face delta coeff <span class="m">100</span>
<span class="linenos">206</span><span class="m">40</span>: coeff<span class="o">(</span>D*magSf*deltacoeff<span class="o">)</span> <span class="o">((</span><span class="m">100</span>*DT<span class="o">)</span>*0.0001<span class="o">)</span> <span class="o">[</span><span class="m">0</span> <span class="m">2</span> -1 <span class="m">0</span> <span class="m">0</span> <span class="m">0</span> <span class="m">0</span><span class="o">]</span> 4e-07
<span class="linenos">207</span><span class="m">41</span>: face center <span class="o">(</span>-0.01 <span class="m">0</span>.01 <span class="m">0</span>.005<span class="o">)</span>
<span class="linenos">208</span><span class="m">41</span>: face area vector <span class="o">(</span><span class="m">0</span>.0001 <span class="m">0</span> <span class="m">0</span><span class="o">)</span>
<span class="linenos">209</span><span class="m">41</span>: face area <span class="m">0</span>.0001
<span class="linenos">210</span><span class="m">41</span>: face delta coeff <span class="m">100</span>
<span class="linenos">211</span><span class="m">41</span>: coeff<span class="o">(</span>D*magSf*deltacoeff<span class="o">)</span> <span class="o">((</span><span class="m">100</span>*DT<span class="o">)</span>*0.0001<span class="o">)</span> <span class="o">[</span><span class="m">0</span> <span class="m">2</span> -1 <span class="m">0</span> <span class="m">0</span> <span class="m">0</span> <span class="m">0</span><span class="o">]</span> 4e-07
<span class="linenos">212</span><span class="m">42</span>: face center <span class="o">(</span><span class="m">0</span> <span class="m">0</span>.01 <span class="m">0</span>.005<span class="o">)</span>
<span class="linenos">213</span><span class="m">42</span>: face area vector <span class="o">(</span><span class="m">0</span>.0001 <span class="m">0</span> <span class="m">0</span><span class="o">)</span>
<span class="linenos">214</span><span class="m">42</span>: face area <span class="m">0</span>.0001
<span class="linenos">215</span><span class="m">42</span>: face delta coeff <span class="m">100</span>
<span class="linenos">216</span><span class="m">42</span>: coeff<span class="o">(</span>D*magSf*deltacoeff<span class="o">)</span> <span class="o">((</span><span class="m">100</span>*DT<span class="o">)</span>*0.0001<span class="o">)</span> <span class="o">[</span><span class="m">0</span> <span class="m">2</span> -1 <span class="m">0</span> <span class="m">0</span> <span class="m">0</span> <span class="m">0</span><span class="o">]</span> 4e-07
<span class="linenos">217</span><span class="m">43</span>: face center <span class="o">(</span><span class="m">0</span>.01 <span class="m">0</span>.01 <span class="m">0</span>.005<span class="o">)</span>
<span class="linenos">218</span><span class="m">43</span>: face area vector <span class="o">(</span><span class="m">0</span>.0001 <span class="m">0</span> <span class="m">0</span><span class="o">)</span>
<span class="linenos">219</span><span class="m">43</span>: face area <span class="m">0</span>.0001
<span class="linenos">220</span><span class="m">43</span>: face delta coeff <span class="m">100</span>
<span class="linenos">221</span><span class="m">43</span>: coeff<span class="o">(</span>D*magSf*deltacoeff<span class="o">)</span> <span class="o">((</span><span class="m">100</span>*DT<span class="o">)</span>*0.0001<span class="o">)</span> <span class="o">[</span><span class="m">0</span> <span class="m">2</span> -1 <span class="m">0</span> <span class="m">0</span> <span class="m">0</span> <span class="m">0</span><span class="o">]</span> 4e-07
<span class="linenos">222</span><span class="m">44</span>: face center <span class="o">(</span><span class="m">0</span>.02 <span class="m">0</span>.01 <span class="m">0</span>.005<span class="o">)</span>
<span class="linenos">223</span><span class="m">44</span>: face area vector <span class="o">(</span><span class="m">0</span>.0001 <span class="m">0</span> <span class="m">0</span><span class="o">)</span>
<span class="linenos">224</span><span class="m">44</span>: face area <span class="m">0</span>.0001
<span class="linenos">225</span><span class="m">44</span>: face delta coeff <span class="m">100</span>
<span class="linenos">226</span><span class="m">44</span>: coeff<span class="o">(</span>D*magSf*deltacoeff<span class="o">)</span> <span class="o">((</span><span class="m">100</span>*DT<span class="o">)</span>*0.0001<span class="o">)</span> <span class="o">[</span><span class="m">0</span> <span class="m">2</span> -1 <span class="m">0</span> <span class="m">0</span> <span class="m">0</span> <span class="m">0</span><span class="o">]</span> 4e-07
<span class="linenos">227</span><span class="m">45</span>: face center <span class="o">(</span><span class="m">0</span>.03 <span class="m">0</span>.01 <span class="m">0</span>.005<span class="o">)</span>
<span class="linenos">228</span><span class="m">45</span>: face area vector <span class="o">(</span><span class="m">0</span>.0001 <span class="m">0</span> <span class="m">0</span><span class="o">)</span>
<span class="linenos">229</span><span class="m">45</span>: face area <span class="m">0</span>.0001
<span class="linenos">230</span><span class="m">45</span>: face delta coeff <span class="m">100</span>
<span class="linenos">231</span><span class="m">45</span>: coeff<span class="o">(</span>D*magSf*deltacoeff<span class="o">)</span> <span class="o">((</span><span class="m">100</span>*DT<span class="o">)</span>*0.0001<span class="o">)</span> <span class="o">[</span><span class="m">0</span> <span class="m">2</span> -1 <span class="m">0</span> <span class="m">0</span> <span class="m">0</span> <span class="m">0</span><span class="o">]</span> 4e-07
<span class="linenos">232</span><span class="m">46</span>: face center <span class="o">(</span><span class="m">0</span>.04 <span class="m">0</span>.01 <span class="m">0</span>.005<span class="o">)</span>
<span class="linenos">233</span><span class="m">46</span>: face area vector <span class="o">(</span><span class="m">0</span>.0001 <span class="m">0</span> <span class="m">0</span><span class="o">)</span>
<span class="linenos">234</span><span class="m">46</span>: face area <span class="m">0</span>.0001
<span class="linenos">235</span><span class="m">46</span>: face delta coeff <span class="m">100</span>
<span class="linenos">236</span><span class="m">46</span>: coeff<span class="o">(</span>D*magSf*deltacoeff<span class="o">)</span> <span class="o">((</span><span class="m">100</span>*DT<span class="o">)</span>*0.0001<span class="o">)</span> <span class="o">[</span><span class="m">0</span> <span class="m">2</span> -1 <span class="m">0</span> <span class="m">0</span> <span class="m">0</span> <span class="m">0</span><span class="o">]</span> 4e-07
</pre></div>
</div>
</div>
</div>
<input class="tab-input" id="tab-set--6-input--4" name="tab-set--6" type="radio"><label class="tab-label" for="tab-set--6-input--4">Boundary mesh</label><div class="tab-content docutils container">
<div class="literal-block-wrapper docutils container" id="lst-log-boundarymesh">
<div class="code-block-caption"><span class="caption-number">Listing 27 </span><span class="caption-text">Boundary mesh properties of the regular mesh shown in <a class="reference internal" href="#fig-polymesh-regularbox"><span class="std std-numref">Fig. 34</span></a>.</span><a class="headerlink" href="#lst-log-boundarymesh" title="Permalink to this code"></a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="linenos">  1</span>Patch bottom face <span class="m">9</span>: owner cell 9Access boundary mesh
<span class="linenos">  2</span>Patch left face <span class="m">0</span>: face center <span class="o">(</span>-0.05 -0.01 <span class="m">0</span>.005<span class="o">)</span>
<span class="linenos">  3</span>Patch left face <span class="m">0</span>: face area vector <span class="o">(</span>-0.0001 <span class="m">0</span> <span class="m">0</span><span class="o">)</span>
<span class="linenos">  4</span>Patch left face <span class="m">0</span>: face area <span class="m">0</span>.0001
<span class="linenos">  5</span>Patch left face <span class="m">0</span>: face delta coeff <span class="m">200</span>
<span class="linenos">  6</span>Patch left face <span class="m">0</span>: owner cell <span class="m">0</span>
<span class="linenos">  7</span>Patch left face <span class="m">1</span>: face center <span class="o">(</span>-0.05 <span class="m">0</span> <span class="m">0</span>.005<span class="o">)</span>
<span class="linenos">  8</span>Patch left face <span class="m">1</span>: face area vector <span class="o">(</span>-0.0001 <span class="m">0</span> <span class="m">0</span><span class="o">)</span>
<span class="linenos">  9</span>Patch left face <span class="m">1</span>: face area <span class="m">0</span>.0001
<span class="linenos"> 10</span>Patch left face <span class="m">1</span>: face delta coeff <span class="m">200</span>
<span class="linenos"> 11</span>Patch left face <span class="m">1</span>: owner cell <span class="m">10</span>
<span class="linenos"> 12</span>Patch left face <span class="m">2</span>: face center <span class="o">(</span>-0.05 <span class="m">0</span>.01 <span class="m">0</span>.005<span class="o">)</span>
<span class="linenos"> 13</span>Patch left face <span class="m">2</span>: face area vector <span class="o">(</span>-0.0001 <span class="m">0</span> <span class="m">0</span><span class="o">)</span>
<span class="linenos"> 14</span>Patch left face <span class="m">2</span>: face area <span class="m">0</span>.0001
<span class="linenos"> 15</span>Patch left face <span class="m">2</span>: face delta coeff <span class="m">200</span>
<span class="linenos"> 16</span>Patch left face <span class="m">2</span>: owner cell <span class="m">20</span>
<span class="linenos"> 17</span>Patch right face <span class="m">0</span>: face center <span class="o">(</span><span class="m">0</span>.05 -0.01 <span class="m">0</span>.005<span class="o">)</span>
<span class="linenos"> 18</span>Patch right face <span class="m">0</span>: face area vector <span class="o">(</span><span class="m">0</span>.0001 <span class="m">0</span> <span class="m">0</span><span class="o">)</span>
<span class="linenos"> 19</span>Patch right face <span class="m">0</span>: face area <span class="m">0</span>.0001
<span class="linenos"> 20</span>Patch right face <span class="m">0</span>: face delta coeff <span class="m">200</span>
<span class="linenos"> 21</span>Patch right face <span class="m">0</span>: owner cell <span class="m">9</span>
<span class="linenos"> 22</span>Patch right face <span class="m">1</span>: face center <span class="o">(</span><span class="m">0</span>.05 <span class="m">0</span> <span class="m">0</span>.005<span class="o">)</span>
<span class="linenos"> 23</span>Patch right face <span class="m">1</span>: face area vector <span class="o">(</span><span class="m">0</span>.0001 <span class="m">0</span> <span class="m">0</span><span class="o">)</span>
<span class="linenos"> 24</span>Patch right face <span class="m">1</span>: face area <span class="m">0</span>.0001
<span class="linenos"> 25</span>Patch right face <span class="m">1</span>: face delta coeff <span class="m">200</span>
<span class="linenos"> 26</span>Patch right face <span class="m">1</span>: owner cell <span class="m">19</span>
<span class="linenos"> 27</span>Patch right face <span class="m">2</span>: face center <span class="o">(</span><span class="m">0</span>.05 <span class="m">0</span>.01 <span class="m">0</span>.005<span class="o">)</span>
<span class="linenos"> 28</span>Patch right face <span class="m">2</span>: face area vector <span class="o">(</span><span class="m">0</span>.0001 <span class="m">0</span> <span class="m">0</span><span class="o">)</span>
<span class="linenos"> 29</span>Patch right face <span class="m">2</span>: face area <span class="m">0</span>.0001
<span class="linenos"> 30</span>Patch right face <span class="m">2</span>: face delta coeff <span class="m">200</span>
<span class="linenos"> 31</span>Patch right face <span class="m">2</span>: owner cell <span class="m">29</span>
<span class="linenos"> 32</span>Patch top face <span class="m">0</span>: face center <span class="o">(</span>-0.045 <span class="m">0</span>.015 <span class="m">0</span>.005<span class="o">)</span>
<span class="linenos"> 33</span>Patch top face <span class="m">0</span>: face area vector <span class="o">(</span><span class="m">0</span> <span class="m">0</span>.0001 <span class="m">0</span><span class="o">)</span>
<span class="linenos"> 34</span>Patch top face <span class="m">0</span>: face area <span class="m">0</span>.0001
<span class="linenos"> 35</span>Patch top face <span class="m">0</span>: face delta coeff <span class="m">200</span>
<span class="linenos"> 36</span>Patch top face <span class="m">0</span>: owner cell <span class="m">20</span>
<span class="linenos"> 37</span>Patch top face <span class="m">1</span>: face center <span class="o">(</span>-0.035 <span class="m">0</span>.015 <span class="m">0</span>.005<span class="o">)</span>
<span class="linenos"> 38</span>Patch top face <span class="m">1</span>: face area vector <span class="o">(</span><span class="m">0</span> <span class="m">0</span>.0001 <span class="m">0</span><span class="o">)</span>
<span class="linenos"> 39</span>Patch top face <span class="m">1</span>: face area <span class="m">0</span>.0001
<span class="linenos"> 40</span>Patch top face <span class="m">1</span>: face delta coeff <span class="m">200</span>
<span class="linenos"> 41</span>Patch top face <span class="m">1</span>: owner cell <span class="m">21</span>
<span class="linenos"> 42</span>Patch top face <span class="m">2</span>: face center <span class="o">(</span>-0.025 <span class="m">0</span>.015 <span class="m">0</span>.005<span class="o">)</span>
<span class="linenos"> 43</span>Patch top face <span class="m">2</span>: face area vector <span class="o">(</span><span class="m">0</span> <span class="m">0</span>.0001 <span class="m">0</span><span class="o">)</span>
<span class="linenos"> 44</span>Patch top face <span class="m">2</span>: face area <span class="m">0</span>.0001
<span class="linenos"> 45</span>Patch top face <span class="m">2</span>: face delta coeff <span class="m">200</span>
<span class="linenos"> 46</span>Patch top face <span class="m">2</span>: owner cell <span class="m">22</span>
<span class="linenos"> 47</span>Patch top face <span class="m">3</span>: face center <span class="o">(</span>-0.015 <span class="m">0</span>.015 <span class="m">0</span>.005<span class="o">)</span>
<span class="linenos"> 48</span>Patch top face <span class="m">3</span>: face area vector <span class="o">(</span><span class="m">0</span> <span class="m">0</span>.0001 <span class="m">0</span><span class="o">)</span>
<span class="linenos"> 49</span>Patch top face <span class="m">3</span>: face area <span class="m">0</span>.0001
<span class="linenos"> 50</span>Patch top face <span class="m">3</span>: face delta coeff <span class="m">200</span>
<span class="linenos"> 51</span>Patch top face <span class="m">3</span>: owner cell <span class="m">23</span>
<span class="linenos"> 52</span>Patch top face <span class="m">4</span>: face center <span class="o">(</span>-0.005 <span class="m">0</span>.015 <span class="m">0</span>.005<span class="o">)</span>
<span class="linenos"> 53</span>Patch top face <span class="m">4</span>: face area vector <span class="o">(</span><span class="m">0</span> <span class="m">0</span>.0001 <span class="m">0</span><span class="o">)</span>
<span class="linenos"> 54</span>Patch top face <span class="m">4</span>: face area <span class="m">0</span>.0001
<span class="linenos"> 55</span>Patch top face <span class="m">4</span>: face delta coeff <span class="m">200</span>
<span class="linenos"> 56</span>Patch top face <span class="m">4</span>: owner cell <span class="m">24</span>
<span class="linenos"> 57</span>Patch top face <span class="m">5</span>: face center <span class="o">(</span><span class="m">0</span>.005 <span class="m">0</span>.015 <span class="m">0</span>.005<span class="o">)</span>
<span class="linenos"> 58</span>Patch top face <span class="m">5</span>: face area vector <span class="o">(</span><span class="m">0</span> <span class="m">0</span>.0001 <span class="m">0</span><span class="o">)</span>
<span class="linenos"> 59</span>Patch top face <span class="m">5</span>: face area <span class="m">0</span>.0001
<span class="linenos"> 60</span>Patch top face <span class="m">5</span>: face delta coeff <span class="m">200</span>
<span class="linenos"> 61</span>Patch top face <span class="m">5</span>: owner cell <span class="m">25</span>
<span class="linenos"> 62</span>Patch top face <span class="m">6</span>: face center <span class="o">(</span><span class="m">0</span>.015 <span class="m">0</span>.015 <span class="m">0</span>.005<span class="o">)</span>
<span class="linenos"> 63</span>Patch top face <span class="m">6</span>: face area vector <span class="o">(</span><span class="m">0</span> <span class="m">0</span>.0001 <span class="m">0</span><span class="o">)</span>
<span class="linenos"> 64</span>Patch top face <span class="m">6</span>: face area <span class="m">0</span>.0001
<span class="linenos"> 65</span>Patch top face <span class="m">6</span>: face delta coeff <span class="m">200</span>
<span class="linenos"> 66</span>Patch top face <span class="m">6</span>: owner cell <span class="m">26</span>
<span class="linenos"> 67</span>Patch top face <span class="m">7</span>: face center <span class="o">(</span><span class="m">0</span>.025 <span class="m">0</span>.015 <span class="m">0</span>.005<span class="o">)</span>
<span class="linenos"> 68</span>Patch top face <span class="m">7</span>: face area vector <span class="o">(</span><span class="m">0</span> <span class="m">0</span>.0001 <span class="m">0</span><span class="o">)</span>
<span class="linenos"> 69</span>Patch top face <span class="m">7</span>: face area <span class="m">0</span>.0001
<span class="linenos"> 70</span>Patch top face <span class="m">7</span>: face delta coeff <span class="m">200</span>
<span class="linenos"> 71</span>Patch top face <span class="m">7</span>: owner cell <span class="m">27</span>
<span class="linenos"> 72</span>Patch top face <span class="m">8</span>: face center <span class="o">(</span><span class="m">0</span>.035 <span class="m">0</span>.015 <span class="m">0</span>.005<span class="o">)</span>
<span class="linenos"> 73</span>Patch top face <span class="m">8</span>: face area vector <span class="o">(</span><span class="m">0</span> <span class="m">0</span>.0001 <span class="m">0</span><span class="o">)</span>
<span class="linenos"> 74</span>Patch top face <span class="m">8</span>: face area <span class="m">0</span>.0001
<span class="linenos"> 75</span>Patch top face <span class="m">8</span>: face delta coeff <span class="m">200</span>
<span class="linenos"> 76</span>Patch top face <span class="m">8</span>: owner cell <span class="m">28</span>
<span class="linenos"> 77</span>Patch top face <span class="m">9</span>: face center <span class="o">(</span><span class="m">0</span>.045 <span class="m">0</span>.015 <span class="m">0</span>.005<span class="o">)</span>
<span class="linenos"> 78</span>Patch top face <span class="m">9</span>: face area vector <span class="o">(</span><span class="m">0</span> <span class="m">0</span>.0001 <span class="m">0</span><span class="o">)</span>
<span class="linenos"> 79</span>Patch top face <span class="m">9</span>: face area <span class="m">0</span>.0001
<span class="linenos"> 80</span>Patch top face <span class="m">9</span>: face delta coeff <span class="m">200</span>
<span class="linenos"> 81</span>Patch top face <span class="m">9</span>: owner cell <span class="m">29</span>
<span class="linenos"> 82</span>Patch bottom face <span class="m">0</span>: face center <span class="o">(</span>-0.045 -0.015 <span class="m">0</span>.005<span class="o">)</span>
<span class="linenos"> 83</span>Patch bottom face <span class="m">0</span>: face area vector <span class="o">(</span><span class="m">0</span> -0.0001 <span class="m">0</span><span class="o">)</span>
<span class="linenos"> 84</span>Patch bottom face <span class="m">0</span>: face area <span class="m">0</span>.0001
<span class="linenos"> 85</span>Patch bottom face <span class="m">0</span>: face delta coeff <span class="m">200</span>
<span class="linenos"> 86</span>Patch bottom face <span class="m">0</span>: owner cell <span class="m">0</span>
<span class="linenos"> 87</span>Patch bottom face <span class="m">1</span>: face center <span class="o">(</span>-0.035 -0.015 <span class="m">0</span>.005<span class="o">)</span>
<span class="linenos"> 88</span>Patch bottom face <span class="m">1</span>: face area vector <span class="o">(</span><span class="m">0</span> -0.0001 <span class="m">0</span><span class="o">)</span>
<span class="linenos"> 89</span>Patch bottom face <span class="m">1</span>: face area <span class="m">0</span>.0001
<span class="linenos"> 90</span>Patch bottom face <span class="m">1</span>: face delta coeff <span class="m">200</span>
<span class="linenos"> 91</span>Patch bottom face <span class="m">1</span>: owner cell <span class="m">1</span>
<span class="linenos"> 92</span>Patch bottom face <span class="m">2</span>: face center <span class="o">(</span>-0.025 -0.015 <span class="m">0</span>.005<span class="o">)</span>
<span class="linenos"> 93</span>Patch bottom face <span class="m">2</span>: face area vector <span class="o">(</span><span class="m">0</span> -0.0001 <span class="m">0</span><span class="o">)</span>
<span class="linenos"> 94</span>Patch bottom face <span class="m">2</span>: face area <span class="m">0</span>.0001
<span class="linenos"> 95</span>Patch bottom face <span class="m">2</span>: face delta coeff <span class="m">200</span>
<span class="linenos"> 96</span>Patch bottom face <span class="m">2</span>: owner cell <span class="m">2</span>
<span class="linenos"> 97</span>Patch bottom face <span class="m">3</span>: face center <span class="o">(</span>-0.015 -0.015 <span class="m">0</span>.005<span class="o">)</span>
<span class="linenos"> 98</span>Patch bottom face <span class="m">3</span>: face area vector <span class="o">(</span><span class="m">0</span> -0.0001 <span class="m">0</span><span class="o">)</span>
<span class="linenos"> 99</span>Patch bottom face <span class="m">3</span>: face area <span class="m">0</span>.0001
<span class="linenos">100</span>Patch bottom face <span class="m">3</span>: face delta coeff <span class="m">200</span>
<span class="linenos">101</span>Patch bottom face <span class="m">3</span>: owner cell <span class="m">3</span>
<span class="linenos">102</span>Patch bottom face <span class="m">4</span>: face center <span class="o">(</span>-0.005 -0.015 <span class="m">0</span>.005<span class="o">)</span>
<span class="linenos">103</span>Patch bottom face <span class="m">4</span>: face area vector <span class="o">(</span><span class="m">0</span> -0.0001 <span class="m">0</span><span class="o">)</span>
<span class="linenos">104</span>Patch bottom face <span class="m">4</span>: face area <span class="m">0</span>.0001
<span class="linenos">105</span>Patch bottom face <span class="m">4</span>: face delta coeff <span class="m">200</span>
<span class="linenos">106</span>Patch bottom face <span class="m">4</span>: owner cell <span class="m">4</span>
<span class="linenos">107</span>Patch bottom face <span class="m">5</span>: face center <span class="o">(</span><span class="m">0</span>.005 -0.015 <span class="m">0</span>.005<span class="o">)</span>
<span class="linenos">108</span>Patch bottom face <span class="m">5</span>: face area vector <span class="o">(</span><span class="m">0</span> -0.0001 <span class="m">0</span><span class="o">)</span>
<span class="linenos">109</span>Patch bottom face <span class="m">5</span>: face area <span class="m">0</span>.0001
<span class="linenos">110</span>Patch bottom face <span class="m">5</span>: face delta coeff <span class="m">200</span>
<span class="linenos">111</span>Patch bottom face <span class="m">5</span>: owner cell <span class="m">5</span>
<span class="linenos">112</span>Patch bottom face <span class="m">6</span>: face center <span class="o">(</span><span class="m">0</span>.015 -0.015 <span class="m">0</span>.005<span class="o">)</span>
<span class="linenos">113</span>Patch bottom face <span class="m">6</span>: face area vector <span class="o">(</span><span class="m">0</span> -0.0001 <span class="m">0</span><span class="o">)</span>
<span class="linenos">114</span>Patch bottom face <span class="m">6</span>: face area <span class="m">0</span>.0001
<span class="linenos">115</span>Patch bottom face <span class="m">6</span>: face delta coeff <span class="m">200</span>
<span class="linenos">116</span>Patch bottom face <span class="m">6</span>: owner cell <span class="m">6</span>
<span class="linenos">117</span>Patch bottom face <span class="m">7</span>: face center <span class="o">(</span><span class="m">0</span>.025 -0.015 <span class="m">0</span>.005<span class="o">)</span>
<span class="linenos">118</span>Patch bottom face <span class="m">7</span>: face area vector <span class="o">(</span><span class="m">0</span> -0.0001 <span class="m">0</span><span class="o">)</span>
<span class="linenos">119</span>Patch bottom face <span class="m">7</span>: face area <span class="m">0</span>.0001
<span class="linenos">120</span>Patch bottom face <span class="m">7</span>: face delta coeff <span class="m">200</span>
<span class="linenos">121</span>Patch bottom face <span class="m">7</span>: owner cell <span class="m">7</span>
<span class="linenos">122</span>Patch bottom face <span class="m">8</span>: face center <span class="o">(</span><span class="m">0</span>.035 -0.015 <span class="m">0</span>.005<span class="o">)</span>
<span class="linenos">123</span>Patch bottom face <span class="m">8</span>: face area vector <span class="o">(</span><span class="m">0</span> -0.0001 <span class="m">0</span><span class="o">)</span>
<span class="linenos">124</span>Patch bottom face <span class="m">8</span>: face area <span class="m">0</span>.0001
<span class="linenos">125</span>Patch bottom face <span class="m">8</span>: face delta coeff <span class="m">200</span>
<span class="linenos">126</span>Patch bottom face <span class="m">8</span>: owner cell <span class="m">8</span>
<span class="linenos">127</span>Patch bottom face <span class="m">9</span>: face center <span class="o">(</span><span class="m">0</span>.045 -0.015 <span class="m">0</span>.005<span class="o">)</span>
<span class="linenos">128</span>Patch bottom face <span class="m">9</span>: face area vector <span class="o">(</span><span class="m">0</span> -0.0001 <span class="m">0</span><span class="o">)</span>
<span class="linenos">129</span>Patch bottom face <span class="m">9</span>: face area <span class="m">0</span>.0001
<span class="linenos">130</span>Patch bottom face <span class="m">9</span>: face delta coeff <span class="m">200</span>
<span class="linenos">131</span>Patch bottom face <span class="m">9</span>: owner cell <span class="m">9</span>
</pre></div>
</div>
</div>
</div>
<input class="tab-input" id="tab-set--6-input--5" name="tab-set--6" type="radio"><label class="tab-label" for="tab-set--6-input--5">Boundary T</label><div class="tab-content docutils container">
<div class="literal-block-wrapper docutils container" id="lst-log-boundaryt">
<div class="code-block-caption"><span class="caption-number">Listing 28 </span><span class="caption-text">Boundary properties of field T of the regular mesh shown in <a class="reference internal" href="#fig-polymesh-regularbox"><span class="std std-numref">Fig. 34</span></a>.</span><a class="headerlink" href="#lst-log-boundaryt" title="Permalink to this code"></a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="m">0</span><span class="o">()</span>Boundary patch: left
<span class="linenos"> 2</span>Is coupled ? <span class="m">0</span>
<span class="linenos"> 3</span>gradientInternalCoeffs of field T 
<span class="linenos"> 4</span><span class="m">3</span><span class="o">(</span>-200 -200 -200<span class="o">)</span>
<span class="linenos"> 5</span>gradientBoundaryCoeffs of field T 
<span class="linenos"> 6</span><span class="m">3</span><span class="o">(</span><span class="m">54600</span> <span class="m">54600</span> <span class="m">54600</span><span class="o">)</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span>Boundary patch: right
<span class="linenos"> 9</span>Is coupled ? <span class="m">0</span>
<span class="linenos">10</span>gradientInternalCoeffs of field T 
<span class="linenos">11</span><span class="m">3</span><span class="o">(</span>-200 -200 -200<span class="o">)</span>
<span class="linenos">12</span>gradientBoundaryCoeffs of field T 
<span class="linenos">13</span><span class="m">3</span><span class="o">(</span><span class="m">114600</span> <span class="m">114600</span> <span class="m">114600</span><span class="o">)</span>
<span class="linenos">14</span>
<span class="linenos">15</span>Boundary patch: top
<span class="linenos">16</span>Is coupled ? <span class="m">0</span>
<span class="linenos">17</span>gradientInternalCoeffs of field T 
<span class="linenos">18</span><span class="m">10</span><span class="o">{</span><span class="m">0</span><span class="o">}</span>
<span class="linenos">19</span>gradientBoundaryCoeffs of field T 
<span class="linenos">20</span><span class="m">10</span><span class="o">{</span><span class="m">0</span><span class="o">}</span>
<span class="linenos">21</span>
<span class="linenos">22</span>Boundary patch: bottom
<span class="linenos">23</span>Is coupled ? <span class="m">0</span>
<span class="linenos">24</span>gradientInternalCoeffs of field T 
<span class="linenos">25</span><span class="m">10</span><span class="o">{</span><span class="m">0</span><span class="o">}</span>
<span class="linenos">26</span>gradientBoundaryCoeffs of field T 
<span class="linenos">27</span><span class="m">10</span><span class="o">{</span><span class="m">0</span><span class="o">}</span>
<span class="linenos">28</span>
<span class="linenos">29</span>Boundary patch: frontAndBack
<span class="linenos">30</span>Is coupled ? <span class="m">0</span>
<span class="linenos">31</span>gradientInternalCoeffs of field T 
<span class="linenos">32</span><span class="m">0</span><span class="o">()</span>
<span class="linenos">33</span>gradientBoundaryCoeffs of field T 
<span class="linenos">34</span><span class="m">0</span><span class="o">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--5-input--1" name="tab-set--5" type="radio"><label class="tab-label" for="tab-set--5-input--1">Internal cell</label><div class="tab-content docutils container">
<figure class="align-center" id="fig-deltacoeff-internalcell">
<a class="reference internal image-reference" href="../../_images/Coordinate_delta_internalcell_regularBox.svg"><img alt="../../_images/Coordinate_delta_internalcell_regularBox.svg" src="../../_images/Coordinate_delta_internalcell_regularBox.svg" width="100%" /></a>
<figcaption>
<p><span class="caption-number">Fig. 39 </span><span class="caption-text">Information of internal cell (<span class="math notranslate nohighlight">\(C_{12}\)</span>)</span><a class="headerlink" href="#fig-deltacoeff-internalcell" title="Permalink to this image"></a></p>
</figcaption>
</figure>
</div>
<input class="tab-input" id="tab-set--5-input--2" name="tab-set--5" type="radio"><label class="tab-label" for="tab-set--5-input--2">Boundary cell</label><div class="tab-content docutils container">
<figure class="align-center" id="fig-deltacoeff-boundarycell">
<a class="reference internal image-reference" href="../../_images/Coordinate_delta_boundary_regularBox.svg"><img alt="../../_images/Coordinate_delta_boundary_regularBox.svg" src="../../_images/Coordinate_delta_boundary_regularBox.svg" width="100%" /></a>
<figcaption>
<p><span class="caption-number">Fig. 40 </span><span class="caption-text">Information of boundary cell (<span class="math notranslate nohighlight">\(C_{19}\)</span>)</span><a class="headerlink" href="#fig-deltacoeff-boundarycell" title="Permalink to this image"></a></p>
</figcaption>
</figure>
</div>
</div>
</section>
<section id="step-2-discretize-laplacian-term">
<span id="of-fvmlaplacian"></span><h3>Step 2, discretize Laplacian term<a class="headerlink" href="#step-2-discretize-laplacian-term" title="Permalink to this headline"></a></h3>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--8-input--1" name="tab-set--8" type="radio"><label class="tab-label" for="tab-set--8-input--1">discretize Laplacian term</label><div class="tab-content docutils container">
<p>Because discretization coefficients matrix of Laplacian term is a symmetric matrix, so <code class="code docutils literal notranslate"><span class="pre">fvm::Laplacian(DT,</span> <span class="pre">T)</span></code> will return a fvMatrix object only has diagonal and upper.
What <code class="code docutils literal notranslate"><span class="pre">fvm::Laplacian</span></code> actually did is evaluate (1) <span class="math notranslate nohighlight">\(a_F\)</span> (see <a class="reference internal" href="#equation-eq-fvm-matrix-form-internalcell">equation (37)</a>) for each internal faces, (2) <span class="math notranslate nohighlight">\(a_C\)</span> for each cells, which is the negative summation of <span class="math notranslate nohighlight">\(a_F\)</span>, (3) store the field BCs-related coefficients as <code class="code docutils literal notranslate"><span class="pre">internalCoeffs</span></code> and <code class="code docutils literal notranslate"><span class="pre">boundaryCoeffs</span></code>, respectively.
All of these are implemented in <a class="reference external" href="https://cpp.openfoam.org/v6/gaussLaplacianScheme_8C_source.html#l00047">gaussLaplacianScheme.C</a> . <strong>Note that</strong> the <code class="code docutils literal notranslate"><span class="pre">Gaussian</span></code> scheme is the only choice for Laplacian discretization in OF.</p>
</div>
<input class="tab-input" id="tab-set--8-input--2" name="tab-set--8" type="radio"><label class="tab-label" for="tab-set--8-input--2">Access Laplacian coeffs</label><div class="tab-content docutils container">
<div class="literal-block-wrapper docutils container" id="lst-access-laplacian">
<div class="code-block-caption"><span class="caption-number">Listing 29 </span><span class="caption-text">Access fvm::Laplacian discretization</span><a class="headerlink" href="#lst-access-laplacian" title="Permalink to this code"></a></div>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="n">fvScalarMatrix</span><span class="w"> </span><span class="nf">Laplacian</span><span class="p">(</span><span class="n">fvm</span><span class="o">::</span><span class="n">laplacian</span><span class="p">(</span><span class="n">DT</span><span class="p">,</span><span class="w"> </span><span class="n">T</span><span class="p">));</span><span class="w"></span>
<span class="linenos">2</span><span class="n">Info</span><span class="o">&lt;&lt;</span><span class="s">&quot;fvm::laplacian(DT, T): &quot;</span><span class="o">&lt;&lt;</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="w"></span>
<span class="linenos">3</span><span class="w">   </span><span class="o">&lt;&lt;</span><span class="s">&quot;</span><span class="se">\t</span><span class="s">Lower&quot;</span><span class="o">&lt;&lt;</span><span class="n">Laplacian</span><span class="p">.</span><span class="n">lower</span><span class="p">()</span><span class="o">&lt;&lt;</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="w"></span>
<span class="linenos">4</span><span class="w">   </span><span class="o">&lt;&lt;</span><span class="s">&quot;</span><span class="se">\t</span><span class="s">Diagonal&quot;</span><span class="o">&lt;&lt;</span><span class="n">Laplacian</span><span class="p">.</span><span class="n">diag</span><span class="p">()</span><span class="o">&lt;&lt;</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="w"></span>
<span class="linenos">5</span><span class="w">   </span><span class="o">&lt;&lt;</span><span class="s">&quot;</span><span class="se">\t</span><span class="s">Upper&quot;</span><span class="o">&lt;&lt;</span><span class="n">Laplacian</span><span class="p">.</span><span class="n">upper</span><span class="p">()</span><span class="o">&lt;&lt;</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="w"></span>
<span class="linenos">6</span><span class="w">   </span><span class="o">&lt;&lt;</span><span class="s">&quot;</span><span class="se">\t</span><span class="s">internalCoeffs&quot;</span><span class="o">&lt;&lt;</span><span class="n">Laplacian</span><span class="p">.</span><span class="n">internalCoeffs</span><span class="p">()</span><span class="o">&lt;&lt;</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="w"></span>
<span class="linenos">7</span><span class="w">   </span><span class="o">&lt;&lt;</span><span class="s">&quot;</span><span class="se">\t</span><span class="s">boundaryCoeffs&quot;</span><span class="o">&lt;&lt;</span><span class="n">Laplacian</span><span class="p">.</span><span class="n">boundaryCoeffs</span><span class="p">()</span><span class="o">&lt;&lt;</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="w"></span>
<span class="linenos">8</span><span class="w">   </span><span class="o">&lt;&lt;</span><span class="s">&quot;</span><span class="se">\t</span><span class="s">Source&quot;</span><span class="o">&lt;&lt;</span><span class="n">Laplacian</span><span class="p">.</span><span class="n">source</span><span class="p">()</span><span class="o">&lt;&lt;</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="w"></span>
<span class="linenos">9</span><span class="w">   </span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The source coefficients come from BCs are not stored in the <code class="code docutils literal notranslate"><span class="pre">.source()</span></code>, but in <code class="code docutils literal notranslate"><span class="pre">boundaryCoeffs</span></code>.
So if you print <code class="code docutils literal notranslate"><span class="pre">Laplacian.source()</span></code>, it will display zero.
The BCs-related source will be added into the <code class="code docutils literal notranslate"><span class="pre">TEqn.source</span></code> when <code class="code docutils literal notranslate"><span class="pre">TEqn.solve()</span></code> is calling.
There is a protected member function named <code class="code docutils literal notranslate"><span class="pre">addBoundarySource</span></code> will be called in <code class="code docutils literal notranslate"><span class="pre">solve()</span></code> function.</p>
</div>
</div>
<input class="tab-input" id="tab-set--8-input--3" name="tab-set--8" type="radio"><label class="tab-label" for="tab-set--8-input--3">Source code of Laplacian</label><div class="tab-content docutils container">
<div class="literal-block-wrapper docutils container" id="lst-source-fvm-laplacian">
<div class="code-block-caption"><span class="caption-number">Listing 30 </span><span class="caption-text">Key source code of fvm::Laplacian (<a class="reference external" href="https://cpp.openfoam.org/v6/gaussLaplacianScheme_8C_source.html#l00047">gaussLaplacianScheme.C</a> before nonOrthogonal correcting)</span><a class="headerlink" href="#lst-source-fvm-laplacian" title="Permalink to this code"></a></div>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="k">template</span><span class="o">&lt;</span><span class="k">class</span><span class="w"> </span><span class="nc">Type</span><span class="p">,</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">GType</span><span class="o">&gt;</span><span class="w"></span>
<span class="linenos"> 2</span><span class="n">tmp</span><span class="o">&lt;</span><span class="n">fvMatrix</span><span class="o">&lt;</span><span class="n">Type</span><span class="o">&gt;&gt;</span><span class="w"></span>
<span class="linenos"> 3</span><span class="n">gaussLaplacianScheme</span><span class="o">&lt;</span><span class="n">Type</span><span class="p">,</span><span class="w"> </span><span class="n">GType</span><span class="o">&gt;::</span><span class="n">fvmLaplacianUncorrected</span><span class="w"></span>
<span class="linenos"> 4</span><span class="p">(</span><span class="w"></span>
<span class="linenos"> 5</span><span class="w">   </span><span class="k">const</span><span class="w"> </span><span class="n">surfaceScalarField</span><span class="o">&amp;</span><span class="w"> </span><span class="n">gammaMagSf</span><span class="p">,</span><span class="w"></span>
<span class="linenos"> 6</span><span class="w">   </span><span class="k">const</span><span class="w"> </span><span class="n">surfaceScalarField</span><span class="o">&amp;</span><span class="w"> </span><span class="n">deltaCoeffs</span><span class="p">,</span><span class="w"></span>
<span class="linenos"> 7</span><span class="w">   </span><span class="k">const</span><span class="w"> </span><span class="n">GeometricField</span><span class="o">&lt;</span><span class="n">Type</span><span class="p">,</span><span class="w"> </span><span class="n">fvPatchField</span><span class="p">,</span><span class="w"> </span><span class="n">volMesh</span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="n">vf</span><span class="w"></span>
<span class="linenos"> 8</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 9</span><span class="p">{</span><span class="w"></span>
<span class="linenos">10</span><span class="w">   </span><span class="n">tmp</span><span class="o">&lt;</span><span class="n">fvMatrix</span><span class="o">&lt;</span><span class="n">Type</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">tfvm</span><span class="w"></span>
<span class="linenos">11</span><span class="w">   </span><span class="p">(</span><span class="w"></span>
<span class="linenos">12</span><span class="w">      </span><span class="k">new</span><span class="w"> </span><span class="n">fvMatrix</span><span class="o">&lt;</span><span class="n">Type</span><span class="o">&gt;</span><span class="w"></span>
<span class="linenos">13</span><span class="w">      </span><span class="p">(</span><span class="w"></span>
<span class="linenos">14</span><span class="w">            </span><span class="n">vf</span><span class="p">,</span><span class="w"></span>
<span class="hll"><span class="linenos">15</span><span class="w">            </span><span class="n">deltaCoeffs</span><span class="p">.</span><span class="n">dimensions</span><span class="p">()</span><span class="o">*</span><span class="n">gammaMagSf</span><span class="p">.</span><span class="n">dimensions</span><span class="p">()</span><span class="o">*</span><span class="n">vf</span><span class="p">.</span><span class="n">dimensions</span><span class="p">()</span><span class="w"></span>
</span><span class="linenos">16</span><span class="w">      </span><span class="p">)</span><span class="w"></span>
<span class="linenos">17</span><span class="w">   </span><span class="p">);</span><span class="w"></span>
<span class="linenos">18</span><span class="w">   </span><span class="n">fvMatrix</span><span class="o">&lt;</span><span class="n">Type</span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="n">fvm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tfvm</span><span class="p">.</span><span class="n">ref</span><span class="p">();</span><span class="w"></span>
<span class="linenos">19</span>
<span class="hll"><span class="linenos">20</span><span class="w">   </span><span class="n">fvm</span><span class="p">.</span><span class="n">upper</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">deltaCoeffs</span><span class="p">.</span><span class="n">primitiveField</span><span class="p">()</span><span class="o">*</span><span class="n">gammaMagSf</span><span class="p">.</span><span class="n">primitiveField</span><span class="p">();</span><span class="w"></span>
</span><span class="linenos">21</span><span class="w">   </span><span class="n">fvm</span><span class="p">.</span><span class="n">negSumDiag</span><span class="p">();</span><span class="w"></span>
<span class="linenos">22</span>
<span class="linenos">23</span><span class="w">   </span><span class="n">forAll</span><span class="p">(</span><span class="n">vf</span><span class="p">.</span><span class="n">boundaryField</span><span class="p">(),</span><span class="w"> </span><span class="n">patchi</span><span class="p">)</span><span class="w"></span>
<span class="linenos">24</span><span class="w">   </span><span class="p">{</span><span class="w"></span>
<span class="linenos">25</span><span class="w">      </span><span class="k">const</span><span class="w"> </span><span class="n">fvPatchField</span><span class="o">&lt;</span><span class="n">Type</span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="n">pvf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vf</span><span class="p">.</span><span class="n">boundaryField</span><span class="p">()[</span><span class="n">patchi</span><span class="p">];</span><span class="w"></span>
<span class="linenos">26</span><span class="w">      </span><span class="k">const</span><span class="w"> </span><span class="n">fvsPatchScalarField</span><span class="o">&amp;</span><span class="w"> </span><span class="n">pGamma</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gammaMagSf</span><span class="p">.</span><span class="n">boundaryField</span><span class="p">()[</span><span class="n">patchi</span><span class="p">];</span><span class="w"></span>
<span class="linenos">27</span><span class="w">      </span><span class="k">const</span><span class="w"> </span><span class="n">fvsPatchScalarField</span><span class="o">&amp;</span><span class="w"> </span><span class="n">pDeltaCoeffs</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="linenos">28</span><span class="w">            </span><span class="n">deltaCoeffs</span><span class="p">.</span><span class="n">boundaryField</span><span class="p">()[</span><span class="n">patchi</span><span class="p">];</span><span class="w"></span>
<span class="linenos">29</span>
<span class="linenos">30</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">pvf</span><span class="p">.</span><span class="n">coupled</span><span class="p">())</span><span class="w"></span>
<span class="linenos">31</span><span class="w">      </span><span class="p">{</span><span class="w"></span>
<span class="linenos">32</span><span class="w">            </span><span class="n">fvm</span><span class="p">.</span><span class="n">internalCoeffs</span><span class="p">()[</span><span class="n">patchi</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="linenos">33</span><span class="w">               </span><span class="n">pGamma</span><span class="o">*</span><span class="n">pvf</span><span class="p">.</span><span class="n">gradientInternalCoeffs</span><span class="p">(</span><span class="n">pDeltaCoeffs</span><span class="p">);</span><span class="w"></span>
<span class="linenos">34</span><span class="w">            </span><span class="n">fvm</span><span class="p">.</span><span class="n">boundaryCoeffs</span><span class="p">()[</span><span class="n">patchi</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="linenos">35</span><span class="w">               </span><span class="o">-</span><span class="n">pGamma</span><span class="o">*</span><span class="n">pvf</span><span class="p">.</span><span class="n">gradientBoundaryCoeffs</span><span class="p">(</span><span class="n">pDeltaCoeffs</span><span class="p">);</span><span class="w"></span>
<span class="linenos">36</span><span class="w">      </span><span class="p">}</span><span class="w"></span>
<span class="linenos">37</span><span class="w">      </span><span class="k">else</span><span class="w"></span>
<span class="linenos">38</span><span class="w">      </span><span class="p">{</span><span class="w"></span>
<span class="hll"><span class="linenos">39</span><span class="w">            </span><span class="n">fvm</span><span class="p">.</span><span class="n">internalCoeffs</span><span class="p">()[</span><span class="n">patchi</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pGamma</span><span class="o">*</span><span class="n">pvf</span><span class="p">.</span><span class="n">gradientInternalCoeffs</span><span class="p">();</span><span class="w"></span>
</span><span class="hll"><span class="linenos">40</span><span class="w">            </span><span class="n">fvm</span><span class="p">.</span><span class="n">boundaryCoeffs</span><span class="p">()[</span><span class="n">patchi</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">pGamma</span><span class="o">*</span><span class="n">pvf</span><span class="p">.</span><span class="n">gradientBoundaryCoeffs</span><span class="p">();</span><span class="w"></span>
</span><span class="linenos">41</span><span class="w">      </span><span class="p">}</span><span class="w"></span>
<span class="linenos">42</span><span class="w">   </span><span class="p">}</span><span class="w"></span>
<span class="linenos">43</span>
<span class="linenos">44</span><span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="n">tfvm</span><span class="p">;</span><span class="w"></span>
<span class="linenos">45</span><span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<input class="tab-input" id="tab-set--8-input--4" name="tab-set--8" type="radio"><label class="tab-label" for="tab-set--8-input--4">Laplacian coefficients</label><div class="tab-content docutils container">
<div class="literal-block-wrapper docutils container" id="lst-log-fvm-laplacian">
<div class="code-block-caption"><span class="caption-number">Listing 31 </span><span class="caption-text">fvm::Laplacian Coefficients  of the regular mesh shown in <a class="reference internal" href="#fig-polymesh-regularbox"><span class="std std-numref">Fig. 34</span></a>.</span><a class="headerlink" href="#lst-log-fvm-laplacian" title="Permalink to this code"></a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="linenos">  1</span><span class="o">)</span>
<span class="linenos">  2</span>fvm::laplacian<span class="o">(</span>DT, T<span class="o">)</span>: 
<span class="linenos">  3</span>	Lower
<span class="linenos">  4</span><span class="m">47</span>
<span class="linenos">  5</span><span class="o">(</span>
<span class="linenos">  6</span>4e-07
<span class="linenos">  7</span>4e-07
<span class="linenos">  8</span>4e-07
<span class="linenos">  9</span>4e-07
<span class="linenos"> 10</span>4e-07
<span class="linenos"> 11</span>4e-07
<span class="linenos"> 12</span>4e-07
<span class="linenos"> 13</span>4e-07
<span class="linenos"> 14</span>4e-07
<span class="linenos"> 15</span>4e-07
<span class="linenos"> 16</span>4e-07
<span class="linenos"> 17</span>4e-07
<span class="linenos"> 18</span>4e-07
<span class="linenos"> 19</span>4e-07
<span class="linenos"> 20</span>4e-07
<span class="linenos"> 21</span>4e-07
<span class="linenos"> 22</span>4e-07
<span class="linenos"> 23</span>4e-07
<span class="linenos"> 24</span>4e-07
<span class="linenos"> 25</span>4e-07
<span class="linenos"> 26</span>4e-07
<span class="linenos"> 27</span>4e-07
<span class="linenos"> 28</span>4e-07
<span class="linenos"> 29</span>4e-07
<span class="linenos"> 30</span>4e-07
<span class="linenos"> 31</span>4e-07
<span class="linenos"> 32</span>4e-07
<span class="linenos"> 33</span>4e-07
<span class="linenos"> 34</span>4e-07
<span class="linenos"> 35</span>4e-07
<span class="linenos"> 36</span>4e-07
<span class="linenos"> 37</span>4e-07
<span class="linenos"> 38</span>4e-07
<span class="linenos"> 39</span>4e-07
<span class="linenos"> 40</span>4e-07
<span class="linenos"> 41</span>4e-07
<span class="linenos"> 42</span>4e-07
<span class="linenos"> 43</span>4e-07
<span class="linenos"> 44</span>4e-07
<span class="linenos"> 45</span>4e-07
<span class="linenos"> 46</span>4e-07
<span class="linenos"> 47</span>4e-07
<span class="linenos"> 48</span>4e-07
<span class="linenos"> 49</span>4e-07
<span class="linenos"> 50</span>4e-07
<span class="linenos"> 51</span>4e-07
<span class="linenos"> 52</span>4e-07
<span class="linenos"> 53</span><span class="o">)</span>
<span class="linenos"> 54</span>
<span class="linenos"> 55</span>	Diagonal
<span class="linenos"> 56</span><span class="m">30</span>
<span class="linenos"> 57</span><span class="o">(</span>
<span class="hll"><span class="linenos"> 58</span>-8e-07			//0
</span><span class="linenos"> 59</span>-1.2e-06
<span class="linenos"> 60</span>-1.2e-06
<span class="linenos"> 61</span>-1.2e-06
<span class="linenos"> 62</span>-1.2e-06
<span class="hll"><span class="linenos"> 63</span>-1.2e-06		//5
</span><span class="linenos"> 64</span>-1.2e-06
<span class="linenos"> 65</span>-1.2e-06
<span class="linenos"> 66</span>-1.2e-06
<span class="hll"><span class="linenos"> 67</span>-8e-07			//9
</span><span class="hll"><span class="linenos"> 68</span>-1.2e-06		//10
</span><span class="linenos"> 69</span>-1.6e-06
<span class="hll"><span class="linenos"> 70</span>-1.6e-06		//12
</span><span class="linenos"> 71</span>-1.6e-06
<span class="linenos"> 72</span>-1.6e-06
<span class="linenos"> 73</span>-1.6e-06
<span class="linenos"> 74</span>-1.6e-06
<span class="linenos"> 75</span>-1.6e-06
<span class="linenos"> 76</span>-1.6e-06
<span class="hll"><span class="linenos"> 77</span>-1.2e-06		//19
</span><span class="linenos"> 78</span>-8e-07
<span class="linenos"> 79</span>-1.2e-06
<span class="linenos"> 80</span>-1.2e-06
<span class="linenos"> 81</span>-1.2e-06
<span class="linenos"> 82</span>-1.2e-06
<span class="linenos"> 83</span>-1.2e-06
<span class="linenos"> 84</span>-1.2e-06
<span class="linenos"> 85</span>-1.2e-06
<span class="linenos"> 86</span>-1.2e-06
<span class="linenos"> 87</span>-8e-07
<span class="linenos"> 88</span><span class="o">)</span>
<span class="linenos"> 89</span>
<span class="linenos"> 90</span>	Upper
<span class="linenos"> 91</span><span class="m">47</span>
<span class="linenos"> 92</span><span class="o">(</span>
<span class="linenos"> 93</span>4e-07
<span class="linenos"> 94</span>4e-07
<span class="linenos"> 95</span>4e-07
<span class="linenos"> 96</span>4e-07
<span class="linenos"> 97</span>4e-07
<span class="linenos"> 98</span>4e-07
<span class="linenos"> 99</span>4e-07
<span class="linenos">100</span>4e-07
<span class="linenos">101</span>4e-07
<span class="linenos">102</span>4e-07
<span class="linenos">103</span>4e-07
<span class="linenos">104</span>4e-07
<span class="linenos">105</span>4e-07
<span class="linenos">106</span>4e-07
<span class="linenos">107</span>4e-07
<span class="linenos">108</span>4e-07
<span class="linenos">109</span>4e-07
<span class="linenos">110</span>4e-07
<span class="linenos">111</span>4e-07
<span class="linenos">112</span>4e-07
<span class="linenos">113</span>4e-07
<span class="linenos">114</span>4e-07
<span class="linenos">115</span>4e-07
<span class="linenos">116</span>4e-07
<span class="linenos">117</span>4e-07
<span class="linenos">118</span>4e-07
<span class="linenos">119</span>4e-07
<span class="linenos">120</span>4e-07
<span class="linenos">121</span>4e-07
<span class="linenos">122</span>4e-07
<span class="linenos">123</span>4e-07
<span class="linenos">124</span>4e-07
<span class="linenos">125</span>4e-07
<span class="linenos">126</span>4e-07
<span class="linenos">127</span>4e-07
<span class="linenos">128</span>4e-07
<span class="linenos">129</span>4e-07
<span class="linenos">130</span>4e-07
<span class="linenos">131</span>4e-07
<span class="linenos">132</span>4e-07
<span class="linenos">133</span>4e-07
<span class="linenos">134</span>4e-07
<span class="linenos">135</span>4e-07
<span class="linenos">136</span>4e-07
<span class="linenos">137</span>4e-07
<span class="linenos">138</span>4e-07
<span class="linenos">139</span>4e-07
<span class="linenos">140</span><span class="o">)</span>
<span class="linenos">141</span>
<span class="linenos">142</span>	internalCoeffs
<span class="linenos">143</span><span class="m">5</span>
<span class="linenos">144</span><span class="o">(</span>
<span class="linenos">145</span><span class="m">3</span><span class="o">(</span>-8e-07 -8e-07 -8e-07<span class="o">)</span>
<span class="linenos">146</span><span class="m">3</span><span class="o">(</span>-8e-07 -8e-07 -8e-07<span class="o">)</span>
<span class="linenos">147</span><span class="m">10</span><span class="o">{</span><span class="m">0</span><span class="o">}</span>
<span class="linenos">148</span><span class="m">10</span><span class="o">{</span><span class="m">0</span><span class="o">}</span>
<span class="linenos">149</span><span class="m">0</span><span class="o">()</span>
<span class="linenos">150</span><span class="o">)</span>
<span class="linenos">151</span>
<span class="linenos">152</span>	boundaryCoeffs
<span class="linenos">153</span><span class="m">5</span>
<span class="linenos">154</span><span class="o">(</span>
<span class="linenos">155</span><span class="m">3</span><span class="o">(</span>-0.0002184 -0.0002184 -0.0002184<span class="o">)</span>
<span class="linenos">156</span><span class="m">3</span><span class="o">(</span>-0.0004584 -0.0004584 -0.0004584<span class="o">)</span>
<span class="linenos">157</span><span class="m">10</span><span class="o">{</span>-0<span class="o">}</span>
<span class="linenos">158</span><span class="m">10</span><span class="o">{</span>-0<span class="o">}</span>
<span class="linenos">159</span><span class="m">0</span><span class="o">()</span>
<span class="linenos">160</span><span class="o">)</span>
<span class="linenos">161</span>
<span class="linenos">162</span>	Source
<span class="linenos">163</span><span class="m">30</span>
<span class="linenos">164</span><span class="o">(</span>
<span class="linenos">165</span><span class="m">0</span>
<span class="linenos">166</span><span class="m">1</span>.20371e-36
<span class="linenos">167</span>-1.20371e-36
<span class="linenos">168</span>-1.20371e-36
<span class="linenos">169</span><span class="m">1</span>.20371e-36
<span class="linenos">170</span><span class="m">1</span>.20371e-36
<span class="linenos">171</span><span class="m">1</span>.67048e-52
<span class="linenos">172</span>-1.20371e-36
<span class="linenos">173</span><span class="m">2</span>.40741e-36
<span class="linenos">174</span>-1.66533e-19
<span class="linenos">175</span><span class="m">0</span>
<span class="linenos">176</span><span class="m">0</span>
<span class="linenos">177</span><span class="m">0</span>
<span class="linenos">178</span><span class="m">0</span>
<span class="linenos">179</span><span class="m">0</span>
<span class="linenos">180</span><span class="m">0</span>
<span class="linenos">181</span><span class="m">0</span>
<span class="linenos">182</span><span class="m">0</span>
<span class="linenos">183</span><span class="m">0</span>
<span class="linenos">184</span><span class="m">1</span>.66533e-19
<span class="linenos">185</span><span class="m">0</span>
<span class="linenos">186</span><span class="m">0</span>
<span class="linenos">187</span><span class="m">0</span>
<span class="linenos">188</span><span class="m">0</span>
<span class="linenos">189</span><span class="m">0</span>
<span class="linenos">190</span><span class="m">0</span>
<span class="linenos">191</span><span class="m">0</span>
<span class="linenos">192</span><span class="m">0</span>
<span class="linenos">193</span><span class="m">0</span>
<span class="linenos">194</span><span class="m">0</span>
<span class="linenos">195</span><span class="o">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--7-input--1" name="tab-set--7" type="radio"><label class="tab-label" for="tab-set--7-input--1">Internal cell</label><div class="tab-content docutils container">
<figure class="align-center" id="fig-laplaciancoeff-internalcell">
<a class="reference internal image-reference" href="../../_images/Coordinate_Laplacian_internalcell_regularBox.svg"><img alt="../../_images/Coordinate_Laplacian_internalcell_regularBox.svg" src="../../_images/Coordinate_Laplacian_internalcell_regularBox.svg" width="100%" /></a>
<figcaption>
<p><span class="caption-number">Fig. 41 </span><span class="caption-text">Information of internal cell (<span class="math notranslate nohighlight">\(C_{12}\)</span>)</span><a class="headerlink" href="#fig-laplaciancoeff-internalcell" title="Permalink to this image"></a></p>
</figcaption>
</figure>
</div>
<input class="tab-input" id="tab-set--7-input--2" name="tab-set--7" type="radio"><label class="tab-label" for="tab-set--7-input--2">Boundary cell 19</label><div class="tab-content docutils container">
<figure class="align-center" id="fig-laplaciancoeff-boundarycell">
<a class="reference internal image-reference" href="../../_images/Coordinate_Laplacian_boundary_C19_regularBox.svg"><img alt="../../_images/Coordinate_Laplacian_boundary_C19_regularBox.svg" src="../../_images/Coordinate_Laplacian_boundary_C19_regularBox.svg" width="100%" /></a>
<figcaption>
<p><span class="caption-number">Fig. 42 </span><span class="caption-text">Information of boundary cell (<span class="math notranslate nohighlight">\(C_{19}\)</span>)</span><a class="headerlink" href="#fig-laplaciancoeff-boundarycell" title="Permalink to this image"></a></p>
</figcaption>
</figure>
</div>
<input class="tab-input" id="tab-set--7-input--3" name="tab-set--7" type="radio"><label class="tab-label" for="tab-set--7-input--3">Boundary cell 9</label><div class="tab-content docutils container">
<figure class="align-center" id="id5">
<a class="reference internal image-reference" href="../../_images/Coordinate_Laplacian_boundary_C9_regularBox.svg"><img alt="../../_images/Coordinate_Laplacian_boundary_C9_regularBox.svg" src="../../_images/Coordinate_Laplacian_boundary_C9_regularBox.svg" width="100%" /></a>
<figcaption>
<p><span class="caption-number">Fig. 43 </span><span class="caption-text">Information of boundary cell (<span class="math notranslate nohighlight">\(C_{9}\)</span>)</span><a class="headerlink" href="#id5" title="Permalink to this image"></a></p>
</figcaption>
</figure>
</div>
<input class="tab-input" id="tab-set--7-input--4" name="tab-set--7" type="radio"><label class="tab-label" for="tab-set--7-input--4">Boundary cell 0</label><div class="tab-content docutils container">
<figure class="align-center" id="id6">
<a class="reference internal image-reference" href="../../_images/Coordinate_Laplacian_boundary_C0_regularBox.svg"><img alt="../../_images/Coordinate_Laplacian_boundary_C0_regularBox.svg" src="../../_images/Coordinate_Laplacian_boundary_C0_regularBox.svg" width="100%" /></a>
<figcaption>
<p><span class="caption-number">Fig. 44 </span><span class="caption-text">Information of boundary cell (<span class="math notranslate nohighlight">\(C_{0}\)</span>)</span><a class="headerlink" href="#id6" title="Permalink to this image"></a></p>
</figcaption>
</figure>
</div>
<input class="tab-input" id="tab-set--7-input--5" name="tab-set--7" type="radio"><label class="tab-label" for="tab-set--7-input--5">Boundary cell 10</label><div class="tab-content docutils container">
<figure class="align-center" id="id7">
<a class="reference internal image-reference" href="../../_images/Coordinate_Laplacian_boundary_C10_regularBox.svg"><img alt="../../_images/Coordinate_Laplacian_boundary_C10_regularBox.svg" src="../../_images/Coordinate_Laplacian_boundary_C10_regularBox.svg" width="100%" /></a>
<figcaption>
<p><span class="caption-number">Fig. 45 </span><span class="caption-text">Information of boundary cell (<span class="math notranslate nohighlight">\(C_{10}\)</span>)</span><a class="headerlink" href="#id7" title="Permalink to this image"></a></p>
</figcaption>
</figure>
</div>
<input class="tab-input" id="tab-set--7-input--6" name="tab-set--7" type="radio"><label class="tab-label" for="tab-set--7-input--6">Boundary cell 5</label><div class="tab-content docutils container">
<figure class="align-center" id="id8">
<a class="reference internal image-reference" href="../../_images/Coordinate_Laplacian_boundary_C5_regularBox.svg"><img alt="../../_images/Coordinate_Laplacian_boundary_C5_regularBox.svg" src="../../_images/Coordinate_Laplacian_boundary_C5_regularBox.svg" width="100%" /></a>
<figcaption>
<p><span class="caption-number">Fig. 46 </span><span class="caption-text">Information of boundary cell (<span class="math notranslate nohighlight">\(C_{5}\)</span>)</span><a class="headerlink" href="#id8" title="Permalink to this image"></a></p>
</figcaption>
</figure>
</div>
</div>
</section>
<section id="step-3-discretize-transient-term">
<span id="of-fvmddt"></span><h3>Step 3, discretize transient term<a class="headerlink" href="#step-3-discretize-transient-term" title="Permalink to this headline"></a></h3>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--9-input--1" name="tab-set--9" type="radio"><label class="tab-label" for="tab-set--9-input--1">discretize Laplacian term</label><div class="tab-content docutils container">
<p>For implicit discretization, <code class="code docutils literal notranslate"><span class="pre">fvm::ddt(T)</span></code> will return a fvMatrix object contains diagonal coefficients and source.
The coefficients depend on discretization scheme.
For example Euler scheme, the diagonal coefficients are calculated from <a class="reference internal" href="#equation-eq-fvm-temporal-linear">equation (53)</a> and <a class="reference internal" href="#equation-eq-fvm-firstorder-euler-imp-coeff">equation (55)</a>.
All these are implemented in <a class="reference external" href="https://cpp.openfoam.org/v6/EulerDdtScheme_8C_source.html#l00350">EulerDdtScheme.C</a>.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>There are 8 schemes for transient discretization in OpenFOAM</p>
<ol class="arabic simple">
<li><p>CoEuler</p></li>
<li><p>CrankNicolson</p></li>
<li><p>Euler</p></li>
<li><p>SLTS</p></li>
<li><p>backward</p></li>
<li><p>bounded</p></li>
<li><p>localEuler</p></li>
<li><p>steadyState</p></li>
</ol>
</div>
</div>
<input class="tab-input" id="tab-set--9-input--2" name="tab-set--9" type="radio"><label class="tab-label" for="tab-set--9-input--2">Access fvm::ddt coeffs</label><div class="tab-content docutils container">
<div class="literal-block-wrapper docutils container" id="lst-access-ddt">
<div class="code-block-caption"><span class="caption-number">Listing 32 </span><span class="caption-text">Access fvm::ddt discretization</span><a class="headerlink" href="#lst-access-ddt" title="Permalink to this code"></a></div>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="n">Info</span><span class="o">&lt;&lt;</span><span class="s">&quot;fvm::ddt(T): &quot;</span><span class="o">&lt;&lt;</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="w"></span>
<span class="linenos">2</span><span class="w">   </span><span class="o">&lt;&lt;</span><span class="s">&quot;</span><span class="se">\t</span><span class="s">Lower&quot;</span><span class="o">&lt;&lt;</span><span class="n">ddt</span><span class="p">.</span><span class="n">lower</span><span class="p">()</span><span class="o">&lt;&lt;</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="w"></span>
<span class="linenos">3</span><span class="w">   </span><span class="o">&lt;&lt;</span><span class="s">&quot;</span><span class="se">\t</span><span class="s">Diagonal&quot;</span><span class="o">&lt;&lt;</span><span class="n">ddt</span><span class="p">.</span><span class="n">diag</span><span class="p">()</span><span class="o">&lt;&lt;</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="w"></span>
<span class="linenos">4</span><span class="w">   </span><span class="o">&lt;&lt;</span><span class="s">&quot;</span><span class="se">\t</span><span class="s">Upper&quot;</span><span class="o">&lt;&lt;</span><span class="n">ddt</span><span class="p">.</span><span class="n">upper</span><span class="p">()</span><span class="o">&lt;&lt;</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="w"></span>
<span class="linenos">5</span><span class="w">   </span><span class="o">&lt;&lt;</span><span class="s">&quot;</span><span class="se">\t</span><span class="s">internalCoeffs&quot;</span><span class="o">&lt;&lt;</span><span class="n">ddt</span><span class="p">.</span><span class="n">internalCoeffs</span><span class="p">()</span><span class="o">&lt;&lt;</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="w"> </span><span class="c1">//actually this is not necessary for fvm::ddt, this is definitely equal to zero</span>
<span class="linenos">6</span><span class="w">   </span><span class="o">&lt;&lt;</span><span class="s">&quot;</span><span class="se">\t</span><span class="s">boundaryCoeffs&quot;</span><span class="o">&lt;&lt;</span><span class="n">ddt</span><span class="p">.</span><span class="n">boundaryCoeffs</span><span class="p">()</span><span class="o">&lt;&lt;</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="w"></span>
<span class="linenos">7</span><span class="w">   </span><span class="o">&lt;&lt;</span><span class="s">&quot;</span><span class="se">\t</span><span class="s">Source&quot;</span><span class="o">&lt;&lt;</span><span class="n">ddt</span><span class="p">.</span><span class="n">source</span><span class="p">()</span><span class="o">&lt;&lt;</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="w"></span>
<span class="linenos">8</span><span class="w">   </span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<input class="tab-input" id="tab-set--9-input--3" name="tab-set--9" type="radio"><label class="tab-label" for="tab-set--9-input--3">Source code of fvm::ddt</label><div class="tab-content docutils container">
<div class="literal-block-wrapper docutils container" id="lst-source-fvm-ddt">
<div class="code-block-caption"><span class="caption-number">Listing 33 </span><span class="caption-text">Key source code of fvm::ddt (<a class="reference external" href="https://cpp.openfoam.org/v6/EulerDdtScheme_8C_source.html#l00350">EulerDdtScheme.C</a> )</span><a class="headerlink" href="#lst-source-fvm-ddt" title="Permalink to this code"></a></div>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="k">template</span><span class="o">&lt;</span><span class="k">class</span><span class="w"> </span><span class="nc">Type</span><span class="o">&gt;</span><span class="w"></span>
<span class="linenos"> 2</span><span class="n">tmp</span><span class="o">&lt;</span><span class="n">fvMatrix</span><span class="o">&lt;</span><span class="n">Type</span><span class="o">&gt;&gt;</span><span class="w"></span>
<span class="linenos"> 3</span><span class="n">EulerDdtScheme</span><span class="o">&lt;</span><span class="n">Type</span><span class="o">&gt;::</span><span class="n">fvmDdt</span><span class="w"></span>
<span class="linenos"> 4</span><span class="p">(</span><span class="w"></span>
<span class="linenos"> 5</span><span class="w">   </span><span class="k">const</span><span class="w"> </span><span class="n">GeometricField</span><span class="o">&lt;</span><span class="n">Type</span><span class="p">,</span><span class="w"> </span><span class="n">fvPatchField</span><span class="p">,</span><span class="w"> </span><span class="n">volMesh</span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="n">vf</span><span class="w"></span>
<span class="linenos"> 6</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 7</span><span class="p">{</span><span class="w"></span>
<span class="linenos"> 8</span><span class="w">   </span><span class="n">tmp</span><span class="o">&lt;</span><span class="n">fvMatrix</span><span class="o">&lt;</span><span class="n">Type</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">tfvm</span><span class="w"></span>
<span class="linenos"> 9</span><span class="w">   </span><span class="p">(</span><span class="w"></span>
<span class="linenos">10</span><span class="w">      </span><span class="k">new</span><span class="w"> </span><span class="n">fvMatrix</span><span class="o">&lt;</span><span class="n">Type</span><span class="o">&gt;</span><span class="w"></span>
<span class="linenos">11</span><span class="w">      </span><span class="p">(</span><span class="w"></span>
<span class="linenos">12</span><span class="w">            </span><span class="n">vf</span><span class="p">,</span><span class="w"></span>
<span class="linenos">13</span><span class="w">            </span><span class="n">vf</span><span class="p">.</span><span class="n">dimensions</span><span class="p">()</span><span class="o">*</span><span class="n">dimVol</span><span class="o">/</span><span class="n">dimTime</span><span class="w"></span>
<span class="linenos">14</span><span class="w">      </span><span class="p">)</span><span class="w"></span>
<span class="linenos">15</span><span class="w">   </span><span class="p">);</span><span class="w"></span>
<span class="linenos">16</span>
<span class="linenos">17</span><span class="w">   </span><span class="n">fvMatrix</span><span class="o">&lt;</span><span class="n">Type</span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="n">fvm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tfvm</span><span class="p">.</span><span class="n">ref</span><span class="p">();</span><span class="w"></span>
<span class="linenos">18</span>
<span class="hll"><span class="linenos">19</span><span class="w">   </span><span class="n">scalar</span><span class="w"> </span><span class="n">rDeltaT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="o">/</span><span class="n">mesh</span><span class="p">().</span><span class="n">time</span><span class="p">().</span><span class="n">deltaTValue</span><span class="p">();</span><span class="w"> </span><span class="c1">// 1/dt</span>
</span><span class="linenos">20</span>
<span class="hll"><span class="linenos">21</span><span class="w">   </span><span class="n">fvm</span><span class="p">.</span><span class="n">diag</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rDeltaT</span><span class="o">*</span><span class="n">mesh</span><span class="p">().</span><span class="n">Vsc</span><span class="p">();</span><span class="w"> </span><span class="c1">// Vc/dt (FluxC)</span>
</span><span class="linenos">22</span>
<span class="linenos">23</span><span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">mesh</span><span class="p">().</span><span class="n">moving</span><span class="p">())</span><span class="w"></span>
<span class="linenos">24</span><span class="w">   </span><span class="p">{</span><span class="w"></span>
<span class="linenos">25</span><span class="w">      </span><span class="n">fvm</span><span class="p">.</span><span class="n">source</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rDeltaT</span><span class="o">*</span><span class="n">vf</span><span class="p">.</span><span class="n">oldTime</span><span class="p">().</span><span class="n">primitiveField</span><span class="p">()</span><span class="o">*</span><span class="n">mesh</span><span class="p">().</span><span class="n">Vsc0</span><span class="p">();</span><span class="w"></span>
<span class="linenos">26</span><span class="w">   </span><span class="p">}</span><span class="w"></span>
<span class="linenos">27</span><span class="w">   </span><span class="k">else</span><span class="w"></span>
<span class="linenos">28</span><span class="w">   </span><span class="p">{</span><span class="w"></span>
<span class="hll"><span class="linenos">29</span><span class="w">      </span><span class="n">fvm</span><span class="p">.</span><span class="n">source</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rDeltaT</span><span class="o">*</span><span class="n">vf</span><span class="p">.</span><span class="n">oldTime</span><span class="p">().</span><span class="n">primitiveField</span><span class="p">()</span><span class="o">*</span><span class="n">mesh</span><span class="p">().</span><span class="n">Vsc</span><span class="p">();</span><span class="w"> </span><span class="c1">// -T_old*Vc/dt</span>
</span><span class="linenos">30</span><span class="w">   </span><span class="p">}</span><span class="w"></span>
<span class="linenos">31</span>
<span class="linenos">32</span><span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="n">tfvm</span><span class="p">;</span><span class="w"></span>
<span class="linenos">33</span><span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<input class="tab-input" id="tab-set--9-input--4" name="tab-set--9" type="radio"><label class="tab-label" for="tab-set--9-input--4">fvm::ddt coefficients</label><div class="tab-content docutils container">
<p><span class="math notranslate nohighlight">\(\Delta t = 0.05\ s\)</span></p>
<div class="literal-block-wrapper docutils container" id="lst-log-fvm-ddt">
<div class="code-block-caption"><span class="caption-number">Listing 34 </span><span class="caption-text">fvm::ddt Coefficients  of the regular mesh shown in <a class="reference internal" href="#fig-polymesh-regularbox"><span class="std std-numref">Fig. 34</span></a>.</span><a class="headerlink" href="#lst-log-fvm-ddt" title="Permalink to this code"></a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="o">)</span>fvm::ddt<span class="o">(</span>T<span class="o">)</span>: 
<span class="linenos"> 2</span>	Lower47<span class="o">{</span><span class="m">0</span><span class="o">}</span>
<span class="linenos"> 3</span>	Diagonal
<span class="linenos"> 4</span><span class="m">30</span>
<span class="linenos"> 5</span><span class="o">(</span>
<span class="linenos"> 6</span>2e-05
<span class="linenos"> 7</span>2e-05
<span class="linenos"> 8</span>2e-05
<span class="linenos"> 9</span>2e-05
<span class="linenos">10</span>2e-05
<span class="linenos">11</span>2e-05
<span class="linenos">12</span>2e-05
<span class="linenos">13</span>2e-05
<span class="linenos">14</span>2e-05
<span class="linenos">15</span>2e-05
<span class="linenos">16</span>2e-05
<span class="linenos">17</span>2e-05
<span class="linenos">18</span>2e-05
<span class="linenos">19</span>2e-05
<span class="linenos">20</span>2e-05
<span class="linenos">21</span>2e-05
<span class="linenos">22</span>2e-05
<span class="linenos">23</span>2e-05
<span class="linenos">24</span>2e-05
<span class="linenos">25</span>2e-05
<span class="linenos">26</span>2e-05
<span class="linenos">27</span>2e-05
<span class="linenos">28</span>2e-05
<span class="linenos">29</span>2e-05
<span class="linenos">30</span>2e-05
<span class="linenos">31</span>2e-05
<span class="linenos">32</span>2e-05
<span class="linenos">33</span>2e-05
<span class="linenos">34</span>2e-05
<span class="linenos">35</span>2e-05
<span class="linenos">36</span><span class="o">)</span>
<span class="linenos">37</span>
<span class="linenos">38</span>	Upper47<span class="o">{</span><span class="m">0</span><span class="o">}</span>
<span class="linenos">39</span>	internalCoeffs
<span class="linenos">40</span><span class="m">5</span>
<span class="linenos">41</span><span class="o">(</span>
<span class="linenos">42</span><span class="m">3</span><span class="o">{</span><span class="m">0</span><span class="o">}</span>
<span class="linenos">43</span><span class="m">3</span><span class="o">{</span><span class="m">0</span><span class="o">}</span>
<span class="linenos">44</span><span class="m">10</span><span class="o">{</span><span class="m">0</span><span class="o">}</span>
<span class="linenos">45</span><span class="m">10</span><span class="o">{</span><span class="m">0</span><span class="o">}</span>
<span class="linenos">46</span><span class="m">0</span><span class="o">()</span>
<span class="linenos">47</span><span class="o">)</span>
<span class="linenos">48</span>
<span class="linenos">49</span>	boundaryCoeffs
<span class="linenos">50</span><span class="m">5</span>
<span class="linenos">51</span><span class="o">(</span>
<span class="linenos">52</span><span class="m">3</span><span class="o">{</span><span class="m">0</span><span class="o">}</span>
<span class="linenos">53</span><span class="m">3</span><span class="o">{</span><span class="m">0</span><span class="o">}</span>
<span class="linenos">54</span><span class="m">10</span><span class="o">{</span><span class="m">0</span><span class="o">}</span>
<span class="linenos">55</span><span class="m">10</span><span class="o">{</span><span class="m">0</span><span class="o">}</span>
<span class="linenos">56</span><span class="m">0</span><span class="o">()</span>
<span class="linenos">57</span><span class="o">)</span>
<span class="linenos">58</span>
<span class="linenos">59</span>	Source
<span class="linenos">60</span><span class="m">30</span>
<span class="linenos">61</span><span class="o">(</span>
<span class="linenos">62</span><span class="m">0</span>.00546
<span class="linenos">63</span><span class="m">0</span>.00546
<span class="linenos">64</span><span class="m">0</span>.00546
<span class="linenos">65</span><span class="m">0</span>.00546
<span class="linenos">66</span><span class="m">0</span>.00546
<span class="linenos">67</span><span class="m">0</span>.00546
<span class="linenos">68</span><span class="m">0</span>.00546
<span class="linenos">69</span><span class="m">0</span>.00546
<span class="linenos">70</span><span class="m">0</span>.00546
<span class="linenos">71</span><span class="m">0</span>.00546
<span class="linenos">72</span><span class="m">0</span>.00546
<span class="linenos">73</span><span class="m">0</span>.00546
<span class="linenos">74</span><span class="m">0</span>.00546
<span class="linenos">75</span><span class="m">0</span>.00546
<span class="linenos">76</span><span class="m">0</span>.00546
<span class="linenos">77</span><span class="m">0</span>.00546
<span class="linenos">78</span><span class="m">0</span>.00546
<span class="linenos">79</span><span class="m">0</span>.00546
<span class="linenos">80</span><span class="m">0</span>.00546
<span class="linenos">81</span><span class="m">0</span>.00546
<span class="linenos">82</span><span class="m">0</span>.00546
<span class="linenos">83</span><span class="m">0</span>.00546
<span class="linenos">84</span><span class="m">0</span>.00546
<span class="linenos">85</span><span class="m">0</span>.00546
<span class="linenos">86</span><span class="m">0</span>.00546
<span class="linenos">87</span><span class="m">0</span>.00546
<span class="linenos">88</span><span class="m">0</span>.00546
<span class="linenos">89</span><span class="m">0</span>.00546
<span class="linenos">90</span><span class="m">0</span>.00546
<span class="linenos">91</span><span class="m">0</span>.00546
<span class="linenos">92</span><span class="o">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="step-4-construct-the-final-coefficient-matrix-and-rhs">
<h3>Step 4, construct the final coefficient matrix and RHS<a class="headerlink" href="#step-4-construct-the-final-coefficient-matrix-and-rhs" title="Permalink to this headline"></a></h3>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--10-input--1" name="tab-set--10" type="radio"><label class="tab-label" for="tab-set--10-input--1">Final matrix</label><div class="tab-content docutils container">
<p>The final coefficient matrix is constructed by simply adding the matrix of <a class="reference internal" href="#of-fvmlaplacian"><span class="std std-ref">Step 2, discretize Laplacian term</span></a> and <a class="reference internal" href="#of-fvmddt"><span class="std std-ref">Step 3, discretize transient term</span></a>.</p>
<ul class="simple">
<li><p>The diagonal coefficients come from <span class="math notranslate nohighlight">\(a_C\)</span> of Laplacian term and <span class="math notranslate nohighlight">\(FluxC\)</span> of transient term</p></li>
<li><p>The off-diagonal coefficients only come from <span class="math notranslate nohighlight">\(a_F (internal\ face)\)</span> of Laplacian term</p></li>
<li><p>The RHS comes from <span class="math notranslate nohighlight">\(c_F\)</span> of Laplacian term when at boundary faces and <span class="math notranslate nohighlight">\(FluxC^oT_C^o\)</span> of transient term.</p></li>
</ul>
</div>
<input class="tab-input" id="tab-set--10-input--2" name="tab-set--10" type="radio"><label class="tab-label" for="tab-set--10-input--2">Coefficients at the first time step</label><div class="tab-content docutils container">
<div class="literal-block-wrapper docutils container" id="lst-log-fvm-teqn">
<div class="code-block-caption"><span class="caption-number">Listing 35 </span><span class="caption-text">Final matrix coefficients of the regular mesh shown in <a class="reference internal" href="#fig-polymesh-regularbox"><span class="std std-numref">Fig. 34</span></a> at the first time step.</span><a class="headerlink" href="#lst-log-fvm-teqn" title="Permalink to this code"></a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="linenos">  1</span><span class="o">)</span>TEqn: 
<span class="linenos">  2</span>	Lower
<span class="linenos">  3</span><span class="m">47</span>
<span class="linenos">  4</span><span class="o">(</span>
<span class="linenos">  5</span>-4e-07
<span class="linenos">  6</span>-4e-07
<span class="linenos">  7</span>-4e-07
<span class="linenos">  8</span>-4e-07
<span class="linenos">  9</span>-4e-07
<span class="linenos"> 10</span>-4e-07
<span class="linenos"> 11</span>-4e-07
<span class="linenos"> 12</span>-4e-07
<span class="linenos"> 13</span>-4e-07
<span class="linenos"> 14</span>-4e-07
<span class="linenos"> 15</span>-4e-07
<span class="linenos"> 16</span>-4e-07
<span class="linenos"> 17</span>-4e-07
<span class="linenos"> 18</span>-4e-07
<span class="linenos"> 19</span>-4e-07
<span class="linenos"> 20</span>-4e-07
<span class="linenos"> 21</span>-4e-07
<span class="linenos"> 22</span>-4e-07
<span class="linenos"> 23</span>-4e-07
<span class="linenos"> 24</span>-4e-07
<span class="linenos"> 25</span>-4e-07
<span class="linenos"> 26</span>-4e-07
<span class="linenos"> 27</span>-4e-07
<span class="linenos"> 28</span>-4e-07
<span class="linenos"> 29</span>-4e-07
<span class="linenos"> 30</span>-4e-07
<span class="linenos"> 31</span>-4e-07
<span class="linenos"> 32</span>-4e-07
<span class="linenos"> 33</span>-4e-07
<span class="linenos"> 34</span>-4e-07
<span class="linenos"> 35</span>-4e-07
<span class="linenos"> 36</span>-4e-07
<span class="linenos"> 37</span>-4e-07
<span class="linenos"> 38</span>-4e-07
<span class="linenos"> 39</span>-4e-07
<span class="linenos"> 40</span>-4e-07
<span class="linenos"> 41</span>-4e-07
<span class="linenos"> 42</span>-4e-07
<span class="linenos"> 43</span>-4e-07
<span class="linenos"> 44</span>-4e-07
<span class="linenos"> 45</span>-4e-07
<span class="linenos"> 46</span>-4e-07
<span class="linenos"> 47</span>-4e-07
<span class="linenos"> 48</span>-4e-07
<span class="linenos"> 49</span>-4e-07
<span class="linenos"> 50</span>-4e-07
<span class="linenos"> 51</span>-4e-07
<span class="linenos"> 52</span><span class="o">)</span>
<span class="linenos"> 53</span>
<span class="linenos"> 54</span>	Diagonal
<span class="linenos"> 55</span><span class="m">30</span>
<span class="linenos"> 56</span><span class="o">(</span>
<span class="hll"><span class="linenos"> 57</span><span class="m">2</span>.08e-05        //0
</span><span class="linenos"> 58</span><span class="m">2</span>.12e-05
<span class="linenos"> 59</span><span class="m">2</span>.12e-05
<span class="linenos"> 60</span><span class="m">2</span>.12e-05
<span class="linenos"> 61</span><span class="m">2</span>.12e-05
<span class="hll"><span class="linenos"> 62</span><span class="m">2</span>.12e-05        //5
</span><span class="linenos"> 63</span><span class="m">2</span>.12e-05
<span class="linenos"> 64</span><span class="m">2</span>.12e-05
<span class="linenos"> 65</span><span class="m">2</span>.12e-05
<span class="hll"><span class="linenos"> 66</span><span class="m">2</span>.08e-05        //9
</span><span class="hll"><span class="linenos"> 67</span><span class="m">2</span>.12e-05        //10
</span><span class="linenos"> 68</span><span class="m">2</span>.16e-05
<span class="hll"><span class="linenos"> 69</span><span class="m">2</span>.16e-05        //12
</span><span class="linenos"> 70</span><span class="m">2</span>.16e-05
<span class="linenos"> 71</span><span class="m">2</span>.16e-05
<span class="linenos"> 72</span><span class="m">2</span>.16e-05
<span class="linenos"> 73</span><span class="m">2</span>.16e-05
<span class="linenos"> 74</span><span class="m">2</span>.16e-05
<span class="linenos"> 75</span><span class="m">2</span>.16e-05
<span class="hll"><span class="linenos"> 76</span><span class="m">2</span>.12e-05        //19
</span><span class="linenos"> 77</span><span class="m">2</span>.08e-05
<span class="linenos"> 78</span><span class="m">2</span>.12e-05
<span class="linenos"> 79</span><span class="m">2</span>.12e-05
<span class="linenos"> 80</span><span class="m">2</span>.12e-05
<span class="linenos"> 81</span><span class="m">2</span>.12e-05
<span class="linenos"> 82</span><span class="m">2</span>.12e-05
<span class="linenos"> 83</span><span class="m">2</span>.12e-05
<span class="linenos"> 84</span><span class="m">2</span>.12e-05
<span class="linenos"> 85</span><span class="m">2</span>.12e-05
<span class="linenos"> 86</span><span class="m">2</span>.08e-05
<span class="linenos"> 87</span><span class="o">)</span>
<span class="linenos"> 88</span>
<span class="linenos"> 89</span>	Upper
<span class="linenos"> 90</span><span class="m">47</span>
<span class="linenos"> 91</span><span class="o">(</span>
<span class="linenos"> 92</span>-4e-07
<span class="linenos"> 93</span>-4e-07
<span class="linenos"> 94</span>-4e-07
<span class="linenos"> 95</span>-4e-07
<span class="linenos"> 96</span>-4e-07
<span class="linenos"> 97</span>-4e-07
<span class="linenos"> 98</span>-4e-07
<span class="linenos"> 99</span>-4e-07
<span class="linenos">100</span>-4e-07
<span class="linenos">101</span>-4e-07
<span class="linenos">102</span>-4e-07
<span class="linenos">103</span>-4e-07
<span class="linenos">104</span>-4e-07
<span class="linenos">105</span>-4e-07
<span class="linenos">106</span>-4e-07
<span class="linenos">107</span>-4e-07
<span class="linenos">108</span>-4e-07
<span class="linenos">109</span>-4e-07
<span class="linenos">110</span>-4e-07
<span class="linenos">111</span>-4e-07
<span class="linenos">112</span>-4e-07
<span class="linenos">113</span>-4e-07
<span class="linenos">114</span>-4e-07
<span class="linenos">115</span>-4e-07
<span class="linenos">116</span>-4e-07
<span class="linenos">117</span>-4e-07
<span class="linenos">118</span>-4e-07
<span class="linenos">119</span>-4e-07
<span class="linenos">120</span>-4e-07
<span class="linenos">121</span>-4e-07
<span class="linenos">122</span>-4e-07
<span class="linenos">123</span>-4e-07
<span class="linenos">124</span>-4e-07
<span class="linenos">125</span>-4e-07
<span class="linenos">126</span>-4e-07
<span class="linenos">127</span>-4e-07
<span class="linenos">128</span>-4e-07
<span class="linenos">129</span>-4e-07
<span class="linenos">130</span>-4e-07
<span class="linenos">131</span>-4e-07
<span class="linenos">132</span>-4e-07
<span class="linenos">133</span>-4e-07
<span class="linenos">134</span>-4e-07
<span class="linenos">135</span>-4e-07
<span class="linenos">136</span>-4e-07
<span class="linenos">137</span>-4e-07
<span class="linenos">138</span>-4e-07
<span class="linenos">139</span><span class="o">)</span>
<span class="linenos">140</span>
<span class="linenos">141</span>	internalCoeffs
<span class="linenos">142</span><span class="m">5</span>
<span class="linenos">143</span><span class="o">(</span>
<span class="linenos">144</span><span class="m">3</span><span class="o">(</span>8e-07 8e-07 8e-07<span class="o">)</span>
<span class="linenos">145</span><span class="m">3</span><span class="o">(</span>8e-07 8e-07 8e-07<span class="o">)</span>
<span class="linenos">146</span><span class="m">10</span><span class="o">{</span><span class="m">0</span><span class="o">}</span>
<span class="linenos">147</span><span class="m">10</span><span class="o">{</span><span class="m">0</span><span class="o">}</span>
<span class="linenos">148</span><span class="m">0</span><span class="o">()</span>
<span class="linenos">149</span><span class="o">)</span>
<span class="linenos">150</span>
<span class="linenos">151</span>	boundaryCoeffs
<span class="linenos">152</span><span class="m">5</span>
<span class="linenos">153</span><span class="o">(</span>
<span class="linenos">154</span><span class="m">3</span><span class="o">(</span><span class="m">0</span>.0002184 <span class="m">0</span>.0002184 <span class="m">0</span>.0002184<span class="o">)</span>
<span class="linenos">155</span><span class="m">3</span><span class="o">(</span><span class="m">0</span>.0004584 <span class="m">0</span>.0004584 <span class="m">0</span>.0004584<span class="o">)</span>
<span class="linenos">156</span><span class="m">10</span><span class="o">{</span><span class="m">0</span><span class="o">}</span>
<span class="linenos">157</span><span class="m">10</span><span class="o">{</span><span class="m">0</span><span class="o">}</span>
<span class="linenos">158</span><span class="m">0</span><span class="o">()</span>
<span class="linenos">159</span><span class="o">)</span>
<span class="linenos">160</span>
<span class="linenos">161</span>	Source
<span class="linenos">162</span><span class="m">30</span>
<span class="linenos">163</span><span class="o">(</span>
<span class="linenos">164</span><span class="m">0</span>.00546
<span class="linenos">165</span><span class="m">0</span>.00546
<span class="linenos">166</span><span class="m">0</span>.00546
<span class="linenos">167</span><span class="m">0</span>.00546
<span class="linenos">168</span><span class="m">0</span>.00546
<span class="linenos">169</span><span class="m">0</span>.00546
<span class="linenos">170</span><span class="m">0</span>.00546
<span class="linenos">171</span><span class="m">0</span>.00546
<span class="linenos">172</span><span class="m">0</span>.00546
<span class="linenos">173</span><span class="m">0</span>.00546
<span class="linenos">174</span><span class="m">0</span>.00546
<span class="linenos">175</span><span class="m">0</span>.00546
<span class="linenos">176</span><span class="m">0</span>.00546
<span class="linenos">177</span><span class="m">0</span>.00546
<span class="linenos">178</span><span class="m">0</span>.00546
<span class="linenos">179</span><span class="m">0</span>.00546
<span class="linenos">180</span><span class="m">0</span>.00546
<span class="linenos">181</span><span class="m">0</span>.00546
<span class="linenos">182</span><span class="m">0</span>.00546
<span class="linenos">183</span><span class="m">0</span>.00546
<span class="linenos">184</span><span class="m">0</span>.00546
<span class="linenos">185</span><span class="m">0</span>.00546
<span class="linenos">186</span><span class="m">0</span>.00546
<span class="linenos">187</span><span class="m">0</span>.00546
<span class="linenos">188</span><span class="m">0</span>.00546
<span class="linenos">189</span><span class="m">0</span>.00546
<span class="linenos">190</span><span class="m">0</span>.00546
<span class="linenos">191</span><span class="m">0</span>.00546
<span class="linenos">192</span><span class="m">0</span>.00546
<span class="linenos">193</span><span class="m">0</span>.00546
<span class="linenos">194</span><span class="o">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="step-5-solve">
<h3>Step 5, solve<a class="headerlink" href="#step-5-solve" title="Permalink to this headline"></a></h3>
<p>For the <a class="reference download internal" download="" href="../../_downloads/182fc0c7918b295146e8ff66ee704105/regularBox.zip"><code class="xref download docutils literal notranslate"><span class="pre">Regular</span> <span class="pre">box</span> <span class="pre">case</span></code></a> case, we can use <strong>PBiCG</strong> solver and <strong>DILU</strong> preconditioner.</p>
<div class="admonition-available-preconditioner-in-openfoam admonition">
<p class="admonition-title">Available preconditioner in OpenFOAM</p>
<ul class="simple">
<li><p><strong>diagonal</strong> : for symmetric &amp; nonsymmetric matrices (not very effective)</p></li>
<li><p><strong>DIC</strong> : Diagonal Incomplete Cholesky preconditioner for symmetric matrices</p></li>
<li><p><strong>DILU</strong> : Diagonal Incomplete LU preconditioner for nonsymmetric matrices</p></li>
<li><p><strong>FDIC</strong> : Fast Diagonal Incomplete Cholesky preconditioner</p></li>
<li><p><strong>GAMG</strong> : Geometric Agglomerated algebraic MultiGrid preconditioner</p></li>
</ul>
</div>
<div class="admonition-available-solver-in-openfoam admonition">
<p class="admonition-title">Available solver in OpenFOAM</p>
<ul class="simple">
<li><p><strong>BICCG</strong>: Diagonal incomplete LU preconditioned BiCG solver</p></li>
<li><p><strong>diagonalSolver</strong>: Solver for symmetric and nonsymmetric matrices</p></li>
<li><p><strong>GAMG</strong>: Geometric Agglomerated algebraic Multi-Grid solver</p></li>
<li><p><strong>ICC</strong>: Incomplete Cholesky Conjugate Gradient solver</p></li>
<li><p><strong>PBiCG</strong>: Bi-Conjugate Gradient solver with preconditioner</p></li>
<li><p><strong>PCG</strong>: Conjugate Gradient solver with preconditioner</p></li>
<li><p><strong>smoothSolver</strong>: Iterative solver with run-time selectable smoother</p></li>
</ul>
</div>
<div class="admonition-krylov-subspace-solvers admonition">
<p class="admonition-title">Krylov-subspace solvers</p>
<ul class="simple">
<li><p><strong>CG</strong>: The Conjugate Gradient algorithm applies to systems where A is symmetric positive definite (SPD)</p></li>
<li><p><strong>GMRES</strong>: The Generalized Minimal RESidual algorithm is the first method to try if A is not SPD.</p></li>
<li><p><strong>BiCG</strong>: The BiConjugate Gradient algorithm applies to general linear systems, but the convergence can be quite erratic.</p></li>
<li><p><strong>BiCGstab</strong>: The stabilized version of the BiConjugate Gradient algorithm.</p></li>
</ul>
</div>
</section>
<section id="step-6-write">
<h3>Step 6, write<a class="headerlink" href="#step-6-write" title="Permalink to this headline"></a></h3>
</section>
<section id="jupyter-notebook">
<h3>Jupyter notebook<a class="headerlink" href="#jupyter-notebook" title="Permalink to this headline"></a></h3>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="cases/jupyter/VisualizeResults.html">1. Read and plot mesh information</a></li>
<li class="toctree-l1"><a class="reference internal" href="cases/jupyter/VisualizeResults.html#2.-Boundary-conditions">2. Boundary conditions</a></li>
<li class="toctree-l1"><a class="reference internal" href="cases/jupyter/VisualizeResults.html#3.-Plot-coefficients-matrix">3. Plot coefficients matrix</a><ul>
<li class="toctree-l2"><a class="reference internal" href="cases/jupyter/VisualizeResults.html#Implementation-in-OpenFOAM">Implementation in OpenFOAM</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="cases/jupyter/VisualizeResults.html#1.-Coordinates-and-delta-coefficients-of-internal-cell">1. Coordinates and delta coefficients of internal cell</a></li>
<li class="toctree-l1"><a class="reference internal" href="cases/jupyter/VisualizeResults.html#2.-Coordinates-and-delta-coefficients-of-boundary-cell">2. Coordinates and delta coefficients of boundary cell</a></li>
</ul>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="intro.html" class="btn btn-neutral float-left" title="FVM and OpenFoam" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="cases/jupyter/VisualizeResults.html" class="btn btn-neutral float-right" title="1. Read and plot mesh information" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Lars Ruepke and Zhikui Guo.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>