
<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Example 2: Cooling dike - implicit version &mdash; Finite Element Modeling in Geodynamics  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=3d3fbe02" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/tabs.css?v=4c969af8" />
      <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
      <link rel="stylesheet" type="text/css" href="../_static/style.css?v=379f3234" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../_static/tabs.js?v=3ee01567"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="FD calculation of radioactive decay" href="jupyter/radio_decay.html" />
    <link rel="prev" title="Script for solving the 1D diffusion equation - T(t) at x meters from dike" href="jupyter/cooling_dike_1d_fdm_T_at_x_m.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Finite Element Modeling in Geodynamics
              <img src="../_static/triangle_fem_cover.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
    
              <p class="caption" role="heading"><span class="caption-text">Course information</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../general-info/course-details.html">Course details</a></li>
<li class="toctree-l1"><a class="reference internal" href="../general-info/installation.html">Installation guide</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Lecture 1</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="fdm_intro.html">Introduction: The Finite Differences Method (FDM)</a></li>
<li class="toctree-l1"><a class="reference internal" href="example_1.html">Example 1: Cooling dike</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Example 2: Cooling dike - implicit version</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#stability-analysis">Stability analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="#radioactive-decay-analog">Radioactive decay analog</a></li>
<li class="toctree-l2"><a class="reference internal" href="#fdm-notebook">FDM notebook</a><ul>
<li class="toctree-l3"><a class="reference internal" href="jupyter/radio_decay.html">FD calculation of radioactive decay</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#excercise-radioactive-decay">Excercise - radioactive decay</a></li>
<li class="toctree-l2"><a class="reference internal" href="#implicit-heat-diffusion">Implicit Heat Diffusion</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id1">FDM notebook</a><ul>
<li class="toctree-l3"><a class="reference internal" href="jupyter/imp_dike_cooling.html">Implicit descretization</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#excercise-implicit-dike-cooling">Excercise - implicit dike cooling</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="example_3.html">Example 3: Periodic variations in seafloor temperature</a></li>
<li class="toctree-l1"><a class="reference internal" href="fdm_advection.html">Transport problems with FDM</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Lecture 2</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../lecture2/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lecture2/mwr_intro.html">Introduction: Method of Weighted Residuals (MWR)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lecture2/mwr_examples.html">MWR solutions of the steady advection-diffusion equation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lecture2/excercises.html">Excercises</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Lecture 3</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../lecture3/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lecture3/fem_intro.html">Introduction Finite Element Method (FEM)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lecture3/fem_intro.html#fem-implementation">FEM implementation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lecture3/fem_advection.html">FEM and advection problems</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Lecture 4</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../lecture4/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lecture4/fem_in_2d.html">2-D FEM - elliptic problems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lecture4/fem_in_2d.html#implementation">Implementation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Lecture 5</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../lecture5/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lecture5/FEM_triangles.html">Triangles: unstructured meshes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lecture5/FEM_triangles.html#excercise">Excercise</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Lecture 6</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../lecture6/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lecture6/transient_problems.html">Transient heat diffusion</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lecture6/turing_coupled_problem.html">Coupled diffusion problems</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../refs.html">References</a></li>
</ul>


    
        <p class="caption">
            <span class="caption-text">Getting help</span>
        </p>
        <ul>
            
                <li class="toctree-l1"><a href="https://lruepke.github.io/HTF_lecture/imprint/"><i class="fa fa-stamp"></i> Imprint</a></li>
            
                <li class="toctree-l1"><a href="mailto:lruepke@geomar.de"><i class="fa fa-envelope fa-fw"></i> Prof. Lars Ruepke</a></li>
            
                <li class="toctree-l1"><a href="mailto:zguo@geomar.de"><i class="fa fa-envelope fa-fw"></i> Dr. Zhikui Guo</a></li>
            
                <li class="toctree-l1"><a href="https://lruepke.github.io/FEM_lecture/"><i class="fa fa-home fa-fw"></i> Public site</a></li>
            
                <li class="toctree-l1"><a href="https://lms.uni-kiel.de/url/RepositoryEntry/3664576582"><i class="fa fa-home fa-fw"></i> University site</a></li>
            
        </ul>
    

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Finite Element Modeling in Geodynamics</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Example 2: Cooling dike - implicit version</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/lruepke/HTF_lecture/blob/main//source/lecture1/example_2.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="example-2-cooling-dike-implicit-version">
<h1>Example 2: Cooling dike - implicit version<a class="headerlink" href="#example-2-cooling-dike-implicit-version" title="Link to this heading"></a></h1>
<p>In the previous session, we have learned how to solve for temperature using finite differences. However, our solution was only stable for certain parameter choices. In fact, we found that the finite differences formulation is only stable for <span class="math notranslate nohighlight">\(\beta&lt;0.5\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-eq-imp-dummy1">
<span class="eqno">(33)<a class="headerlink" href="#equation-eq-imp-dummy1" title="Link to this equation"></a></span>\[\begin{split}\begin{align}
\begin{split}
T_i^{n+1} = \frac{\kappa \Delta t}{\Delta x^2} \left( T_{i-1}^n - 2T_i^n + T_{i+1}^n\right) + T_i^n\\
\beta = \frac{\kappa \Delta t}{\Delta x^2}\\
T_i^{n+1} =
\begin{bmatrix}
\beta &amp; (1-2\beta) &amp; \beta
\end{bmatrix}
\begin{bmatrix}
T_{i-1}^n\\
T_{i}^n\\
T_{i+1}^n
\end{bmatrix}
\end{split}
\end{align}\end{split}\]</div>
<p>Today we will explore how to formulate a finite differences model that is always stable.</p>
<section id="stability-analysis">
<h2>Stability analysis<a class="headerlink" href="#stability-analysis" title="Link to this heading"></a></h2>
<p>Before progressing let us explore when and why the explicit scheme is unstable. Let us assume a temperature profile with a single peak:</p>
<div class="math notranslate nohighlight" id="equation-eq-imp-dummy2">
<span class="eqno">(34)<a class="headerlink" href="#equation-eq-imp-dummy2" title="Link to this equation"></a></span>\[\begin{split}T =
\begin{bmatrix}
0\\0\\1\\0\\0
\end{bmatrix}\end{split}\]</div>
<p>and let’s further assume that <span class="math notranslate nohighlight">\(\beta = 0.2\)</span>. Then after one time step the temperature profile looks like
this:</p>
<div class="math notranslate nohighlight" id="equation-eq-imp-dummy3">
<span class="eqno">(35)<a class="headerlink" href="#equation-eq-imp-dummy3" title="Link to this equation"></a></span>\[\begin{split}\begin{align*}
\begin{split}
T_2 = \begin{bmatrix}0.2 &amp; 0.6 &amp; 0.2\end{bmatrix}\begin{bmatrix}1\\0\\0\end{bmatrix} = 0.2\\
T_3 = \begin{bmatrix}0.2 &amp; 0.6 &amp; 0.2\end{bmatrix}\begin{bmatrix}0\\1\\0\end{bmatrix} = 0.6\\
T_4 = \begin{bmatrix}0.2 &amp; 0.6 &amp; 0.2\end{bmatrix}\begin{bmatrix}0\\0\\1\end{bmatrix} = 0.2
\end{split}
\end{align*}\end{split}\]</div>
<p>A nice diffusion profile. By further try-and-error (do it for different values for beta!), we find that the scheme is only stable for <span class="math notranslate nohighlight">\(\beta&lt;0.5\)</span></p>
</section>
<section id="radioactive-decay-analog">
<h2>Radioactive decay analog<a class="headerlink" href="#radioactive-decay-analog" title="Link to this heading"></a></h2>
<p>A good test problem to explore the stability and accuracy of different finite element schemes is radioactive decay. The change in concentration is controlled by this equation:</p>
<div class="math notranslate nohighlight" id="equation-eq-radio-1">
<span class="eqno">(36)<a class="headerlink" href="#equation-eq-radio-1" title="Link to this equation"></a></span>\[\frac{\partial c}{\partial t}= - \lambda c\]</div>
<p><a class="reference internal" href="#equation-eq-radio-1">equation (36)</a> states that the rate of decay is controlled by how much of the material is still there. To solve <a class="reference internal" href="#equation-eq-radio-1">equation (36)</a>, we can use our standard finite differences approach:</p>
<div class="math notranslate nohighlight" id="equation-eq-radio-2">
<span class="eqno">(37)<a class="headerlink" href="#equation-eq-radio-2" title="Link to this equation"></a></span>\[\frac{c^{n+1} - c^{n}}{\Delta t}= - \lambda c^n\]</div>
<p>This standard implementation is called the explicit form because you can write the new concentration directly as a function of the old one. The assumption here is that the concentration at the beginning of the time step controls the decay rate.
An alternative formulation, the implicit form, is to assume that the decay rate is controlled by the (unknown) concentration at the end of the time step <span class="math notranslate nohighlight">\(c^{n+1}\)</span>. The implicit from is therefore:</p>
<div class="math notranslate nohighlight" id="equation-eq-radio-3">
<span class="eqno">(38)<a class="headerlink" href="#equation-eq-radio-3" title="Link to this equation"></a></span>\[\frac{c^{n+1} - c^{n}}{\Delta t}= - \lambda c^{n+1}\]</div>
<p>We will explore the differences between both formulations with a little python script.</p>
</section>
<section id="fdm-notebook">
<h2>FDM notebook<a class="headerlink" href="#fdm-notebook" title="Link to this heading"></a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="jupyter/radio_decay.html">FD calculation of radioactive decay</a></li>
</ul>
</div>
</section>
<section id="excercise-radioactive-decay">
<h2>Excercise - radioactive decay<a class="headerlink" href="#excercise-radioactive-decay" title="Link to this heading"></a></h2>
<p>Try out the notebook and explore under which conditions the solutions are stable. What’s the difference between the explicit and the implicit solution?</p>
<p>Add another method to the script that takes the concentration at the center of the time step:</p>
<div class="math notranslate nohighlight" id="equation-eq-radio-4">
<span class="eqno">(39)<a class="headerlink" href="#equation-eq-radio-4" title="Link to this equation"></a></span>\[\frac{c^{n+1} - c^{n}}{\Delta t}= - \lambda c^{n+\frac{1}{2}}\]</div>
</section>
<section id="implicit-heat-diffusion">
<h2>Implicit Heat Diffusion<a class="headerlink" href="#implicit-heat-diffusion" title="Link to this heading"></a></h2>
<p>The previous exercise on radioactive decay has shown that the fully implicit method is always stable. We will now rewrite our dike cooling model using the implicit formulation. Here is the implicit finite differences form:</p>
<div class="math notranslate nohighlight" id="equation-eq-imp-dummy5">
<span class="eqno">(40)<a class="headerlink" href="#equation-eq-imp-dummy5" title="Link to this equation"></a></span>\[\begin{split}\begin{split}
\frac{T_i^{n+1} - T_i^n}{\Delta t} = \frac{\kappa}{\Delta x^2} \left( T_{i-1}^{n+1} - 2T_i^{n+1} + T_{i+1}^{n+1} \right)\\
\begin{bmatrix}
-\beta &amp; (1+2\beta) &amp; -\beta
\end{bmatrix}
\begin{bmatrix}
T_{i-1}^{n+1}\\
T_{i}^{n+1}\\
T_{i+1}^{n+1}
\end{bmatrix}
= T_i^{n}
\end{split}\end{split}\]</div>
<figure class="align-center" id="imp-exp-stencil-fig" style="width: 100%">
<img alt="../_images/1D_implicit_vs_explicit_stencil.png" src="../_images/1D_implicit_vs_explicit_stencil.png" />
<figcaption>
<p><span class="caption-number">Fig. 3 </span><span class="caption-text">Different explicit and implicit FD discretization stencils.</span><a class="headerlink" href="#imp-exp-stencil-fig" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>It is characteristic for the implicit form that the solution for <span class="math notranslate nohighlight">\(T^{n+1}_i\)</span> depends on the solution of the neighboring nodes (<span class="math notranslate nohighlight">\(i-1\)</span> and <span class="math notranslate nohighlight">\(i+1\)</span>). As a consequence, we cannot simply solve for one node after the other anymore but need to solve a system of equations. In fact, the way forward is to state the problem in matrix form <span class="math notranslate nohighlight">\(A\vec{x}=\vec{b}\)</span> and solve all equations simultaneously:</p>
<div class="math notranslate nohighlight" id="equation-eq-imp-dummy6">
<span class="eqno">(41)<a class="headerlink" href="#equation-eq-imp-dummy6" title="Link to this equation"></a></span>\[\begin{split}\begin{align}
\begin{split}
\begin{bmatrix}
1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\
-\beta &amp; (1+2\beta) &amp; -\beta &amp; 0 &amp; 0 &amp; 0 &amp; 0\\
0 &amp; -\beta &amp; (1+2\beta) &amp; -\beta &amp; 0 &amp; 0 &amp; 0\\
0 &amp; 0 &amp; -\beta &amp; (1+2\beta) &amp; -\beta &amp; 0 &amp; 0\\
0 &amp; 0 &amp; 0 &amp; -\beta &amp; (1+2\beta) &amp; -\beta &amp; 0\\
0 &amp; 0 &amp; 0 &amp; 0 &amp; -\beta &amp; (1+2\beta) &amp; -\beta\\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1
\end{bmatrix}
\begin{bmatrix}
T_1^{n+1}\\
T_2^{n+1}\\
T_3^{n+1}\\
T_4^{n+1}\\
T_5^{n+1}\\
T_6^{n+1}\\
T_7^{n+1}
\end{bmatrix}
=
\begin{bmatrix}
T_{top}\\
T_2^n\\
T_3^n\\
T_4^n\\
T_5^n\\
T_6^n\\
T_{bottom}\\
\end{bmatrix}\\
\end{split}
\end{align}\end{split}\]</div>
<p>All we need to do is set up the matrix A and then solve for <span class="math notranslate nohighlight">\(T^{n+1} = A \backslash T^n\)</span>!</p>
</section>
<section id="id1">
<h2>FDM notebook<a class="headerlink" href="#id1" title="Link to this heading"></a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="jupyter/imp_dike_cooling.html">Implicit descretization</a></li>
</ul>
</div>
</section>
<section id="excercise-implicit-dike-cooling">
<h2>Excercise - implicit dike cooling<a class="headerlink" href="#excercise-implicit-dike-cooling" title="Link to this heading"></a></h2>
<blockquote>
<div><ul class="simple">
<li><p>Get the notebook to work and programm the implicit solution. Explore if you find any stability limits.</p></li>
<li><p><strong>Bonus:</strong> Plot the explicit and implicit solutions together. Do you find the same behavior as in the radioactive decay example?</p></li>
</ul>
</div></blockquote>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="jupyter/cooling_dike_1d_fdm_T_at_x_m.html" class="btn btn-neutral float-left" title="Script for solving the 1D diffusion equation - T(t) at x meters from dike" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="jupyter/radio_decay.html" class="btn btn-neutral float-right" title="FD calculation of radioactive decay" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Lars Ruepke and Zhikui Guo.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
      
        <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
          <span class="rst-current-version" data-toggle="rst-current-version">
            <span class="fa fa-book"> Finite Element Modeling in Geodynamics</span>
            v: latest
            <span class="fa fa-caret-down"></span>
          </span>
          <div class="rst-other-versions">
            <dl>
              
                
                <dd><a href="https://lruepke.github.io/FEM_lecture/downloads/LectureNote.pdf">latest</a></dd>
                
                <dd><a href="#/LectureNote.pdf">2.0</a></dd>
                
              
          </div>
        </div>
      
    

</body>
</html>